<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de Bord Gantt - Gestion des Projets (Firefox Optimis√©)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            color: #2c3e50;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 10000;
        }
        
        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }
        
        .nav-tabs {
            display: flex;
            gap: 0.8rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        
        .nav-tab {
            padding: 0.6rem 1.2rem;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .nav-tab:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .nav-tab.active {
            background: white;
            color: #667eea;
            font-weight: 600;
        }
        
        .container {
            max-width: 2000px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        .view {
            display: none;
            animation: fadeIn 0.3s;
        }
        
        .view.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .gantt-header {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .gantt-header h2 {
            font-size: 1.6rem;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }
        
        .gantt-header .subtitle {
            color: #666;
            font-size: 0.95rem;
        }
        
        .gantt-container {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            overflow-x: auto;
        }
        
        
        /* ============================================================
           CONFIGURATION DES COLONNES STICKY - FIREFOX OPTIMIS√â
           ============================================================
           
           PRINCIPES CL√âS POUR FIREFOX:
           1. table-layout: fixed - Seule la PREMI√àRE ligne d√©finit les largeurs
           2. border-collapse: separate - OBLIGATOIRE avec position: sticky
           3. border-spacing: 0 - Maintient l'apparence compacte
           4. background-clip: padding-box - CRITIQUE pour voir les bordures
           5. Hi√©rarchie z-index: thead (500+) > tbody lignes sp√©ciales (60) > tbody standard (50+)
           6. will-change: transform - Optimisation GPU pour d√©filement fluide
           7. Valeurs left cumulatives - Chaque colonne = somme des largeurs pr√©c√©dentes
        ============================================================ */
        
        /* ============================================================
           TABLE DE BASE
        ============================================================ */
        
        .gantt-table {
            /* Layout */
            width: 100%;
            table-layout: fixed !important;
            min-width: 2000px;
            
            /* Bordures - CRITICAL pour Firefox */
            border-collapse: separate !important;
            border-spacing: 0;
            border-right: 1px solid #dee2e6;
            border-bottom: 1px solid #dee2e6;
        }
        
        /* ============================================================
           CONFIGURATION DES 6 COLONNES STICKY
           
           Col 1: #     - 35px  - left: 0px
           Col 2: Code  - 60px  - left: 35px
           Col 3: CEP   - 150px - left: 95px
           Col 4: Titre - 400px - left: 245px
           Col 5: √âtat  - 150px - left: 645px
           Col 6: Date  - 150px - left: 795px
           
           Total sticky: 945px
        ============================================================ */
        
        /* ============================================================
           THEAD - EN-T√äTES STICKY (z-index 501-506)
        ============================================================ */
        
        /* Styles communs √† TOUS les th */
        .gantt-table thead th {
            /* Positionnement */
            position: sticky;
            top: 0;
            
            /* Apparence */
            background: #f8f9fa;
            color: #495057;
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
            vertical-align: middle;
            
            /* Bordures - Individuelles pour border-collapse: separate */
            border-top: 1px solid #dee2e6;
            border-left: 1px solid #dee2e6;
            border-bottom: 2px solid #dee2e6;
            
            /* Firefox optimizations */
            background-clip: padding-box;
            will-change: transform;
            
            /* Espacement - par d√©faut pour colonnes non-sticky */
            padding: 0.8rem 0.5rem;
            
            /* z-index de base pour colonnes non-sticky */
            z-index: 50;
        }
        
        /* ============================================================
           COLONNE 1 - # (35px)
        ============================================================ */
        
        .gantt-table thead th:nth-child(1) {
            /* Position et dimensions */
            position: sticky;
            left: 0px;
            width: 35px !important;
            min-width: 35px !important;
            max-width: 35px !important;
            
            /* Hi√©rarchie */
            z-index: 506;
            
            /* Apparence */
            background: #e9ecef;
            background-clip: padding-box;
            
            /* Ombre de s√©paration */
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            
            /* Optimisation */
            will-change: transform;
            
            /* Espacement */
            padding: 0 !important;
        }
        
        /* ============================================================
           COLONNE 2 - Code (60px)
        ============================================================ */
        
        .gantt-table thead th:nth-child(2) {
            /* Position et dimensions */
            position: sticky;
            left: 35px; /* = largeur col 1 */
            width: 60px !important;
            min-width: 60px !important;
            max-width: 60px !important;
            
            /* Hi√©rarchie */
            z-index: 505;
            
            /* Apparence */
            background: #e9ecef;
            background-clip: padding-box;
            
            /* Ombre de s√©paration */
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            
            /* Optimisation */
            will-change: transform;
            
            /* Espacement */
            padding: 0 !important;
        }
        
        /* ============================================================
           COLONNE 3 - CEP (150px)
        ============================================================ */
        
        .gantt-table thead th:nth-child(3) {
            /* Position et dimensions */
            position: sticky;
            left: 95px; /* = 35 + 60 */
            width: 150px !important;
            min-width: 150px !important;
            max-width: 150px !important;
            
            /* Hi√©rarchie */
            z-index: 504;
            
            /* Apparence */
            background: #e9ecef;
            background-clip: padding-box;
            
            /* Ombre de s√©paration */
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            
            /* Optimisation */
            will-change: transform;
            
            /* Espacement */
            padding: 0 !important;
        }
        
        /* ============================================================
           COLONNE 4 - Titre (400px)
        ============================================================ */
        
        .gantt-table thead th:nth-child(4) {
            /* Position et dimensions */
            position: sticky;
            left: 245px; /* = 35 + 60 + 150 */
            width: 400px !important;
            min-width: 400px !important;
            max-width: 400px !important;
            
            /* Hi√©rarchie */
            z-index: 503;
            
            /* Apparence */
            background: #e9ecef;
            background-clip: padding-box;
            
            /* Ombre de s√©paration */
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            
            /* Optimisation */
            will-change: transform;
            
            /* Espacement */
            padding: 0 !important;
        }
        
        /* ============================================================
           COLONNE 5 - √âtat (150px)
        ============================================================ */
        
        .gantt-table thead th:nth-child(5) {
            /* Position et dimensions */
            position: sticky;
            left: 645px; /* = 35 + 60 + 150 + 400 */
            width: 150px !important;
            min-width: 150px !important;
            max-width: 150px !important;
            
            /* Hi√©rarchie */
            z-index: 502;
            
            /* Apparence */
            background: #e9ecef;
            background-clip: padding-box;
            
            /* Ombre de s√©paration */
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            
            /* Optimisation */
            will-change: transform;
            
            /* Espacement */
            padding: 0 !important;
        }
        
        /* ============================================================
           COLONNE 6 - Date livrable (150px)
        ============================================================ */
        
        .gantt-table thead th:nth-child(6) {
            /* Position et dimensions */
            position: sticky;
            left: 795px; /* = 35 + 60 + 150 + 400 + 150 */
            width: 150px !important;
            min-width: 150px !important;
            max-width: 150px !important;
            
            /* Hi√©rarchie */
            z-index: 501;
            
            /* Apparence */
            background: #e9ecef;
            background-clip: padding-box;
            
            /* Ombre de s√©paration (derni√®re colonne sticky) */
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            
            /* Optimisation */
            will-change: transform;
            
            /* Espacement */
            padding: 0 !important;
        }
        
        /* ============================================================
           PADDING INTERNE pour colonnes sticky THEAD
           Les colonnes sticky ont padding: 0, le padding est appliqu√©
           sur leurs √©l√©ments enfants pour √©viter les probl√®mes Firefox
        ============================================================ */
        
        .gantt-table thead th:nth-child(1) > *,
        .gantt-table thead th:nth-child(2) > *,
        .gantt-table thead th:nth-child(3) > *,
        .gantt-table thead th:nth-child(4) > *,
        .gantt-table thead th:nth-child(5) > *,
        .gantt-table thead th:nth-child(6) > * {
            padding: 0.8rem 0.5rem;
        }
        
        /* ============================================================
           TBODY - CELLULES DE DONN√âES (z-index 51-56)
        ============================================================ */
        
        /* Styles communs √† TOUTES les td */
        .gantt-table tbody td {
            /* Apparence */
            font-size: 0.85rem;
            text-align: center;
            vertical-align: middle;
            
            /* Bordures - Individuelles pour border-collapse: separate */
            border-top: 1px solid #f1f3f5;
            border-left: 1px solid #f1f3f5;
            
            /* Firefox optimization */
            background-clip: padding-box;
            
            /* Espacement - par d√©faut pour cellules non-sticky */
            padding: 0.6rem 0.5rem;
        }
        
        /* ============================================================
           COLONNE 1 - # (35px) - TBODY
        ============================================================ */
        
        .gantt-table tbody td:nth-child(1) {
            /* Position et dimensions - DOIT correspondre √† thead */
            position: sticky;
            left: 0px;
            width: 35px !important;
            min-width: 35px !important;
            max-width: 35px !important;
            
            /* Hi√©rarchie - Plus bas que thead */
            z-index: 56;
            
            /* Apparence */
            background: white;
            background-clip: padding-box;
            
            /* Ombre de s√©paration */
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
            
            /* Optimisation */
            will-change: transform;
            
            /* Espacement */
            padding: 0 !important;
        }
        
        /* ============================================================
           COLONNE 2 - Code (60px) - TBODY
        ============================================================ */
        
        .gantt-table tbody td:nth-child(2) {
            /* Position et dimensions - DOIT correspondre √† thead */
            position: sticky;
            left: 35px;
            width: 60px !important;
            min-width: 60px !important;
            max-width: 60px !important;
            
            /* Hi√©rarchie - Plus bas que thead */
            z-index: 55;
            
            /* Apparence */
            background: white;
            background-clip: padding-box;
            font-weight: 600;
            color: #667eea;
            
            /* Ombre de s√©paration */
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
            
            /* Optimisation */
            will-change: transform;
            
            /* Espacement */
            padding: 0 !important;
        }
        
        /* ============================================================
           COLONNE 3 - CEP (150px) - TBODY
        ============================================================ */
        
        .gantt-table tbody td:nth-child(3) {
            /* Position et dimensions - DOIT correspondre √† thead */
            position: sticky;
            left: 95px;
            width: 150px !important;
            min-width: 150px !important;
            max-width: 150px !important;
            
            /* Hi√©rarchie - Plus bas que thead */
            z-index: 54;
            
            /* Apparence */
            background: white;
            background-clip: padding-box;
            
            /* Ombre de s√©paration */
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
            
            /* Optimisation */
            will-change: transform;
            
            /* Espacement */
            padding: 0 !important;
        }
        
        /* ============================================================
           COLONNE 4 - Titre (400px) - TBODY
        ============================================================ */
        
        .gantt-table tbody td:nth-child(4) {
            /* Position et dimensions - DOIT correspondre √† thead */
            position: sticky;
            left: 245px;
            width: 400px !important;
            min-width: 400px !important;
            max-width: 400px !important;
            
            /* Hi√©rarchie - Plus bas que thead */
            z-index: 53;
            
            /* Apparence */
            background: white;
            background-clip: padding-box;
            text-align: left;
            overflow: hidden;
            text-overflow: ellipsis;
            
            /* Ombre de s√©paration */
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
            
            /* Optimisation */
            will-change: transform;
            
            /* Espacement */
            padding: 0 !important;
        }
        
        /* ============================================================
           COLONNE 5 - √âtat (150px) - TBODY
        ============================================================ */
        
        .gantt-table tbody td:nth-child(5) {
            /* Position et dimensions - DOIT correspondre √† thead */
            position: sticky;
            left: 645px;
            width: 150px !important;
            min-width: 150px !important;
            max-width: 150px !important;
            
            /* Hi√©rarchie - Plus bas que thead */
            z-index: 52;
            
            /* Apparence */
            background: white;
            background-clip: padding-box;
            text-align: center;
            
            /* Ombre de s√©paration */
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
            
            /* Optimisation */
            will-change: transform;
            
            /* Espacement */
            padding: 0 !important;
        }
        
        /* ============================================================
           COLONNE 6 - Date livrable (150px) - TBODY
        ============================================================ */
        
        .gantt-table tbody td:nth-child(6) {
            /* Position et dimensions - DOIT correspondre √† thead */
            position: sticky;
            left: 795px;
            width: 150px !important;
            min-width: 150px !important;
            max-width: 150px !important;
            
            /* Hi√©rarchie - Plus bas que thead */
            z-index: 51;
            
            /* Apparence */
            background: white;
            background-clip: padding-box;
            text-align: center;
            
            /* Ombre de s√©paration (derni√®re colonne sticky) */
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
            
            /* Optimisation */
            will-change: transform;
            
            /* Espacement */
            padding: 0 !important;
        }
        
        /* ============================================================
           PADDING INTERNE pour colonnes sticky TBODY
           Les colonnes sticky ont padding: 0, le padding est appliqu√©
           sur leurs √©l√©ments enfants pour √©viter les probl√®mes Firefox
        ============================================================ */
        
        .gantt-table tbody td:nth-child(1) > *,
        .gantt-table tbody td:nth-child(2) > *,
        .gantt-table tbody td:nth-child(3) > *,
        .gantt-table tbody td:nth-child(4) > *,
        .gantt-table tbody td:nth-child(5) > *,
        .gantt-table tbody td:nth-child(6) > * {
            padding: 0.6rem 0.5rem;
        }
        
        /* ============================================================
           LIGNES SP√âCIALES - Cong√©s, Maladie, Formation, Temps Partiel
           z-index 60 pour colonnes sticky (entre thead et tbody standard)
           z-index 45 pour cellules non-sticky
        ============================================================ */
        
        /* ---------- CONG√âS ---------- */
        .gantt-table tbody tr[data-type="conges"] td:nth-child(1),
        .gantt-table tbody tr[data-type="conges"] td:nth-child(2),
        .gantt-table tbody tr[data-type="conges"] td:nth-child(3),
        .gantt-table tbody tr[data-type="conges"] td:nth-child(4),
        .gantt-table tbody tr[data-type="conges"] td:nth-child(5),
        .gantt-table tbody tr[data-type="conges"] td:nth-child(6) {
            background: #fff3cd !important;
            background-clip: padding-box;
            z-index: 60 !important;
        }
        
        .gantt-table tbody tr[data-type="conges"] td {
            z-index: 45;
            position: relative;
        }
        
        /* ---------- MALADIE ---------- */
        .gantt-table tbody tr[data-type="maladie"] td:nth-child(1),
        .gantt-table tbody tr[data-type="maladie"] td:nth-child(2),
        .gantt-table tbody tr[data-type="maladie"] td:nth-child(3),
        .gantt-table tbody tr[data-type="maladie"] td:nth-child(4),
        .gantt-table tbody tr[data-type="maladie"] td:nth-child(5),
        .gantt-table tbody tr[data-type="maladie"] td:nth-child(6) {
            background: #f8d7da !important;
            background-clip: padding-box;
            z-index: 60 !important;
        }
        
        .gantt-table tbody tr[data-type="maladie"] td {
            z-index: 45;
            position: relative;
        }
        
        /* ---------- FORMATION ---------- */
        .gantt-table tbody tr[data-type="formation"] td:nth-child(1),
        .gantt-table tbody tr[data-type="formation"] td:nth-child(2),
        .gantt-table tbody tr[data-type="formation"] td:nth-child(3),
        .gantt-table tbody tr[data-type="formation"] td:nth-child(4),
        .gantt-table tbody tr[data-type="formation"] td:nth-child(5),
        .gantt-table tbody tr[data-type="formation"] td:nth-child(6) {
            background: #d1ecf1 !important;
            background-clip: padding-box;
            z-index: 60 !important;
        }
        
        .gantt-table tbody tr[data-type="formation"] td {
            z-index: 45;
            position: relative;
        }
        
        /* ---------- TEMPS PARTIEL ---------- */
        .gantt-table tbody tr[data-type="temps-partiel"] td:nth-child(1),
        .gantt-table tbody tr[data-type="temps-partiel"] td:nth-child(2),
        .gantt-table tbody tr[data-type="temps-partiel"] td:nth-child(3),
        .gantt-table tbody tr[data-type="temps-partiel"] td:nth-child(4),
        .gantt-table tbody tr[data-type="temps-partiel"] td:nth-child(5),
        .gantt-table tbody tr[data-type="temps-partiel"] td:nth-child(6) {
            background: #e2e3e5 !important;
            background-clip: padding-box;
            z-index: 60 !important;
        }
        
        .gantt-table tbody tr[data-type="temps-partiel"] td {
            z-index: 45;
            position: relative;
        }
        
        /* ---------- PROJETS (arri√®re-plan blanc pour sticky) ---------- */
        .gantt-table tbody tr[data-type="projet"] td:nth-child(1),
        .gantt-table tbody tr[data-type="projet"] td:nth-child(2),
        .gantt-table tbody tr[data-type="projet"] td:nth-child(3),
        .gantt-table tbody tr[data-type="projet"] td:nth-child(4),
        .gantt-table tbody tr[data-type="projet"] td:nth-child(5),
        .gantt-table tbody tr[data-type="projet"] td:nth-child(6) {
            background: white !important;
            background-clip: padding-box;
        }
        
        /* ============================================================
           INTERACTIONS ET HOVER
        ============================================================ */
        
        .gantt-table tbody tr:hover td {
            opacity: 0.9;
        }
        
        .gantt-table tbody tr[data-type="projet"]:hover td:nth-child(1),
        .gantt-table tbody tr[data-type="projet"]:hover td:nth-child(2),
        .gantt-table tbody tr[data-type="projet"]:hover td:nth-child(3),
        .gantt-table tbody tr[data-type="projet"]:hover td:nth-child(4),
        .gantt-table tbody tr[data-type="projet"]:hover td:nth-child(5),
        .gantt-table tbody tr[data-type="projet"]:hover td:nth-child(6) {
            background: #f8f9fa !important;
            background-clip: padding-box;
        }
        
        }
        
        .gantt-cell {
            text-align: center;
            min-width: 45px;
        }
        
        .gantt-cell-hours {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            border-radius: 4px;
            padding: 0.3rem;
            font-size: 0.8rem;
        }
        
        .gantt-cell-hours:hover {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
        }
        
        .badge {
            padding: 0.25rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            display: inline-block;
        }
        
        /* Badges plus compacts dans les pages agents */
        .gantt-table-excel tbody .badge {
            padding: 0.2rem 0.5rem;
            font-size: 0.65rem;
            border-radius: 8px;
            white-space: nowrap;
        }
        
        .badge-avenir { background: #fff3cd; color: #856404; }
        .badge-prise { background: #cce5ff; color: #004085; }
        .badge-externe { background: #d1ecf1; color: #0c5460; }
        
        /* Styles pour les inputs d'heures */
        .hour-input, .excel-input {
            width: 50px;
            padding: 0.3rem;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            text-align: center;
            font-size: 0.85rem;
            font-weight: 600;
            background: transparent;
            transition: all 0.2s ease;
        }
        
        .hour-input:focus, .excel-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
        }
            background: white;
            transform: scale(1.05);
        }
        
        .hour-input:hover, .excel-input:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }
        
        .hour-input::placeholder, .excel-input::placeholder {
            color: #ccc;
            font-weight: normal;
        }
        
        /* Animation pour les inputs remplis */
        .hour-input:valid:not(:placeholder-shown), 
        .excel-input:valid:not(:placeholder-shown) {
            background: rgba(40, 167, 69, 0.05);
            border-color: #28a745;
            font-weight: 700;
        }
        
        /* Styles Excel-like am√©lior√©s */
        .gantt-table-excel thead tr {
            position: sticky;
            transition: box-shadow 0.3s ease;
        }
        
        .gantt-table-excel thead tr:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .gantt-table-excel .excel-row-1 { position: sticky; top: 0; z-index: 200; height: 27px; }
        .gantt-table-excel .excel-row-2 { position: sticky; top: 27px; z-index: 199; height: 27px; }
        .gantt-table-excel .excel-row-3 { position: sticky; top: 54px; z-index: 198; height: 27px; }
        .gantt-table-excel .excel-row-4 { position: sticky; top: 81px; z-index: 197; height: 27px; }
        .gantt-table-excel .excel-row-5 { position: sticky; top: 108px; z-index: 196; height: 27px; }
        .gantt-table-excel .excel-row-6 { position: sticky; top: 135px; z-index: 195; height: 27px; }
        .gantt-table-excel .excel-row-7 { position: sticky; top: 162px; z-index: 194; height: 27px; }
        .gantt-table-excel .excel-row-8 { position: sticky; top: 189px; z-index: 193; height: 40px; }
        
        /* R√©duire le padding des cellules dans les 8 premi√®res lignes */
        .gantt-table-excel thead tr.excel-row-1 th,
        .gantt-table-excel thead tr.excel-row-2 th,
        .gantt-table-excel thead tr.excel-row-3 th,
        .gantt-table-excel thead tr.excel-row-4 th,
        .gantt-table-excel thead tr.excel-row-5 th,
        .gantt-table-excel thead tr.excel-row-6 th,
        .gantt-table-excel thead tr.excel-row-7 th,
        .gantt-table-excel thead tr.excel-row-8 th {
            padding: 0.3rem 0.3rem;
            font-size: 0.75rem;
            line-height: 1.2;
        }
        
        /* R√©duire la taille des inputs dans les lignes Excel */
        .gantt-table-excel thead .excel-input {
            width: 45px;
            padding: 0.2rem;
            font-size: 0.75rem;
        }
        
        /* Cellules √©ditables - alternance bleu pastel clair */
        .excel-editable {
            background: white !important;
            transition: all 0.2s ease;
        }
        
        .excel-editable:hover {
            background: #e3f2fd !important;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* Cellules calcul√©es - blanc aussi */
        .excel-calculated {
            background: white !important;
            font-weight: 700;
            position: relative;
        }
        
        .excel-calculated::after {
            content: 'üîí';
            position: absolute;
            right: 4px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.7rem;
            opacity: 0.3;
        }
        
        /* Alternance de couleur bleu pastel tr√®s clair sur les colonnes de semaines */
        .gantt-table-excel thead th:nth-child(even):not(:nth-child(2)):not(:nth-child(4)),
        .gantt-table-excel tbody td:nth-child(even):not(:nth-child(2)):not(:nth-child(4)) {
            background: #f0f8ff !important;
        }
        
        .gantt-table-excel thead th:nth-child(odd):not(:nth-child(1)):not(:nth-child(3)):not(:nth-child(5)),
        .gantt-table-excel tbody td:nth-child(odd):not(:nth-child(1)):not(:nth-child(3)):not(:nth-child(5)) {
            background: white !important;
        }
        
        /* Conserver les fonds pour les lignes d'en-t√™te Excel (lignes 1-7) */
        .gantt-table-excel .excel-row-1 th,
        .gantt-table-excel .excel-row-2 th,
        .gantt-table-excel .excel-row-3 th {
            background: #f5f5f5 !important;
        }
        
        .gantt-table-excel .excel-row-4 th,
        .gantt-table-excel .excel-row-5 th,
        .gantt-table-excel .excel-row-6 th,
        .gantt-table-excel .excel-row-7 th,
        .gantt-table-excel .excel-row-8 th {
            background: white !important;
        }
        
        /* Alterner bleu pastel sur les colonnes de semaines dans les en-t√™tes */
        .gantt-table-excel thead th:nth-child(even):not(:nth-child(2)):not(:nth-child(4)) {
            background: #e3f2fd !important;
        }
        
        /* Animation pour les valeurs qui changent */
        @keyframes valueChange {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); color: #667eea; }
            100% { transform: scale(1); }
        }
        
        .value-changed {
            animation: valueChange 0.4s ease;
        }
        
        /* En-t√™tes Excel - am√©lior√©s */
        .excel-header {
            background: #e9ecef !important;
            font-weight: 700;
            text-align: right;
            padding-right: 0.8rem;
            border-right: 2px solid white !important;
            text-shadow: 0 1px 2px rgba(255,255,255,0.8);
        }
        
        /* Colonnes fig√©es A-E dans le style Excel */
        .gantt-table-excel thead th:nth-child(1),
        .gantt-table-excel thead th:nth-child(2),
        .gantt-table-excel thead th:nth-child(3),
        .gantt-table-excel thead th:nth-child(4),
        .gantt-table-excel thead th:nth-child(5) {
            position: sticky;
            left: 0;
            z-index: 1000;
        }
        
        .gantt-table-excel thead th:nth-child(1) {
            width: 60px;
            min-width: 60px;
            max-width: 60px;
        }
        
        .gantt-table-excel thead th:nth-child(2) {
            left: 60px;
            width: 120px;
            min-width: 120px;
            max-width: 120px;
        }
        
        .gantt-table-excel thead th:nth-child(3) {
            left: 180px;
            width: 320px;
            min-width: 320px;
            max-width: 320px;
        }
        
        .gantt-table-excel thead th:nth-child(4) {
            left: 500px;
            width: 100px;
            min-width: 100px;
            max-width: 100px;
        }
        
        .gantt-table-excel thead th:nth-child(5) {
            left: 600px;
            width: 150px;
            min-width: 150px;
            max-width: 150px;
        }
        
        .gantt-table-excel tbody td:nth-child(1),
        .gantt-table-excel tbody td:nth-child(2),
        .gantt-table-excel tbody td:nth-child(3),
        .gantt-table-excel tbody td:nth-child(4),
        .gantt-table-excel tbody td:nth-child(5) {
            position: sticky;
            z-index: 600;
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
        }
        
        .gantt-table-excel tbody td:nth-child(1) {
            left: 0;
            width: 60px;
            min-width: 60px;
            max-width: 60px;
        }
        
        .gantt-table-excel tbody td:nth-child(2) {
            left: 60px;
            width: 120px;
            min-width: 120px;
            max-width: 120px;
        }
        
        .gantt-table-excel tbody td:nth-child(3) {
            left: 180px;
            width: 320px;
            min-width: 320px;
            max-width: 320px;
        }
        
        .gantt-table-excel tbody td:nth-child(4) {
            left: 500px;
            width: 100px;
            min-width: 100px;
            max-width: 100px;
        }
        
        .gantt-table-excel tbody td:nth-child(5) {
            left: 600px;
            width: 120px;
            min-width: 120px;
            max-width: 120px;
        }
        
        /* Style pour le bouton toggle */
        .btn-toggle {
            padding: 0.6rem 1.2rem;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-toggle:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }
        
        .btn-toggle:active {
            transform: translateY(0);
        }
        
        /* Classes pour les semaines pass√©es */
        .past-week {
            background: #f8f9fa;
        }
        
        .gantt-table tbody tr .past-week {
            opacity: 0.7;
        }
        
        .week-header {
            writing-mode: horizontal-tb;
            white-space: nowrap;
        }
        
        .week-number {
            font-weight: 700;
            color: #667eea;
        }
        
        .week-date {
            font-size: 0.7rem;
            color: #999;
            display: block;
        }
        
        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .stat-card {
            background: white;
            padding: 1.2rem;
            border-radius: 10px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            border-left: 4px solid #667eea;
        }
        
        .stat-card h3 {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-card .value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .stat-card-small {
            padding: 1rem;
        }
        
        .stat-card-small h3 {
            font-size: 0.75rem;
        }
        
        .stat-card-small .value {
            font-size: 1.5rem;
        }
        
        .stat-card-year {
            border-left-color: #28a745;
        }
        
        .stats-section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .stats-section-title {
            font-size: 1.1rem;
            color: #2c3e50;
            margin-bottom: 1rem;
            font-weight: 600;
        }
        
        .year-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid #28a745;
        }
        
        .year-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.8rem;
            border-bottom: 2px solid #dee2e6;
        }
        
        .year-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #28a745;
            margin: 0;
        }
        
        .year-total {
            font-size: 0.9rem;
            color: #666;
            font-weight: 600;
            background: white;
            padding: 0.4rem 1rem;
            border-radius: 20px;
        }
        
        .stat-card-mini {
            padding: 0.8rem;
            min-width: 120px;
        }
        
        .stat-card-mini h3 {
            font-size: 0.7rem;
        }
        
        .stat-card-mini .value {
            font-size: 1.3rem;
        }
        
        .charts-section {
            margin-top: 2rem;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .chart-container {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .chart-container-wide {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .chart-title {
            font-size: 1rem;
            color: #2c3e50;
            margin-bottom: 1.5rem;
            font-weight: 600;
            text-align: center;
        }
        
        canvas {
            max-height: 350px;
        }
        
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #6c757d;
        }
        
        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }
        
        .projects-table-container {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            overflow: auto;
            max-height: calc(100vh - 300px);
        }
        
        .projects-table-gest {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            max-width: 100%;
            table-layout: fixed;
        }
        
        .projects-table-gest thead th {
            background: white;
            padding: 0.8rem 0.3rem;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 600;
            color: #495057;
            border-bottom: 2px solid #dee2e6;
            vertical-align: middle;
            position: sticky;
            top: 0;
            z-index: 9999;
            white-space: normal;
            word-wrap: break-word;
            line-height: 1.3;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .projects-table-gest thead {
            position: relative;
            z-index: 9999;
        }
        
        /* Couleurs pour les colonnes heures (ANc √† Heures projet) */
        /* Colonnes 7-11 : ANc, NGl, MSt, PCs, PAe - Bleu */
        .projects-table-gest thead th:nth-child(7),
        .projects-table-gest thead th:nth-child(8),
        .projects-table-gest thead th:nth-child(9),
        .projects-table-gest thead th:nth-child(10),
        .projects-table-gest thead th:nth-child(11) {
            text-align: center;
            background: #e7f3ff !important;
            color: #0066cc;
            border-left: 3px solid white;
            z-index: 9999 !important;
        }
        
        /* Colonne 12 : Total cumul√© agents - Vert */
        .projects-table-gest thead th:nth-child(12) {
            text-align: center;
            background: #d4edda !important;
            color: #155724;
            border-left: 3px solid white;
            z-index: 9999 !important;
        }
        
        /* Colonne 13 : Heures projet - Jaune */
        .projects-table-gest thead th:nth-child(13) {
            text-align: center;
            background: #fff3cd !important;
            color: #856404;
            border-left: 3px solid white;
            z-index: 9999 !important;
        }
        
        .projects-table-gest tbody td {
            padding: 0.5rem 0.3rem;
            border-bottom: 1px solid #f1f3f5;
            font-size: 0.8rem;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .projects-table-gest tbody tr {
            background: white;
        }
        
        .projects-table-gest tbody {
        }
        
        /* Largeurs des colonnes */
        .projects-table-gest th:nth-child(1),
        .projects-table-gest td:nth-child(1) {
            width: 35px;
            min-width: 35px;
        }
        
        .projects-table-gest th:nth-child(2),
        .projects-table-gest td:nth-child(2) {
            width: 75px;
            min-width: 75px;
        }
        
        .projects-table-gest th:nth-child(3),
        .projects-table-gest td:nth-child(3) {
            width: 100px;
            min-width: 100px;
        }
        
        .projects-table-gest th:nth-child(4),
        .projects-table-gest td:nth-child(4) {
            width: 80px;
            min-width: 80px;
        }
        
        .projects-table-gest th:nth-child(5),
        .projects-table-gest td:nth-child(5) {
            width: 40px;
            min-width: 40px;
        }
        
        .projects-table-gest th:nth-child(6),
        .projects-table-gest td:nth-child(6) {
            width: 120px;
            min-width: 120px;
        }
        
        .projects-table-gest th:nth-child(7),
        .projects-table-gest td:nth-child(7),
        .projects-table-gest th:nth-child(8),
        .projects-table-gest td:nth-child(8),
        .projects-table-gest th:nth-child(9),
        .projects-table-gest td:nth-child(9),
        .projects-table-gest th:nth-child(10),
        .projects-table-gest td:nth-child(10),
        .projects-table-gest th:nth-child(11),
        .projects-table-gest td:nth-child(11) {
            width: 38px !important;
            min-width: 38px !important;
            max-width: 38px !important;
            overflow: hidden;
            text-overflow: clip;
            white-space: nowrap;
        }
        
        .projects-table-gest th:nth-child(12),
        .projects-table-gest td:nth-child(12) {
            width: 50px !important;
            min-width: 50px !important;
            max-width: 50px !important;
            overflow: hidden;
            text-overflow: clip;
            white-space: nowrap;
        }
        
        .projects-table-gest th:nth-child(13),
        .projects-table-gest td:nth-child(13) {
            width: 50px !important;
            min-width: 50px !important;
            max-width: 50px !important;
            overflow: hidden;
            text-overflow: clip;
            white-space: nowrap;
        }
        
        .projects-table-gest th:nth-child(14),
        .projects-table-gest td:nth-child(14) {
            width: 65px;
            min-width: 65px;
        }
        
        .projects-table-gest th:nth-child(15),
        .projects-table-gest td:nth-child(15) {
            width: 75px;
            min-width: 75px;
        }
        
        .projects-table-gest tbody tr:hover {
            background: #f8f9fa;
        }
        
        .projects-table-gest tbody td:nth-child(5),
        .projects-table-gest tbody td:nth-child(6),
        .projects-table-gest tbody td:nth-child(7),
        .projects-table-gest tbody td:nth-child(8),
        .projects-table-gest tbody td:nth-child(9) {
            text-align: center;
        }
        
        .projects-table-gest tbody td:nth-child(10) {
            text-align: center;
        }
        
        .projects-table-gest tbody td:nth-child(11) {
            text-align: center;
        }
        
        .projects-table-gest tbody td:nth-child(12) {
            text-align: center;
        }
        
        .projects-table-gest tbody td:nth-child(13) {
            text-align: center;
        }
        
        /* Centrage vertical et horizontal des colonnes heures (7-13) */
        .projects-table-gest tbody td:nth-child(7),
        .projects-table-gest tbody td:nth-child(8),
        .projects-table-gest tbody td:nth-child(9),
        .projects-table-gest tbody td:nth-child(10),
        .projects-table-gest tbody td:nth-child(11),
        .projects-table-gest tbody td:nth-child(12),
        .projects-table-gest tbody td:nth-child(13) {
            text-align: center;
            vertical-align: middle;
        }
        
        /* R√©duire la police des colonnes heures (7-13) pour uniformit√© */
        .projects-table-gest tbody td:nth-child(7),
        .projects-table-gest tbody td:nth-child(8),
        .projects-table-gest tbody td:nth-child(9),
        .projects-table-gest tbody td:nth-child(10),
        .projects-table-gest tbody td:nth-child(11),
        .projects-table-gest tbody td:nth-child(12),
        .projects-table-gest tbody td:nth-child(13) {
            font-size: 0.75rem;
            padding: 0.3rem 0.1rem;
        }
        
        .projects-table-gest thead th:nth-child(7),
        .projects-table-gest thead th:nth-child(8),
        .projects-table-gest thead th:nth-child(9),
        .projects-table-gest thead th:nth-child(10),
        .projects-table-gest thead th:nth-child(11),
        .projects-table-gest thead th:nth-child(12),
        .projects-table-gest thead th:nth-child(13) {
            font-size: 0.75rem;
            padding: 0.5rem 0.1rem;
        }
        
        .total-projet {
            color: #0066cc;
            font-size: 0.95rem;
        }
        
        .days-remaining {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .days-overdue {
            background: #dc3545;
            color: white;
        }
        
        .days-today {
            background: #ffc107;
            color: #000;
        }
        
        .days-urgent {
            background: #ff6b6b;
            color: white;
        }
        
        .days-soon {
            background: #ffa726;
            color: white;
        }
        
        .days-ok {
            background: #66bb6a;
            color: white;
        }
        
        .alert-section {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .alert-section-danger {
            border-left: 5px solid #dc3545;
        }
        
        .alert-section-warning {
            border-left: 5px solid #ffa726;
        }
        
        .alert-section-title {
            font-size: 1.2rem;
            color: #2c3e50;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }
        
        .hours-input {
            width: 70px;
            padding: 0.4rem;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .hours-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .hours-input:hover {
            border-color: #667eea;
        }
        
        .cep-select {
            width: 100%;
            max-width: 200px;
            padding: 0.4rem;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.85rem;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .cep-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .cep-select:hover {
            border-color: #667eea;
        }
        
        .etat-select {
            width: 100%;
            max-width: 150px;
            padding: 0.4rem;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.85rem;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .etat-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .etat-select:hover {
            border-color: #667eea;
        }
        
        .etat-select-alert {
            width: 100%;
            max-width: 150px;
            padding: 0.4rem;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.85rem;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .etat-select-alert:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .etat-select-alert:hover {
            border-color: #667eea;
        }
        
        .agents-checkboxes {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
        }
        
        .agent-checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-size: 0.85rem;
            padding: 0.2rem;
            border-radius: 4px;
            transition: background 0.2s;
        }
        
        .agent-checkbox:hover {
            background: #f0f4ff;
        }
        
        .agent-checkbox input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
            accent-color: #667eea;
        }
        
        .agent-checkbox span {
            font-weight: 600;
            color: #495057;
        }
        
        .agent-checkbox input[type="checkbox"]:checked + span {
            color: #667eea;
        }
        
        .specialites-checkboxes {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
        }
        
        .specialite-checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-size: 0.8rem;
            padding: 0.2rem;
            border-radius: 4px;
            transition: background 0.2s;
        }
        
        .specialite-checkbox:hover {
            background: #fff3e0;
        }
        
        .specialite-checkbox input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
            accent-color: #ff9800;
        }
        
        .specialite-checkbox span {
            font-weight: 500;
            color: #666;
        }
        
        .specialite-checkbox input[type="checkbox"]:checked + span {
            color: #ff9800;
            font-weight: 600;
        }
        
        .parametrage-container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .parametrage-section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .parametrage-section h3 {
            font-size: 1.2rem;
            color: #2c3e50;
            margin-bottom: 1rem;
        }
        
        /* Styles pour le tableau des taux d'improductivit√© */
        .improd-rates-container {
            overflow-x: auto;
        }
        
        .improd-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        .improd-table thead th {
            background: #f8f9fa;
            padding: 1rem;
            text-align: left;
            font-size: 0.85rem;
            font-weight: 600;
            color: #495057;
            border-bottom: 2px solid #dee2e6;
        }
        
        .improd-table tbody td {
            padding: 1rem;
            border-bottom: 1px solid #f1f3f5;
        }
        
        .improd-table tbody tr:hover {
            background: #f8f9fa;
        }
        
        .taux-input {
            width: 80px;
            padding: 0.5rem;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
        }
        
        .taux-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .unit {
            margin-left: 0.5rem;
            color: #666;
            font-weight: 600;
        }
        
        .hours-display {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .hours-display.calculated {
            color: #667eea;
            font-size: 1.1rem;
        }
        
        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #667eea;
            padding: 1rem;
            border-radius: 6px;
        }
        
        .info-box code {
            background: rgba(102, 126, 234, 0.1);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        
        .parametrage-info {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .parametrage-info h3 {
            font-size: 1.2rem;
            color: #2c3e50;
            margin-bottom: 1rem;
        }
        
        .niveaux-legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .niveau-badge {
            padding: 0.8rem 1rem;
            border-radius: 8px;
            border: 2px solid;
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
        }
        
        .competences-table-container {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            overflow-x: auto;
            margin-bottom: 1.5rem;
        }
        
        .competences-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }
        
        .competences-table thead th {
            background: #f8f9fa;
            padding: 1rem;
            text-align: center;
            font-size: 0.85rem;
            font-weight: 600;
            color: #495057;
            border-bottom: 2px solid #dee2e6;
        }
        
        .competences-table tbody td {
            padding: 1rem;
            text-align: center;
            border-bottom: 1px solid #f1f3f5;
        }
        
        .competences-table tbody tr:hover {
            background: #f8f9fa;
        }
        
        .competences-table .agent-name {
            text-align: left;
            font-size: 0.95rem;
            min-width: 200px;
        }
        
        .niveau-select {
            width: 100%;
            max-width: 180px;
            padding: 0.5rem;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .niveau-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .niveau-select:hover {
            border-color: #667eea;
        }
        
        .parametrage-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }
        
        .date-input {
            width: 100%;
            max-width: 150px;
            padding: 0.4rem;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.85rem;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .date-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .date-input:hover {
            border-color: #667eea;
        }
        
        .date-input::-webkit-calendar-picker-indicator {
            cursor: pointer;
            filter: opacity(0.6);
        }
        
        .date-input::-webkit-calendar-picker-indicator:hover {
            filter: opacity(1);
        }
        
        .date-input-alert {
            width: 100%;
            max-width: 150px;
            padding: 0.4rem;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.85rem;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .date-input-alert:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .date-input-alert:hover {
            border-color: #667eea;
        }
        
        .date-input-alert::-webkit-calendar-picker-indicator {
            cursor: pointer;
            filter: opacity(0.6);
        }
        
        .date-input-alert::-webkit-calendar-picker-indicator:hover {
            filter: opacity(1);
        }
        
        .no-date-row {
            background-color: #FFD3CC !important;
        }
        
        .no-date-row:hover {
            background-color: #FFC4BA !important;
        }
        
        .termine-row {
            background-color: #CCFFEB !important;
        }
        
        .termine-row:hover {
            background-color: #B8F5DC !important;
        }
        
        .orpheline-row {
            background-color: #e9ecef !important;
        }
        
        .orpheline-row:hover {
            background-color: #dee2e6 !important;
        }
        
        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-toggle {
            padding: 0.5rem 1rem;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-toggle:hover {
            background: #667eea;
            color: white;
            transform: translateY(-1px);
        }
        
        .btn-toggle-hidden {
            border-color: #dc3545;
            color: #dc3545;
        }
        
        .btn-toggle-hidden:hover {
            background: #dc3545;
            color: white;
        }
        
        .project-description {
            max-width: 90px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        /* Am√©lioration pour les tables de gestion */
        .projects-table-gest tbody td:nth-child(3) .project-description {
            max-width: none;
            white-space: normal;
            word-wrap: break-word;
            line-height: 1.4;
        }
        
        /* Am√©lioration pour les pages agents (tables Excel) */
        .gantt-table-excel tbody td:nth-child(3) .project-description {
            max-width: none;
            white-space: normal;
            word-wrap: break-word;
            line-height: 1.5;
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.9rem;
            margin-bottom: 0.3rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .gantt-table-excel tbody td:nth-child(3) small {
            display: block;
            margin-top: 0.3rem;
            padding-top: 0.3rem;
            border-top: 1px solid rgba(0,0,0,0.05);
            font-size: 0.75rem;
            color: #6c757d !important;
        }
        
        .gantt-table-excel tbody td:nth-child(3) {
            padding: 0.8rem 0.5rem !important;
            vertical-align: top;
        }
        
        /* Effet hover sur les descriptions */
        .gantt-table-excel tbody tr:hover .project-description {
            color: #667eea;
        }
        
        .total-hours {
            font-weight: 700;
            color: #667eea;
            font-size: 0.95rem;
        }
        
        .current-week {
            background: #fff3cd !important;
        }
        
        .filters {
            background: white;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }
        
        .filter-group label {
            font-size: 0.8rem;
            color: #666;
            font-weight: 500;
        }
        
        .filter-group input {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
            min-width: 200px;
        }
        
        .filter-group select {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
            min-width: 160px;
            background: white;
            cursor: pointer;
        }
        
        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìä Tableau de Bord Gantt - Gestion des Projets 2025</h1>
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchView('dashboard')">üìä Tableau de bord</button>
            <button class="nav-tab" onclick="switchView('alertes')">‚ö†Ô∏è Alertes</button>
            <button class="nav-tab" onclick="switchView('sans-date')">üìÖ Sans Date</button>
            <button class="nav-tab" onclick="switchView('gestionnaire')">üëî Vue Gestionnaire</button>
            <button class="nav-tab" onclick="switchView('parametrage')">‚öôÔ∏è Param√©trage</button>
            <button class="nav-tab" onclick="switchView('ANc')">üë§ Amaury (ANc)</button>
            <button class="nav-tab" onclick="switchView('PCs')">üë§ Paul C. (PCs)</button>
            <button class="nav-tab" onclick="switchView('NGl')">üë§ Nicolas (NGl)</button>
            <button class="nav-tab" onclick="switchView('PAe')">üë§ Paul A. (PAe)</button>
            <button class="nav-tab" onclick="switchView('MSt')">üë§ Micha√´l (MSt)</button>
        </div>
    </div>

    <div class="container">
        <!-- Vue Tableau de bord -->
        <div id="view-dashboard" class="view active">
            <div class="gantt-header">
                <h2>üìä Tableau de Bord - Vue d'ensemble</h2>
                <p class="subtitle">Statistiques globales et indicateurs de performance</p>
            </div>
            <div id="dashboard-content"></div>
        </div>

        <!-- Vue Alertes -->
        <div id="view-alertes" class="view">
            <div class="gantt-header">
                <h2>‚ö†Ô∏è Alertes - Projets Urgents et en Retard</h2>
                <p class="subtitle">Affaires d√©pass√©es ou √† moins de 30 jours du rendu</p>
            </div>
            <div id="alertes-content"></div>
        </div>

        <!-- Vue Sans Date -->
        <div id="view-sans-date" class="view">
            <div class="gantt-header">
                <h2>üìÖ Projets Sans Date de Livrable</h2>
                <p class="subtitle">Affaires sans date de rendu √† d√©finir</p>
            </div>
            <div id="sans-date-content"></div>
        </div>

        <!-- Vue Param√©trage -->
        <div id="view-parametrage" class="view">
            <div class="gantt-header">
                <h2>‚öôÔ∏è Param√©trage des Comp√©tences Agents</h2>
                <p class="subtitle">D√©finir le niveau de comp√©tence de chaque agent par sp√©cialit√©</p>
            </div>
            <div id="parametrage-content"></div>
        </div>

        <!-- Vue Gestionnaire -->
        <div id="view-gestionnaire" class="view">
            <div class="gantt-header">
                <h2>üìã Vue Gestionnaire - Gestion des projets</h2>
                <p class="subtitle">Affectation des heures et gestion des CEP</p>
            </div>
            
            <div class="filters">
                <div class="filter-group">
                    <label>üîç Recherche</label>
                    <input type="text" id="search-gestionnaire" placeholder="Rechercher..." onkeyup="filterGestionnaire()">
                </div>
                <div class="filter-group">
                    <label>üìå √âtat</label>
                    <select id="filter-etat" onchange="filterGestionnaire()">
                        <option value="">Tous les √©tats</option>
                        <option value="A venir">√Ä venir</option>
                        <option value="Termin√©">Termin√©</option>
                        <option value="Prise en charge">Prise en charge</option>
                        <option value="Orpheline">Orpheline</option>
                        <option value="Externalis√©">Externalis√©</option>
                        <option value="Pas d'impact TL">Pas d'impact TL</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>üë§ CEP</label>
                    <select id="filter-cep" onchange="filterGestionnaire()">
                        <option value="">Tous les CEP</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>üë• Agent</label>
                    <select id="filter-agent" onchange="filterGestionnaire()">
                        <option value="">Tous les agents</option>
                        <option value="ANc">Amaury (ANc)</option>
                        <option value="NGl">Nicolas (NGl)</option>
                        <option value="MSt">Micha√´l (MSt)</option>
                        <option value="PCs">Paul C. (PCs)</option>
                        <option value="PAe">Paul A. (PAe)</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>üìÖ Date</label>
                    <select id="filter-date" onchange="filterGestionnaire()">
                        <option value="">Toutes</option>
                        <option value="avec-date">Avec date</option>
                        <option value="sans-date">Sans date</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>&nbsp;</label>
                    <button id="toggle-orphelines" class="btn btn-toggle" onclick="toggleOrphelines()">
                        <span id="toggle-orphelines-icon">üëÅÔ∏è</span> <span id="toggle-orphelines-text">Masquer orphelines</span>
                    </button>
                </div>
                <div class="filter-group">
                    <label>&nbsp;</label>
                    <button id="toggle-termines" class="btn btn-toggle" onclick="toggleTermines()">
                        <span id="toggle-termines-icon">üëÅÔ∏è</span> <span id="toggle-termines-text">Masquer termin√©s</span>
                    </button>
                </div>
                <div class="filter-group">
                    <label>&nbsp;</label>
                    <button id="toggle-secondaires" class="btn btn-toggle" onclick="toggleSecondaires()">
                        <span id="toggle-secondaires-icon">üëÅÔ∏è</span> <span id="toggle-secondaires-text">Masquer secondaires</span>
                    </button>
                </div>
            </div>
            
            <div id="gestionnaire-content"></div>
        </div>

        <!-- Vues Agents -->
        <div id="view-ANc" class="view"></div>
        <div id="view-PCs" class="view"></div>
        <div id="view-NGl" class="view"></div>
        <div id="view-PAe" class="view"></div>
        <div id="view-MSt" class="view"></div>
    </div>

    <script>
        // Configuration des agents
        const AGENTS = {
            'ANc': { nom: 'Amaury NEDELLEC', col: 12 },
            'NGl': { nom: 'Nicolas GALL', col: 13 },
            'MSt': { nom: 'Micha√´l SARRAT', col: 14 },
            'PCs': { nom: 'Paul COLLONGUES', col: 16 },
            'PAe': { nom: 'Paul ABDELMOUMENE', col: 17 }
        };
        
        // Taux d'improductivit√© par agent (en %)
        let tauxImproductivite = {
            'ANc': 10,
            'NGl': 10,
            'MSt': 10,
            'PCs': 10,
            'PAe': 10
        };

        // √âtats autoris√©s pour les vues agents
        const ETATS_AGENTS = ['A venir', 'Prise en charge', 'Externalis√©'];

        // Donn√©es des projets
        let projetsData = [
  {
    "ref": 1,
    "etat": "Termin√©",
    "cep": "Alexandre BOISSET",
    "pl": "PLVU724",
    "eco": "??",
    "description": "Am√©nagement nouvelle entr√©e Raynal - Etudes pour la DT",
    "livrable": "2025-07-11",
    "heures_totales": 100,
    "agents": "MSt, NGl",
    "heures_agents": {
      "Agent2": 10,
      "Agent3": 90
    }
  },
  {
    "ref": 2,
    "etat": "Termin√©",
    "cep": "Micka√´l MARTEL",
    "pl": "PLSM677",
    "eco": "TL-2021-0107",
    "description": "L590-REA-SR CAT V1-V2 PK600 √† 630 - Cahors √† Montpezat",
    "livrable": "2025-09-19",
    "heures_totales": 200,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 3,
    "etat": "Termin√©",
    "cep": "Christophe CANCE",
    "pl": "PLVE317",
    "eco": "LM-2022-0019",
    "description": "L590 PRO Projet am√©lioration de l'axe POLT",
    "livrable": "2024-06-28",
    "heures_totales": 170,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 4,
    "etat": "Termin√©",
    "cep": "Christophe CANCE",
    "pl": "XXXX",
    "eco": "LM-2022-0019",
    "description": "L590 DCE Projet am√©lioration de l'axe POLT",
    "livrable": "2024-12-13",
    "heures_totales": 200,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 5,
    "etat": "A venir",
    "cep": "Franck PEUCHAMIEL",
    "pl": "XXXX",
    "eco": "LM-2022-0019",
    "description": "L590 REA MOEE Projet am√©lioration de l'axe POLT",
    "livrable": "XXX",
    "heures_totales": 185,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 6,
    "etat": "A venir",
    "cep": "Franck PEUCHAMIEL",
    "pl": "XXXX",
    "eco": "LM-2022-0019",
    "description": "L590 REA SNCF E Projet am√©lioration de l'axe POLT",
    "livrable": "XXX",
    "heures_totales": 35,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 7,
    "etat": "A venir",
    "cep": "Christophe CANCE",
    "pl": "XXXX",
    "eco": "LM-2023-00XX",
    "description": "L590 REA  Escabelles sur Cahors",
    "livrable": "XXX",
    "heures_totales": 60,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 8,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLSR185",
    "eco": "PLSR185",
    "description": "L650 REA SDNA TARBES",
    "livrable": "2022-06-28",
    "heures_totales": 104,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 9,
    "etat": "Termin√©",
    "cep": "Anthony MUTLU",
    "pl": "PLTS148",
    "eco": "TL.2019.0069",
    "description": "DCE L640 Cr√©ation  halte LABEGE LA CADENE - travaux connexes",
    "livrable": "2023-05-31",
    "heures_totales": 45,
    "agents": "BLs",
    "heures_agents": {}
  },
  {
    "ref": 10,
    "etat": "Termin√©",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "PLSS161",
    "eco": "TL.2020.0030",
    "description": "MOEE REA PAI FIGEAC",
    "livrable": "2022-11-30",
    "heures_totales": 168,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 11,
    "etat": "Orpheline",
    "cep": "Anthony MUTLU",
    "pl": "XXXX",
    "eco": "TL.2022.0132",
    "description": "REA L590 MDS PK571+395D / PK571+409G",
    "livrable": "2027-01-01",
    "heures_totales": 50,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 12,
    "etat": "A venir",
    "cep": "Anthony MUTLU",
    "pl": "XXXX",
    "eco": "TL.2023.0002",
    "description": "EP L667 - Ajout poste GSM-R - Gare de Lannemezan",
    "livrable": "XXX",
    "heures_totales": 35,
    "agents": "ANc",
    "heures_agents": {}
  },
  {
    "ref": 13,
    "etat": "Termin√©",
    "cep": "Franck COPPILLIE",
    "pl": "PLTV088",
    "eco": "TL.2023.0008",
    "description": "EP D√©m√©nagement CSS et passage sous pirate",
    "livrable": "2023-04-28",
    "heures_totales": 120,
    "agents": "BLs",
    "heures_agents": {}
  },
  {
    "ref": 14,
    "etat": "A venir",
    "cep": "Alexandre BOISSET",
    "pl": "XXXX",
    "eco": "TL.2023.0032",
    "description": "L650-APO-RAV Tarbes vers Bayonne-F47844",
    "livrable": "2026-03-06",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 15,
    "etat": "Pas d'impact TL",
    "cep": "Alexandre BOISSET",
    "pl": "XXXX",
    "eco": "TL.2023.0033",
    "description": "L650-APO-RAV Lourdes-F52872\n2 APO, 1 sp√©cifique pour la radio",
    "livrable": "2025-09-30",
    "heures_totales": 50,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 16,
    "etat": "Pas d'impact TL",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL.2023.0077",
    "description": "L590-EP-r√©fection √©tanch√©it√© d√©faillante sur 2 PRa Pech de Boissi√®res PK 587+630 et RD 12 PK 587+258 - F71148",
    "livrable": "2025-12-26",
    "heures_totales": 40,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 17,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL.2023.0078",
    "description": "EP L640 Km 298 canal du midi Etanch√©it√© des ponts rails et forages d'appel",
    "livrable": "XXX",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 18,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "PLUV260",
    "eco": "TL.2023.0090",
    "description": "LDFT_L718 L701 Accompagnement donn√©es d'entr√©es Etudes fermeture Brive-Rodez",
    "livrable": "2024-01-12",
    "heures_totales": 16,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 19,
    "etat": "Termin√©",
    "cep": "Franck COPPILLIE",
    "pl": "PLUT906",
    "eco": "TL.2023.0093",
    "description": "REA L640 R√©g√©n√©ration PMPA St Jory Triage",
    "livrable": "2024-06-27",
    "heures_totales": 80,
    "agents": "NGl + MSt",
    "heures_agents": {}
  },
  {
    "ref": 20,
    "etat": "Termin√©",
    "cep": "Micka√´l MARTEL",
    "pl": "PLVG755",
    "eco": "TL.2023.0099",
    "description": "DI L590 - R√©g√©n√©ration Viaduc du Lot √† Cahors",
    "livrable": "2025-05-22",
    "heures_totales": 56,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 21,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL.2023.0152",
    "description": "EP L640 PK286+989 et 291+357 ‚Äì Etanch√©it√© ponts rails et forages d‚Äôappel",
    "livrable": "2027-01-08",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 22,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL.2023.0153",
    "description": "L590-EP-RVB V1 + V2 St Denis Catus avec √©tanch√©it√© du Viaduc - F70573\n",
    "livrable": "2025-12-05",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 23,
    "etat": "Orpheline",
    "cep": "Alexandre BOISSET",
    "pl": "XXXX",
    "eco": "TL.2023.0161",
    "description": "EP L672 RR2F tunnel de COULOUBRET",
    "livrable": "XXX",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 24,
    "etat": "A venir",
    "cep": "Alexandre BOISSET",
    "pl": "PLVJ529",
    "eco": "TL.2024.0015",
    "description": "L648-DCE/REA-Remplacement TMPJ Arrats et Gimone-F64928",
    "livrable": "2026-08-07",
    "heures_totales": 182,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 25,
    "etat": "Termin√©",
    "cep": "Franck COPPILLIE",
    "pl": "PLVU783",
    "eco": "TL.2024.0051",
    "description": "APO D√©m√©nagement CSS et passage sous pirate",
    "livrable": "2025-03-28",
    "heures_totales": 170,
    "agents": "NGl, TLs",
    "heures_agents": {
      "Agent2": 100,
      "Agent4": 70
    }
  },
  {
    "ref": 26,
    "etat": "A venir",
    "cep": "Sophie LELOUP",
    "pl": "PLVF150\nPLVF175\nPLVF193\nPLVF205",
    "eco": "TL.2024-0013",
    "description": "L648-EP-SERM Etoile de Toulouse_am√©lioration-FXXXXX",
    "livrable": "2026-09-04",
    "heures_totales": "24\n15\n8\n2",
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 27,
    "etat": "A venir",
    "cep": "Olivier THOUVENOT",
    "pl": "XXXX",
    "eco": "TL.20XX.XXXX",
    "description": "EP QNE Etoile de Toulouse_am√©lioration¬†¬†",
    "livrable": "2026-09-04",
    "heures_totales": "XX",
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 28,
    "etat": "Pas d'impact TL",
    "cep": "Olivier THOUVENOT",
    "pl": "XXXX",
    "eco": "TL.20XX.XXXX",
    "description": "EP modernisation des IFTE du n≈ìud de Toulouse¬†",
    "livrable": "2027-05-21",
    "heures_totales": "XX",
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 29,
    "etat": "Termin√©",
    "cep": "Jean-Pierre MAUBOURGUET",
    "pl": "PLSU764",
    "eco": "TL.XXXX.XXXX",
    "description": "EP L650 TETRA Boussens",
    "livrable": "2024-01-31",
    "heures_totales": 16,
    "agents": "TLs",
    "heures_agents": {}
  },
  {
    "ref": 30,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLVF313",
    "eco": "TL-0023-0088",
    "description": "EP L650 Mise en SAL4 du PN3 quartier de St Agne",
    "livrable": "2024-12-31",
    "heures_totales": "XX",
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 31,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLME668",
    "eco": "TL-2015-0015",
    "description": "MOEE REA L590 IPCS LALBENQUE - CAUSSADE",
    "livrable": "XXX",
    "heures_totales": 315,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 32,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLMM822",
    "eco": "TL-2015-0015",
    "description": "SNCF-E REA L590 IPCS LALBENQUE - CAUSSADE",
    "livrable": "XXX",
    "heures_totales": 499,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 33,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-2015-0015",
    "description": "DCO + DTA L590 IPCS LALBENQUE - CAUSSADE",
    "livrable": "XXX",
    "heures_totales": 60,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 34,
    "etat": "Termin√©",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "PLQS280",
    "eco": "TL-2016-0007",
    "description": "MOEE REA L736 SDRA ADAP RODEZ",
    "livrable": "2023-01-04",
    "heures_totales": 24,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 35,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLSJ488",
    "eco": "TL-2016-0028",
    "description": "PRO L640 SDRA ADAP MOISSAC",
    "livrable": "2022-05-23",
    "heures_totales": 60,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 36,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLTH213",
    "eco": "TL-2016-0028",
    "description": "REA L640 SDRA ADAP MOISSAC",
    "livrable": "2023-04-29",
    "heures_totales": 82,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 37,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLUK547",
    "eco": "TL-2016-0031",
    "description": "L668 REA Renouvellement de la Ligne Montr√©jeau - LUCHON - P√©rim√®tre R√©gion",
    "livrable": "2024-05-24",
    "heures_totales": 50,
    "agents": "ANc + BLs",
    "heures_agents": {}
  },
  {
    "ref": 38,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLUK540",
    "eco": "TL-2016-0031",
    "description": "L668 REA Renouvellement de la Ligne Montr√©jeau - LUCHON - P√©rim√®tre SNCF",
    "livrable": "2024-05-03",
    "heures_totales": 150,
    "agents": "ANc + BLs",
    "heures_agents": {}
  },
  {
    "ref": 39,
    "etat": "A venir",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-2016-0035",
    "description": "L650-AVP-RVB TOURNAY - TARBES",
    "livrable": "2025-01-07",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 40,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLPK594",
    "eco": "TL-2017-0016",
    "description": "DTA INFRACOM L672 IFTE Ari√®ge",
    "livrable": "XXX",
    "heures_totales": 60,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 41,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLNZ784",
    "eco": "TL-2017-0044",
    "description": "MOEE REA L650 TO BOUSSENS - MONTREJEAU",
    "livrable": "2021-06-30",
    "heures_totales": 2660,
    "agents": "NGl/CPr/TLs/BLs/FPt",
    "heures_agents": {}
  },
  {
    "ref": 42,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLNZ790",
    "eco": "TL-2017-0044",
    "description": "SNCF-E REA L650 TO BOUSSENS - MONTREJEAU",
    "livrable": "2021-06-30",
    "heures_totales": 600,
    "agents": "NGl/CPr/TLs/BLs/FPt",
    "heures_agents": {}
  },
  {
    "ref": 43,
    "etat": "A venir",
    "cep": "WDT",
    "pl": "PLPY520",
    "eco": "TL-2017-0052",
    "description": "MOEE REA L640 Base Arri√®re ST JORY",
    "livrable": "XXX",
    "heures_totales": 18,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 44,
    "etat": "A venir",
    "cep": "Sophie LELOUP",
    "pl": "XXXX",
    "eco": "TL-2018-0022",
    "description": "L650-EP-Cr√©ation ITE MALET CAZERES-F57165",
    "livrable": "2027-05-21",
    "heures_totales": 160,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 45,
    "etat": "A venir",
    "cep": "Sophie LELOUP",
    "pl": "XXXX",
    "eco": "TL-2018-0022",
    "description": "AVP L650 Cr√©ation ITE MALET CAZERES",
    "livrable": "XXX",
    "heures_totales": 80,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 46,
    "etat": "A venir",
    "cep": "Sophie LELOUP",
    "pl": "XXXX",
    "eco": "TL-2018-0022",
    "description": "PRO L650 Cr√©ation ITE MALET CAZERES",
    "livrable": "XXX",
    "heures_totales": 150,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 47,
    "etat": "Orpheline",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "XXXX",
    "eco": "TL-2018-0036",
    "description": "PRO L640 Cr√©ation 6 Voies de remisage RAYNAL",
    "livrable": "2024-12-31",
    "heures_totales": 55,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 48,
    "etat": "Termin√©",
    "cep": "Naima AHROUCH",
    "pl": "PLSG953",
    "eco": "TL-2018-0047",
    "description": "MOEE REA S√©curisation Technicentre RAYNAL",
    "livrable": "2023-04-29",
    "heures_totales": 565,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 49,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLTV921",
    "eco": "TL-2018-0060",
    "description": "APO L650 RAV Muret",
    "livrable": "2023-10-28",
    "heures_totales": 40,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 50,
    "etat": "Termin√©",
    "cep": "Olivier THOUVENOT",
    "pl": "PLQZ229",
    "eco": "TL-2018-0065",
    "description": "MOEE REA L640 Accessibilit√© MATABIAU",
    "livrable": "2023-01-01",
    "heures_totales": 150,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 51,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLSW127",
    "eco": "TL-2019-0003",
    "description": "PRO L640 SDNA MONTAUBAN",
    "livrable": "2022-09-30",
    "heures_totales": 70,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 52,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLTS149",
    "eco": "TL-2019-0003",
    "description": "REA L640 SDNA MONTAUBAN",
    "livrable": "2023-06-30",
    "heures_totales": 120,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 53,
    "etat": "A venir",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLUV783",
    "eco": "TL-2019-0015",
    "description": "L590-REA-RVB Cahors Caussade ",
    "livrable": "2025-04-03",
    "heures_totales": 10,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 54,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLTH599",
    "eco": "TL-2019-0031",
    "description": "DCE L650 ADAP ST AGNE - Mission ACT",
    "livrable": "2024-05-17",
    "heures_totales": 20,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 55,
    "etat": "Termin√©",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "PLTH599",
    "eco": "TL-2019-0031",
    "description": "PRO/DCE L650 ADAP ST AGNE",
    "livrable": "2023-06-16",
    "heures_totales": 100,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 56,
    "etat": "Externalis√©",
    "cep": "Sophie LELOUP",
    "pl": "XXXX",
    "eco": "TL-2019-0031",
    "description": "L650-REA-ADAP ST AGNE-JJ8779",
    "livrable": "2024-12-31",
    "heures_totales": 37,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 57,
    "etat": "Prise en charge",
    "cep": "Sophie LELOUP",
    "pl": "PLUF692",
    "eco": "TL-2019-0031",
    "description": "L648-PRO-Am√©nagement gares Axe Auch - Kext Dossier APD de ARTELIA-JJ9124",
    "livrable": "2026-01-29",
    "heures_totales": 24,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 58,
    "etat": "Termin√©",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL-2019-0050",
    "description": "L640 REA RAV Montauban, Moissac, Dieupentale",
    "livrable": "2024-11-01",
    "heures_totales": 90,
    "agents": "MSt + TLs",
    "heures_agents": {}
  },
  {
    "ref": 59,
    "etat": "A venir",
    "cep": "Naima AHROUCH",
    "pl": "PLQS461",
    "eco": "TL-2019-0064",
    "description": "AVP L672 SDRA ADAP LATOUR DE CAROL",
    "livrable": "XXX",
    "heures_totales": 32,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 60,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLUV783",
    "eco": "TL-2019-015",
    "description": "REA L590 Montpezat - D√©pose des aiguilles 3 et 4",
    "livrable": "2024-08-02",
    "heures_totales": 40,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 61,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "XXXX",
    "eco": "TL-2020-0013",
    "description": "AVP L640 Cr√©ation PRA LABEGE ZAC ENOVA",
    "livrable": "2022-11-15",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 62,
    "etat": "Termin√©",
    "cep": "Anthony MUTLU",
    "pl": "PLSH330",
    "eco": "TL-2020-0024",
    "description": " L590 Reprise DCE  ST CAT V1 Cahors - Lamothe (PK548 √† 600)",
    "livrable": "2024-08-30",
    "heures_totales": 80,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 63,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-2020-0026",
    "description": "APO L650 RB Caz√®res + reliquats RVB _ Radio de chantier",
    "livrable": "2023-04-28",
    "heures_totales": 25,
    "agents": "TLs",
    "heures_agents": {}
  },
  {
    "ref": 64,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLTC212",
    "eco": "TL-2020-0026",
    "description": "APO L650 RB Caz√®res + reliquats RVB",
    "livrable": "2023-06-09",
    "heures_totales": 25,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 65,
    "etat": "Orpheline",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "XXXX",
    "eco": "TL-2020-0031",
    "description": "L736-PRO-SDRA ADAP CARMAUX-FXXXXX",
    "livrable": "XXX",
    "heures_totales": 40,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 66,
    "etat": "Orpheline",
    "cep": "WDT",
    "pl": "XXXX",
    "eco": "TL-2020-0031",
    "description": "L736-REA-MOEE SDRA ADAP CARMAUX-FXXXX",
    "livrable": "XXX",
    "heures_totales": 30,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 67,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLQW989",
    "eco": "TL-2020-0034",
    "description": "MOEE REA L648 ADAP ST CYPRIEN ARENES",
    "livrable": "2024-03-29",
    "heures_totales": 60,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 68,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-2020-0037",
    "description": "EP L718 Supp PN53",
    "livrable": "XXX",
    "heures_totales": 15,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 69,
    "etat": "Termin√©",
    "cep": "Naima AHROUCH",
    "pl": "XXXX",
    "eco": "TL-2020-0038",
    "description": "EP L672 LATOUR DE CAROL - Lib fonci√®re pr panneaux photovolta√Øque",
    "livrable": "2021-12-13",
    "heures_totales": 7,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 70,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-2020-0048",
    "description": "BB INFRACOM RAX CASTELNAUDARY",
    "livrable": "2021-06-30",
    "heures_totales": 26,
    "agents": "TLs",
    "heures_agents": {}
  },
  {
    "ref": 71,
    "etat": "Orpheline",
    "cep": null,
    "pl": "XXXX",
    "eco": "TL-2020-0050",
    "description": "L650-APO-Elargissement PN171-F60494",
    "livrable": "2030-01-01",
    "heures_totales": 70,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 72,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLTB381",
    "eco": "TL-2020-0052",
    "description": "EP L648 Elargissement PN18",
    "livrable": "2023-01-31",
    "heures_totales": 31,
    "agents": "BLs",
    "heures_agents": {}
  },
  {
    "ref": 73,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "PLTV827",
    "eco": "TL-2020-0074",
    "description": "L590 APO RVB zones bois Lamothe-F√©n√©lon √† Cahors",
    "livrable": "2025-01-17",
    "heures_totales": 100,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 74,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLRV346",
    "eco": "TL-2021.0099",
    "description": "MOEE REA RG TSV CARIBOU par SIAM ST-3",
    "livrable": "2022-10-31",
    "heures_totales": 170,
    "agents": "MSt/TLs/FPt",
    "heures_agents": {}
  },
  {
    "ref": 75,
    "etat": "Termin√©",
    "cep": "Franck COPPILLIE",
    "pl": "PLRG337",
    "eco": "TL-2021-0003",
    "description": "APO L640 RG PMP MARTINIS",
    "livrable": "2026-12-31",
    "heures_totales": 36,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 76,
    "etat": "A venir",
    "cep": "Franck COPPILLIE",
    "pl": "XXXX",
    "eco": "TL-2021-0003",
    "description": "MOEE REA L640 RG PMP MARTINIS",
    "livrable": "XXX",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 77,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "PLUN379",
    "eco": "TL-2021-0016",
    "description": "L718 APO Travaux d'assainissement en gares de St Sulpice et Tessonni√®res",
    "livrable": "2024-07-17",
    "heures_totales": 60,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 78,
    "etat": "A venir",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-2021-0016",
    "description": "L718 REA Travaux d'assainissement en gares de St Sulpice et Tessonni√®res",
    "livrable": "XXX",
    "heures_totales": 150,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 79,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLTS253",
    "eco": "TL-2021-0020",
    "description": "REA L590 Montpezat - Neutralisation des aiguilles et d√©pose des IS",
    "livrable": "2024-02-02",
    "heures_totales": 45,
    "agents": "ANc",
    "heures_agents": {}
  },
  {
    "ref": 80,
    "etat": "Termin√©",
    "cep": "Anthony MUTLU",
    "pl": "PLTV744",
    "eco": "TL-2021-0022",
    "description": "APO SR CAT V1-V2 Montpezat Montauban PK630 √† PK663",
    "livrable": "2024-01-31",
    "heures_totales": 20,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 81,
    "etat": "Termin√©",
    "cep": "Anthony MUTLU",
    "pl": "PLTV744",
    "eco": "TL-2021-0022",
    "description": "REA SR CAT V1-V2 Montpezat Montauban PK630 √† PK663",
    "livrable": "2024-06-28",
    "heures_totales": 19,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 82,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-2021-0025",
    "description": "REA L672 Elargissement PN81",
    "livrable": "2022-12-30",
    "heures_totales": 70,
    "agents": "BLs",
    "heures_agents": {}
  },
  {
    "ref": 83,
    "etat": "Termin√©",
    "cep": "Franck COPPILLIE",
    "pl": "PLSU884",
    "eco": "TL-2021-0027",
    "description": "MOEE REA L640 RG ERJI PMP LASPEYRES / PORT HAUT / GANDALOU",
    "livrable": "2022-12-31",
    "heures_totales": 101,
    "agents": "BLs",
    "heures_agents": {}
  },
  {
    "ref": 84,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-2021-0029",
    "description": "EP L672 RAV CINTEGABELLE & SAVERDUN",
    "livrable": "2023-07-31",
    "heures_totales": 16,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 85,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-2021-0029",
    "description": "APO L672 RAV CINTEGABELLE & SAVERDUN",
    "livrable": "2024-12-11",
    "heures_totales": 18,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 86,
    "etat": "A venir",
    "cep": "Julie DERNE",
    "pl": "PLXXXXX",
    "eco": "TL-2021-0033",
    "description": "EP L648 Mise en conformit√© TVP BRAX",
    "livrable": "XXX",
    "heures_totales": 16,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 87,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "PLRV860",
    "eco": "TL-2021-0044",
    "description": "APO L672 D√©ploiement TSV PORTET - FOIX",
    "livrable": "2026-12-31",
    "heures_totales": 120,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 88,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-2021-0046",
    "description": "EP L648 Mise en conformit√© courbes PK20 et PK37",
    "livrable": "2022-09-30",
    "heures_totales": 27,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 89,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-2021-0049",
    "description": "EP L640 ESCALQUENS D√©pose BS J + VS + BS T + EP STELA",
    "livrable": "2023-01-01",
    "heures_totales": 12,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 90,
    "etat": "Termin√©",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "PLSN137",
    "eco": "TL-2021-0051",
    "description": "APO  Reloc BTS GSMR",
    "livrable": "2023-09-15",
    "heures_totales": 101,
    "agents": "MST + NGl",
    "heures_agents": {}
  },
  {
    "ref": 91,
    "etat": "Termin√©",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "PLSN137",
    "eco": "TL-2021-0051",
    "description": "DCE/REA  Reloc BTS GSMR",
    "livrable": "2023-09-15",
    "heures_totales": 74,
    "agents": "MSt + NGl",
    "heures_agents": {}
  },
  {
    "ref": 92,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "XXXX",
    "eco": "TL-2021-0074",
    "description": "MOEE REA L590 SR RG Cat√©naire LAMOTHE - CAHORS V2",
    "livrable": "2023-06-30",
    "heures_totales": 180,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 93,
    "etat": "A venir",
    "cep": "FBZ",
    "pl": "XXXX",
    "eco": "TL-2021-0079",
    "description": "L640-APO-Renouvellement de rails avec BOA V1-F53821",
    "livrable": "2026-06-05",
    "heures_totales": 25,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 94,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLSB169",
    "eco": "TL-2021-0080",
    "description": "REA  INFRACOM GAILLAC",
    "livrable": "2022-01-31",
    "heures_totales": 71,
    "agents": "CPr",
    "heures_agents": {}
  },
  {
    "ref": 95,
    "etat": "Termin√©",
    "cep": "Christophe BASSO",
    "pl": "XXXX",
    "eco": "TL-2021-0094",
    "description": "L640 PRO S√©curisation PDD",
    "livrable": "2024-03-01",
    "heures_totales": 150,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 96,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLRV348",
    "eco": "TL-2021-0099",
    "description": "SNCF-E REA RG TSV CARIBOU par SIAM ST-3",
    "livrable": "2022-10-31",
    "heures_totales": 30,
    "agents": "MSt/TLs/FPt",
    "heures_agents": {}
  },
  {
    "ref": 97,
    "etat": "Termin√©",
    "cep": "WDT",
    "pl": "PLSM775",
    "eco": "TL-2021-0106",
    "description": "PRO L640 AFNT",
    "livrable": "2023-05-31",
    "heures_totales": 3500,
    "agents": "CPr/NGl",
    "heures_agents": {}
  },
  {
    "ref": 98,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLSM677",
    "eco": "TL-2021-0107",
    "description": "L590 APO SR CAT V1-V2 PK600 √† 630 - Cahors √† Montpezat",
    "livrable": "2025-03-21",
    "heures_totales": 170,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 99,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "PLTE676",
    "eco": "TL-2021-0108",
    "description": "REA L718  Tx abaissement de voie sous PRO dit de Fabre au PK 336+269",
    "livrable": "2022-11-30",
    "heures_totales": 85,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 100,
    "etat": "Termin√©",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "PLSL318",
    "eco": "TL-2021-0124",
    "description": "AVP L725 R√©ouverture RODEZ - SEVERAC LE CH√ÇTEAU. ",
    "livrable": "2023-07-31",
    "heures_totales": 100,
    "agents": "BLs + MSt+FPr",
    "heures_agents": {}
  },
  {
    "ref": 101,
    "etat": "Orpheline",
    "cep": "Anthony MUTLU",
    "pl": "XXXX",
    "eco": "TL-2022-0003",
    "description": "L648-EP- 5PN - T√©l√©phones autoroutiers-F",
    "livrable": "2023-12-31",
    "heures_totales": 70,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 102,
    "etat": "Orpheline",
    "cep": "Anthony MUTLU",
    "pl": "XXXX",
    "eco": "TL-2022-0004",
    "description": "L672-EP-15PN - T√©l√©phones autoroutiers-F",
    "livrable": "2023-12-31",
    "heures_totales": 80,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 103,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-2022-0006",
    "description": "APO L640 RAV 7 ADV + d√©voiement buse Toulouse Matabiau ",
    "livrable": "2022-12-31",
    "heures_totales": 80,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 104,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLSN677",
    "eco": "TL-2022-0013",
    "description": "DCO /DTA RG TSV CARIBOU par SIAM ST-3",
    "livrable": "2022-06-17",
    "heures_totales": 116,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 105,
    "etat": "Termin√©",
    "cep": "Anthony MUTLU",
    "pl": "PLUV807",
    "eco": "TL-2022-0016",
    "description": "EP+ L648 modification 3 t√©l√©phones signaux",
    "livrable": "2024-06-28",
    "heures_totales": 70,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 106,
    "etat": "Termin√©",
    "cep": "Micka√´l MARTEL",
    "pl": "PLUV807",
    "eco": "TL-2022-0016",
    "description": "REA L648 modification 3 t√©l√©phones signaux",
    "livrable": "2024-12-31",
    "heures_totales": 100,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 107,
    "etat": "A venir",
    "cep": "Anthony MUTLU",
    "pl": "XXXX",
    "eco": "TL-2022-0043",
    "description": "LXXX-EP-S√©curisation Postes strat√©giques-FXXXXX",
    "livrable": "2023-12-31",
    "heures_totales": 814,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 108,
    "etat": "Orpheline",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-2022-0049",
    "description": "L650-EP-ADAP FAUGA-FXXXXX",
    "livrable": "2023-12-31",
    "heures_totales": 64,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 109,
    "etat": "Termin√©",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "PLSV860",
    "eco": "TL-2022-0066",
    "description": "AVP L640 Allong PASO Nord & Sud + jonction PEM Toulouse Matabiau",
    "livrable": "2022-12-31",
    "heures_totales": 60,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 110,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLUM481",
    "eco": "TL-2022-0066",
    "description": "L640 PASO Matabiau - Kext PRO Ferro",
    "livrable": "2024-03-06",
    "heures_totales": 20,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 111,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLTJ920",
    "eco": "TL-2022-0066",
    "description": "L640 PASO Matabiau - Kext AVP Ferro",
    "livrable": "2023-08-31",
    "heures_totales": 55,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 112,
    "etat": "Termin√©",
    "cep": "Jean-Pierre MAUBOURGUET",
    "pl": "PLSW185",
    "eco": "TL-2022-0069",
    "description": "MOEE REA L650 PCD Toulouse SAV Phase 3",
    "livrable": "XXX",
    "heures_totales": 300,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 113,
    "etat": "Termin√©",
    "cep": "Jean-Pierre MAUBOURGUET",
    "pl": "PLSW222",
    "eco": "TL-2022-0070",
    "description": "MOEE REA L650 PCD Toulouse TSV Phase 3",
    "livrable": "XXX",
    "heures_totales": 200,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 114,
    "etat": "A venir",
    "cep": "Jean-Pierre MAUBOURGUET",
    "pl": "PLSW222",
    "eco": "TL-2022-0070",
    "description": "REA TSV Phase 3 entre Muret et Boussens",
    "livrable": "XXX",
    "heures_totales": "XX",
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 115,
    "etat": "Orpheline",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-2022-0071",
    "description": "L640-APO-Nouveaux Locaux TL AUTERIVE-F",
    "livrable": "2023-12-31",
    "heures_totales": 200,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 116,
    "etat": "Orpheline",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-2022-0073",
    "description": "L640-APO-Nouveaux Locaux TL CASTELSARRASIN-F",
    "livrable": "2023-12-31",
    "heures_totales": 200,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 117,
    "etat": "Termin√©",
    "cep": "LPZ",
    "pl": "PLTB883",
    "eco": "TL-2022-0074",
    "description": "APO L640 RB-RR MOISSAC CACOR",
    "livrable": "2023-01-31",
    "heures_totales": 147,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 118,
    "etat": "Termin√©",
    "cep": "Anthony MUTLU",
    "pl": "PLUW035",
    "eco": "TL-2022-0074",
    "description": "REA L640 RB-RR MOISSAC CACOR",
    "livrable": "2024-02-29",
    "heures_totales": 140,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 119,
    "etat": "Orpheline",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-2022-0075",
    "description": "L640-APO-Nouveaux Locaux TL MOISSAC-F",
    "livrable": "2023-12-31",
    "heures_totales": 200,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 120,
    "etat": "Orpheline",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-2022-0077",
    "description": "L640-APO-Nouveaux Locaux TL VALENCE D'AGEN-",
    "livrable": "2023-12-31",
    "heures_totales": 200,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 121,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-2022-0079",
    "description": "DCE/REA LDFT Tunnels de SOUEL et GRAND MERGUIEUX",
    "livrable": "2023-09-29",
    "heures_totales": 40,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 122,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLSU764",
    "eco": "TL-2022-0093",
    "description": "L650 REA Simplification suite √† d√©pose ADV Saint Gaudens",
    "livrable": "2023-09-01",
    "heures_totales": 150,
    "agents": "BLs+ANc",
    "heures_agents": {}
  },
  {
    "ref": 123,
    "etat": "Termin√©",
    "cep": "Jean-Pierre MAUBOURGUET",
    "pl": "PLSU764",
    "eco": "TL-2022-0093",
    "description": "MOEE REA L650 PCD Toulouse Phase 4",
    "livrable": "2025-12-31",
    "heures_totales": 150,
    "agents": "TLs+ANc+MSt, TLs+Anc",
    "heures_agents": {}
  },
  {
    "ref": 124,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-2022-0099",
    "description": "DCO-DTA  L672 IFTE Arri√®ge",
    "livrable": "2023-11-03",
    "heures_totales": 80,
    "agents": "TLs",
    "heures_agents": {}
  },
  {
    "ref": 125,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLTJ771",
    "eco": "TL-2022-0100",
    "description": "PRO/REA L640 Migration Fibre sur Fibre GSM-R SAM 146 Agen - Montauban - F52440",
    "livrable": "2023-06-30",
    "heures_totales": 200,
    "agents": "BLs",
    "heures_agents": {}
  },
  {
    "ref": 126,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLTA843",
    "eco": "TL-2022-0102",
    "description": "REA L640 Tx de r√©g√©n√©ration TRV Narbone - Partie prestataire interne (PRI TL Montpellier)",
    "livrable": "2022-12-31",
    "heures_totales": 0,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 127,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLTQ945",
    "eco": "TL-2022-0102",
    "description": "REA L640 Tx de r√©g√©n√©ration TRV Tarbes - Partie Pilotage prestataire",
    "livrable": "2022-12-31",
    "heures_totales": 55,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 128,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLTQ942",
    "eco": "TL-2022-0102",
    "description": "REA L640 Tx de r√©g√©n√©ration TRV Tarbes - Partie CEP",
    "livrable": "2022-12-31",
    "heures_totales": 42,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 129,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLTQ947",
    "eco": "TL-2022-0102",
    "description": "REA L640 Tx de r√©g√©n√©ration TRV Tarbes - Partie Prestataire externe",
    "livrable": "2022-12-31",
    "heures_totales": 0,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 130,
    "etat": "Termin√©",
    "cep": "Anthony MUTLU",
    "pl": "PLSL115",
    "eco": "TL-2022-0109",
    "description": "EP L640 Suppression art√®re amiant√©e Pont Cacor",
    "livrable": "2024-05-31",
    "heures_totales": 130,
    "agents": "MST",
    "heures_agents": {}
  },
  {
    "ref": 131,
    "etat": "Termin√©",
    "cep": "Naima AHROUCH",
    "pl": "PLTH985",
    "eco": "TL-2022-0115",
    "description": "AVP L640 D√©placement des activit√©s CCTT et COGC vers PCD",
    "livrable": "2023-07-28",
    "heures_totales": 3000,
    "agents": "BLs+TLs+ANc+MSt",
    "heures_agents": {}
  },
  {
    "ref": 132,
    "etat": "A venir",
    "cep": "Anthony MUTLU",
    "pl": "XXXX",
    "eco": "TL-2022-0128",
    "description": "EP L648 Elargissement PN103",
    "livrable": "XXX",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 133,
    "etat": "Termin√©",
    "cep": "Anthony MUTLU",
    "pl": "PLTC372",
    "eco": "TL-2022-0132",
    "description": "APO L590 R√©g√©n√©ration Murs de Sout√®nement PK571+395D / 571+409G",
    "livrable": "2022-12-16",
    "heures_totales": 110,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 134,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL-2022-0147",
    "description": "L650-EP-D√©pose BS 201 - Portet St Simon",
    "livrable": "2025-10-29",
    "heures_totales": 35,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 135,
    "etat": "A venir",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "XXXX",
    "eco": "TL-2023-0003",
    "description": "EP L640 Lib√©ration fonci√®re P√©riole",
    "livrable": "XXX",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 136,
    "etat": "A venir",
    "cep": "Anthony MUTLU",
    "pl": "XXXX",
    "eco": "TL-2023-0004",
    "description": "L650-EP-TSV SIAM  ST3 Boussens Tournay",
    "livrable": "2025-07-15",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 137,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLTS353",
    "eco": "TL-2023-0007",
    "description": "L640 REA TERRALPHA site de Castelnaudary",
    "livrable": "2023-03-31",
    "heures_totales": 25,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 138,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-2023-0012",
    "description": "PRO L640 Supp PN197 BELBERAUD",
    "livrable": "XXX",
    "heures_totales": 35,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 139,
    "etat": "A venir",
    "cep": "Anthony MUTLU",
    "pl": "XXXX",
    "eco": "TL-2023-0013",
    "description": "EP L640 Doublement du dalot bus√© KM 258+350 ou cr√©ation bassin tampon",
    "livrable": "XXX",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 140,
    "etat": "Termin√©",
    "cep": "Alexandre BOISSET",
    "pl": "PLUN654",
    "eco": "TL-2023-0014",
    "description": "EP L650 reliquats RVB Carbonne",
    "livrable": "2025-05-30",
    "heures_totales": 60,
    "agents": "FPr, NGl, MSt",
    "heures_agents": {
      "Agent2": 55,
      "Agent3": 5
    }
  },
  {
    "ref": 141,
    "etat": "Termin√©",
    "cep": "Alexandre BOISSET",
    "pl": "PLUN642",
    "eco": "TL-2023-0015",
    "description": "EP L650 reliquats RVB Boussens",
    "livrable": "2025-05-30",
    "heures_totales": 60,
    "agents": "FPr, NGl, MSt",
    "heures_agents": {
      "Agent2": 55,
      "Agent3": 5
    }
  },
  {
    "ref": 142,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-2023-0016",
    "description": "EP L650 reliquats RVB Longages",
    "livrable": "2024-02-24",
    "heures_totales": 40,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 143,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLUG413",
    "eco": "TL-2023-0017",
    "description": "L650 APO R√©g√©n√©ration de 27 supports cat√©naire",
    "livrable": "2024-09-13",
    "heures_totales": 14,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 144,
    "etat": "Termin√©",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "XXXX",
    "eco": "TL-2023-0030",
    "description": "EP L640 RVB Voie banalis√©e",
    "livrable": "2023-12-29",
    "heures_totales": 50,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 145,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLUK572",
    "eco": "TL-2023-0031",
    "description": "EP L640 Elargissement PN144",
    "livrable": "2024-07-16",
    "heures_totales": 50,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 146,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLUF465",
    "eco": "TL-2023-0034",
    "description": "APO L650 Supp PN170",
    "livrable": "2023-12-29",
    "heures_totales": 44,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 147,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLUF428",
    "eco": "TL-2023-0035",
    "description": "APO L650 Supp PN172",
    "livrable": "2023-12-29",
    "heures_totales": 44,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 148,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLUF462",
    "eco": "TL-2023-0036",
    "description": "APO L650 Supp PN175",
    "livrable": "2023-12-29",
    "heures_totales": 44,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 149,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLUK711",
    "eco": "TL-2023-0037",
    "description": "L640 AMO AVP Cr√©ation Halte LABEGE LA CADENE",
    "livrable": "2024-02-16",
    "heures_totales": 30,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 150,
    "etat": "Termin√©",
    "cep": "Alexandre BOISSET",
    "pl": "PLWJ098",
    "eco": "TL-2023-0039",
    "description": "L667 REA RVB voie Lannemezan - Labarthe Avezac",
    "livrable": "2024-11-12",
    "heures_totales": 63,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 151,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLUH962",
    "eco": "TL-2023-0039",
    "description": "L667 APO RVB Lannemezan - Labarthe Avezac",
    "livrable": "2024-05-31",
    "heures_totales": 40,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 152,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLUH962",
    "eco": "TL-2023-0039",
    "description": "L667 APO TMPJ PK121+397",
    "livrable": "2024-11-12",
    "heures_totales": 105,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 153,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLUV386",
    "eco": "TL-2023-0045",
    "description": "Projet d'EP Service Vid√©o R√©seau _ Programme ASPN pour 13 sites",
    "livrable": "2023-12-29",
    "heures_totales": 200,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 154,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLUF433",
    "eco": "TL-2023-0047",
    "description": "PRO L672 D√©placement PN91 + Supp PN92",
    "livrable": "2024-03-29",
    "heures_totales": 44,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 155,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLUS063",
    "eco": "TL-2023-0048",
    "description": "REA L672 Supp PN11 de V√©nerque au PK 23+915",
    "livrable": "2024-05-31",
    "heures_totales": 67,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 156,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLUV759",
    "eco": "TL-2023-0052",
    "description": "APO L650 9 PN (Passage en Autoroutier) - Collecte donn√©es d'entr√©e et v√©rification",
    "livrable": "2025-02-28",
    "heures_totales": 26,
    "agents": "FPr, MSt",
    "heures_agents": {
      "Agent3": 26
    }
  },
  {
    "ref": 157,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-2023-0053",
    "description": "EP L701 Ajout 2 t√©l√©phones autoroutiers au PN121",
    "livrable": "2025-02-13",
    "heures_totales": 50,
    "agents": "PCs",
    "heures_agents": {}
  },
  {
    "ref": 158,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLUN870",
    "eco": "TL-2023-0054",
    "description": "MOEE REA L648 ADAP COLOMIERS",
    "livrable": "2024-03-29",
    "heures_totales": 20,
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 159,
    "etat": "Prise en charge",
    "cep": "Franck PRUNIER",
    "pl": "PLVC113",
    "eco": "TL-2023-0058",
    "description": "L650-REA-Etude implantation NOKIA √† Boussens avec accompagnement MOE TX et Etablissement DOE + Etablissement DOE projet initial TERRALPHA Boussens (2 529,05 Euros)-FXXXXX",
    "livrable": "2024-04-30",
    "heures_totales": 50,
    "agents": "FPr, NGl",
    "heures_agents": {
      "Agent2": 50
    }
  },
  {
    "ref": 160,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLUD046",
    "eco": "TL-2023-0060",
    "description": "EP L648 TFNG - Site de Colomiers",
    "livrable": "2023-09-01",
    "heures_totales": 50,
    "agents": "ANc",
    "heures_agents": {}
  },
  {
    "ref": 161,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLUF826",
    "eco": "TL-2023-0066",
    "description": "GAMEC SOPRANO - RECENSEMENT ",
    "livrable": "2023-10-31",
    "heures_totales": 50,
    "agents": "BLs/Anc/JBn",
    "heures_agents": {}
  },
  {
    "ref": 162,
    "etat": "Termin√©",
    "cep": "WDT",
    "pl": "PLUH043",
    "eco": "TL-2023-0071",
    "description": "L640 AFNT - DCO/DTA",
    "livrable": "2023-09-29",
    "heures_totales": 70,
    "agents": "TLs",
    "heures_agents": {}
  },
  {
    "ref": 163,
    "etat": "A venir",
    "cep": "Alexandre BOISSET",
    "pl": "XXXX",
    "eco": "TL-2023-0072",
    "description": "LDFT L648 DCE/REA Pra PK24+764 et PK85+178",
    "livrable": "XXX",
    "heures_totales": 50,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 164,
    "etat": "Prise en charge",
    "cep": "Alexandre BOISSET",
    "pl": "PLWC419",
    "eco": "TL-2023-0074",
    "description": "L672 - APO LDFT R√©fection Etanch√©it√© 5 PRA PK 150 √† 162 - F64931",
    "livrable": "2025-08-15",
    "heures_totales": 140,
    "agents": "MSt",
    "heures_agents": {
      "Agent2": 20,
      "Agent3": 120
    }
  },
  {
    "ref": 165,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL-2023-0079",
    "description": "L640-EP-Remplacement tablier - drainage PRa Moissac",
    "livrable": "2025-11-24",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 166,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLUV792",
    "eco": "TL-2023-0084",
    "description": "APO L640 18 PN VALENCE D'AGEN √† BRAM (Passage Autoroutier) - Collecte donn√©es d'entr√©e et v√©rification",
    "livrable": "2025-02-28",
    "heures_totales": 54,
    "agents": "FPr, MSt",
    "heures_agents": {
      "Agent3": 54
    }
  },
  {
    "ref": 167,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLPB233",
    "eco": "TL-2023-00XX",
    "description": "MOEE REA TCTK EALE SECTEUR 5 Foix - reprise",
    "livrable": "2023-12-15",
    "heures_totales": 140,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 168,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "PLUZ245",
    "eco": "TL-2023-0130",
    "description": "L701 APO PK258+528 RVB + d√©pose gare de Viviez ",
    "livrable": "2024-09-20",
    "heures_totales": 10,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 169,
    "etat": "Termin√©",
    "cep": "Franck COPPILLIE",
    "pl": "PLUL288",
    "eco": "TL-2023-0134",
    "description": "L640 EP CSS de Toulouse - 5¬∞ table de r√©gulation",
    "livrable": "2023-12-29",
    "heures_totales": 50,
    "agents": "BLs",
    "heures_agents": {}
  },
  {
    "ref": 170,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "PLVB035",
    "eco": "TL-2023-0138",
    "description": "L640 APO RB V1 et V2 + Assainissement PN219 + R√©g√©n√©ration OA en gare d'Avignonet",
    "livrable": "2024-09-27",
    "heures_totales": 37,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 171,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "PLUR403",
    "eco": "TL-2023-0140",
    "description": "L736 APO Assainissement PN161",
    "livrable": "2024-04-15",
    "heures_totales": 8,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 172,
    "etat": "A venir",
    "cep": "Franck PRUNIER",
    "pl": "PLWU985",
    "eco": "TL-2023-0105",
    "description": "L648-APO-D√©commissionnement c√¢ble 36FO Toulouse - Colomiers - F67993",
    "livrable": "2025-11-28",
    "heures_totales": 190,
    "agents": "NGl",
    "heures_agents": {
      "Agent2": 170
    }
  },
  {
    "ref": 173,
    "etat": "A venir",
    "cep": "Franck PRUNIER",
    "pl": "PLWV000",
    "eco": "TL-2025-0106",
    "description": "L648-REA-D√©commissionnement c√¢ble 36FO Toulouse - Colomiers - F67993",
    "livrable": "2025-12-26",
    "heures_totales": 140,
    "agents": "NGl",
    "heures_agents": {
      "Agent2": 120
    }
  },
  {
    "ref": 174,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLUY889",
    "eco": "TL-2024.0003",
    "description": "Kext AVP L640 TOULOUSE PERIOLE Modernisation remisage",
    "livrable": "2024-08-01",
    "heures_totales": 36,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 175,
    "etat": "Termin√©",
    "cep": "Jean-Pierre MAUBOURGUET",
    "pl": "PLVC276",
    "eco": "TL-2024-0004",
    "description": "L640 D√©placement des activit√©s CCTT et COGC vers PCD\nEtudes PRO",
    "livrable": "2025-10-10",
    "heures_totales": 1800,
    "agents": "TLs+ANc+NGl",
    "heures_agents": {}
  },
  {
    "ref": 176,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "PLVN426",
    "eco": "TL-2024-0010",
    "description": "REA L672 D√©placement PN91 + Supp PN92",
    "livrable": "2024-12-31",
    "heures_totales": 20,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 177,
    "etat": "A venir",
    "cep": "Alexandre BOISSET",
    "pl": "XXXX",
    "eco": "TL-2024-0014",
    "description": "LDFT L648 REA RAV Gimont et l'Isle Jourdain",
    "livrable": "XXX",
    "heures_totales": 90,
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 178,
    "etat": "A venir",
    "cep": "Alexandre BOISSET",
    "pl": "PLVJ157",
    "eco": "TL-2024-0016",
    "description": "LDFT L648 REA Rectification de courbe PK45 et PN59",
    "livrable": "XXX",
    "heures_totales": 24,
    "agents": "NGl",
    "heures_agents": {
      "Agent2": 110
    }
  },
  {
    "ref": 179,
    "etat": null,
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-2024-0018",
    "description": "L650 PRA Ren√© Souvira - Remise en peinture ou remplacement",
    "livrable": "XXX",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 180,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "PLVX704",
    "eco": "TL-2024-0022",
    "description": "L672-EP-Modification PN1 Portet",
    "livrable": "2025-06-18",
    "heures_totales": 70,
    "agents": "PCe",
    "heures_agents": {
      "Agent3": 40,
      "Agent5": 30
    }
  },
  {
    "ref": 181,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLVC654",
    "eco": "TL-2024-0023",
    "description": "L648-PRO/REA-TFNG - Site de Colomiers-F",
    "livrable": "2024-08-30",
    "heures_totales": 160,
    "agents": "ANc",
    "heures_agents": {}
  },
  {
    "ref": 182,
    "etat": "Termin√©",
    "cep": "Alexandre BOISSET",
    "pl": "PLVQ160",
    "eco": "TL-2024-0024",
    "description": "L650-APO-RAV MONTREJEAU c√¥t√© BAYONNE + RG m√©canismes AdV 29 et 30",
    "livrable": "2025-10-31",
    "heures_totales": 50,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 183,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLVJ884",
    "eco": "TL-2024-0026",
    "description": "GUIIC - INFRACOM - Raccordement CCR de Toulouse",
    "livrable": "2024-08-31",
    "heures_totales": 62,
    "agents": "TLs",
    "heures_agents": {}
  },
  {
    "ref": 184,
    "etat": "Prise en charge",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-2024-0029",
    "description": "L640-EP-niveau PRO - Tout optique de Bram √† Narbonne- F70448",
    "livrable": "2026-03-27",
    "heures_totales": 170,
    "agents": "PCs",
    "heures_agents": {
      "Agent2": 20,
      "Agent5": 150
    }
  },
  {
    "ref": 185,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLVS302",
    "eco": "TL-2024-0031",
    "description": "GUIIC - DCO Remplacement RR optique CTC par RAX711 INFRANET",
    "livrable": "2024-09-27",
    "heures_totales": 45,
    "agents": "TLs",
    "heures_agents": {}
  },
  {
    "ref": 186,
    "etat": "Prise en charge",
    "cep": "Franck PRUNIER",
    "pl": "PLVV539",
    "eco": "TL-2024-0031",
    "description": "GUIIC -  reprise DCO INFRANET  pour Remplacement des RAX711 par des routeurs MX104",
    "livrable": "2025-11-14",
    "heures_totales": 61,
    "agents": "PCs",
    "heures_agents": {}
  },
  {
    "ref": 187,
    "etat": "Termin√©",
    "cep": "Franck COPPILLIE",
    "pl": "XXXX",
    "eco": "TL-2024-0034",
    "description": "L640 REA CSS de Toulouse - 5¬∞ table de r√©gulation",
    "livrable": "2024-06-28",
    "heures_totales": 70,
    "agents": "Anc",
    "heures_agents": {}
  },
  {
    "ref": 188,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL-2024-0036",
    "description": "L640-REA-Neutralisation 18 ML V46 Technicentre Raynal",
    "livrable": "2025-12-31",
    "heures_totales": 200,
    "agents": "xxx",
    "heures_agents": {}
  },
  {
    "ref": 189,
    "etat": "A venir",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-2024-0039",
    "description": "Eradication zones de briques tunnel de Lhez",
    "livrable": "XXX",
    "heures_totales": 38,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 190,
    "etat": "A venir",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-2024-0047",
    "description": "L590-APO-RAV CAUSSADE",
    "livrable": "2025-12-31",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 191,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-2024-0059",
    "description": "L650 APO R√©g√©n√©ration syst√®me CISTEL  par SIAM ST3 de Tournay √† Lourdes",
    "livrable": "XXX",
    "heures_totales": 280,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 192,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-2024-0067",
    "description": "L640-EP-T√©l√©surveillance Vigizone de Toulouse √† Bram",
    "livrable": "2025-10-24",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 193,
    "etat": "Prise en charge",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-2024-0070",
    "description": "L640-EP-TFNG Site de Toulouse Raynal P8",
    "livrable": "2025-02-28",
    "heures_totales": 130,
    "agents": "ANc",
    "heures_agents": {}
  },
  {
    "ref": 194,
    "etat": "Externalis√©",
    "cep": "Franck PRUNIER",
    "pl": "PLWB176",
    "eco": "TL-2024-0072",
    "description": "Projet phase REA Service Vid√©o R√©seau _ Programme ASPN pour 13 sites",
    "livrable": "2025-06-30",
    "heures_totales": 80,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 195,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLVS300",
    "eco": "TL-2024-0075",
    "description": "L640 REA Projet TERRALPHA _ Etude d'implantation √©quipement NOKIA √† CASTELNAUDARY",
    "livrable": "2025-02-28",
    "heures_totales": 11,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 196,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "PLXXXXX",
    "eco": "TL-2024-0091",
    "description": "L590-EP-D√©placement TVP ALBIAS",
    "livrable": "2025-06-27",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 197,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL-2024-0093",
    "description": "L640/650 EP Tunnel de Guilhemery_R√©fection par coque",
    "livrable": "2026-06-05",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 198,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLWG315",
    "eco": "TL-2024-0094",
    "description": "GUIIC - INFRACOM - Raccordement vid√©o r√©seau PN MPY",
    "livrable": "2025-05-30",
    "heures_totales": 200,
    "agents": "TLs+PCs",
    "heures_agents": {
      "Agent4": 100,
      "Agent5": 100
    }
  },
  {
    "ref": 199,
    "etat": "A venir",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-2024-0095",
    "description": " L640-DOE Migration Fibre sur Fibre GSM-R SAM 146 Agen - Montauban",
    "livrable": "2025-12-31",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 200,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLWA969",
    "eco": "TL-2024-0103",
    "description": "L590 REA Projet TERRALPHA _ Etude d'implantation √©quipement NOKIA √† GOURDON",
    "livrable": "2025-02-28",
    "heures_totales": 35,
    "agents": "MSt",
    "heures_agents": {
      "Agent3": 35
    }
  },
  {
    "ref": 201,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL-2024-0117",
    "description": "L590 EP D√©pose BS 207 - Sortie de Cahors",
    "livrable": "XXX",
    "heures_totales": 35,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 202,
    "etat": "Prise en charge",
    "cep": "Alexandre BOISSET",
    "pl": "XXXX",
    "eco": "TL-2024-0130",
    "description": "L590-EP-RVB RAV THEDIRAC",
    "livrable": "2025-12-31",
    "heures_totales": 50,
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 203,
    "etat": "A venir",
    "cep": "Alexandre BOISSET",
    "pl": "XXXX",
    "eco": "TL-2024-0131",
    "description": "L590-EP-PK 617_RAV Lalbenque",
    "livrable": "2025-12-31",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 204,
    "etat": "A venir",
    "cep": "Alexandre BOISSET",
    "pl": "XXXX",
    "eco": "TL-2024-0133",
    "description": "APO L672 RVB Voie A Latour de Carol",
    "livrable": "XXX",
    "heures_totales": 160,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 205,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-2024-XXXX",
    "description": "L640 APO D√©commissionnement c√¢ble TLXR026 4FO Toulouse - Carcassonne",
    "livrable": "2024-04-12",
    "heures_totales": 190,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 206,
    "etat": "Orpheline",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-2024-XXXX",
    "description": "L640 REA D√©commissionnement c√¢ble TLXR026 4FO Toulouse - Carcassonne",
    "livrable": "XXX",
    "heures_totales": 140,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 207,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLWJ193",
    "eco": "TL-2025-0001",
    "description": "L640-DCE-TVP Villefranche de Lauragais",
    "livrable": "2025-08-27",
    "heures_totales": 52,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 208,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL-2025-0002",
    "description": "L640-EP-R√©g√©n√©ration √©tanch√©it√© PRa BARROTS",
    "livrable": "2025-12-31",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 209,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL-2025-0003",
    "description": "L590-EP-R√©g√©n√©ration √©tanch√©it√© PRa COMBES DELPONT",
    "livrable": "2025-12-31",
    "heures_totales": 50,
    "agents": "xxx",
    "heures_agents": {}
  },
  {
    "ref": 210,
    "etat": "A venir",
    "cep": "Franck PRUNIER / Franck COPPILLIE",
    "pl": "PLWJ904",
    "eco": "TL-2025-0022",
    "description": "Evolution Backbone 10Gb/s",
    "livrable": "2025-11-14",
    "heures_totales": 180,
    "agents": "TLs + PCs",
    "heures_agents": {
      "Agent4": 120,
      "Agent5": 72
    }
  },
  {
    "ref": 211,
    "etat": "Prise en charge",
    "cep": "Jean-Pierre MAUBOURGUET",
    "pl": "PLPT266",
    "eco": "TL-20xx-0xxx",
    "description": "L650-REA-SNCF-E PCD Toulouse Phase 4",
    "livrable": "2025-12-31",
    "heures_totales": 300,
    "agents": "ANc, PCs",
    "heures_agents": {}
  },
  {
    "ref": 212,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "EP L701 CRANSAC D√©pose VE + BS1 & BS2",
    "livrable": "2022-06-30",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 213,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "EP L718 RVB VE CORDES LEXOS NAJAC",
    "livrable": "2022-06-30",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 214,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "EP L738 VIELMUR L737 LABRUGUIERE D√©pose VE + BS1 & BS2",
    "livrable": "2022-06-30",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 215,
    "etat": "A venir",
    "cep": "Sophie LELOUP",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "APO L640 TOULOUSE PERIOLE Modernisation remisage (D√©voiement r√©seaux - Lib√©ration fonci√®re)",
    "livrable": "2026-01-22",
    "heures_totales": "XXX",
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 216,
    "etat": "Termin√©",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "MOEE REA L640 S√©curisation entr√©e Sud ST JORY",
    "livrable": "2022-11-09",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 217,
    "etat": "A venir",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "EP Next Regio TESSONNIERES - ALBI + ALBI - RODEZ",
    "livrable": "2025-07-22",
    "heures_totales": 24,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 218,
    "etat": "Termin√©",
    "cep": "WDT",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "AVP Next Regio TESSONNIERES - ALBI + ALBI - RODEZ",
    "livrable": "2023-04-24",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 219,
    "etat": "Termin√©",
    "cep": "WDT",
    "pl": "PLQB084",
    "eco": "TL-20xx-0xxx",
    "description": "EP L648 Am√©lioration exploitation axe AUCH",
    "livrable": "2022-07-21",
    "heures_totales": 24,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 220,
    "etat": "Termin√©",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "AVP L648 Am√©lioration exploitation axe AUCH - Collecte donn√©es d'entr√©e",
    "livrable": "2023-01-20",
    "heures_totales": 35,
    "agents": "Anc/JBn",
    "heures_agents": {}
  },
  {
    "ref": 221,
    "etat": "Termin√©",
    "cep": "WDT",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "EP L640 Terminus Route de LAUNAGUET",
    "livrable": "XXX",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 222,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "PLTC212",
    "eco": "TL-20xx-0xxx",
    "description": "APO L650 RAV CAZERES",
    "livrable": "2024-05-24",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 223,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "MOEE REA L650 RAV CAZERES",
    "livrable": "2024-10-30",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 224,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "MOEE REA L650 RAV ST GAUDENS",
    "livrable": "2022-06-23",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 225,
    "etat": "A venir",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "PRO L650 RVB TOURNAY - TARBES",
    "livrable": "2026-02-17",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 226,
    "etat": "A venir",
    "cep": "Franck PRUNIER",
    "pl": "PLPB233",
    "eco": "TL-20xx-0xxx",
    "description": "SNCF-E REA TCTK EALE SECTEUR 5 MONTAUBAN - reprise",
    "livrable": "XXX",
    "heures_totales": 45,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 227,
    "etat": "A venir",
    "cep": "WDT",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "AVP L737 ADAP MAZAMET",
    "livrable": "XXX",
    "heures_totales": 20,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 228,
    "etat": "Termin√©",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "EP Ligne Liaison Desserte Fine des Territoires",
    "livrable": "2022-07-29",
    "heures_totales": "XX",
    "agents": "FPt",
    "heures_agents": {}
  },
  {
    "ref": 229,
    "etat": "A venir",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "EP L650 TO MONTREJEAU - TARBES",
    "livrable": "XXX",
    "heures_totales": 150,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 230,
    "etat": "A venir",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "APO L650 TO MONTREJEAU - TARBES",
    "livrable": "XXX",
    "heures_totales": "XX",
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 231,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLPB233",
    "eco": "TL-20xx-0xxx",
    "description": "MOEE REA TCTK EALE SECTEUR 1 MONTAUBAN - reprise",
    "livrable": "XXX",
    "heures_totales": 75,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 232,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "SNCF-E REA TCTK EALE SECTEUR 1 MONTAUBAN - reprise",
    "livrable": "XXX",
    "heures_totales": 45,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 233,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLPB233",
    "eco": "TL-20xx-0xxx",
    "description": "MOEE REA TCTK EALE SECTEUR 3 AGEN - reprise",
    "livrable": "2022-12-31",
    "heures_totales": 80,
    "agents": "BLs",
    "heures_agents": {}
  },
  {
    "ref": 234,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "SNCF-E REA TCTK EALE SECTEUR 3 AGEN - reprise",
    "livrable": "2023-12-31",
    "heures_totales": 45,
    "agents": "BLs",
    "heures_agents": {}
  },
  {
    "ref": 235,
    "etat": "Prise en charge",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "EP L640 Elargissement PN150",
    "livrable": "XXX",
    "heures_totales": 26,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 236,
    "etat": "Orpheline",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "L737-APO-ASPN Supp PN13, 14 & 16 + d√©placement PN15-",
    "livrable": "2023-12-31",
    "heures_totales": 80,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 237,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "EP L738 Supp PN57",
    "livrable": "XXX",
    "heures_totales": 26,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 238,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "APO L738 Supp PN57",
    "livrable": "XXX",
    "heures_totales": 28,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 239,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "MOEE REA L738 Supp PN57",
    "livrable": "XXX",
    "heures_totales": 40,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 240,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "APO L718 Modification PN65",
    "livrable": "XXX",
    "heures_totales": 70,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 241,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "EP L640 Elargissement Pont POMPIDOU TOULOUSE",
    "livrable": "2023-12-31",
    "heures_totales": 30,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 242,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "AVP L640 Elargissement Pont POMPIDOU TOULOUSE",
    "livrable": "XXX",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 243,
    "etat": "A venir",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "MOEE REA RG MIC TOULOUSE - FOIX",
    "livrable": "XXX",
    "heures_totales": 240,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 244,
    "etat": "A venir",
    "cep": "Franck PRUNIER",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "SNCF-E REA RG MIC TOULOUSE - FOIX",
    "livrable": "XXX",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 245,
    "etat": "Termin√©",
    "cep": "Nesrine DEROMBISE",
    "pl": "PLVP065",
    "eco": "TL-20xx-0xxx",
    "description": "REA L640 AFNT",
    "livrable": "XXX",
    "heures_totales": "XXXX",
    "agents": "CPr/NGl",
    "heures_agents": {}
  },
  {
    "ref": 246,
    "etat": "Termin√©",
    "cep": "Anthony MUTLU",
    "pl": "XXXX",
    "eco": "TL-20xx-0xxx",
    "description": "MOEE REA L718 RVB V2 VILLEFRANCHE DE R",
    "livrable": "XXX",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 247,
    "etat": "Orpheline",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-20XX-XXXX",
    "description": "L648-EP-Mise en conformit√© du Gers",
    "livrable": "2025-08-31",
    "heures_totales": 75,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 248,
    "etat": "A venir",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-20XX-XXXX",
    "description": "APO L650 RAV TARBES c√¥t√© Toulouse",
    "livrable": "2026-01-07",
    "heures_totales": "XX",
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 249,
    "etat": "Termin√©",
    "cep": "Vincent PARDOPARGA",
    "pl": "XXXX",
    "eco": "TL-20XX-XXXX",
    "description": "AVP L650 RVB TARBES - LIMITE REGION",
    "livrable": "2023-12-31",
    "heures_totales": 1,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 250,
    "etat": "A venir",
    "cep": "Sophie LELOUP",
    "pl": "PLUR249",
    "eco": "TL-20XX-XXXX",
    "description": "L640-PRO/REA-Lib√©ration Bande Infra RAYNAL-JJ9338",
    "livrable": "2024-12-31",
    "heures_totales": 40,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 251,
    "etat": "Termin√©",
    "cep": "Gillen JAUREGUIBERRY",
    "pl": "PLTM999",
    "eco": "TL-20XX-XXXX",
    "description": "Collecte donn√©es d'entr√©e pour le projet d'am√©lioration de l'axe Toulouse - Auch",
    "livrable": "2023-01-20",
    "heures_totales": 35,
    "agents": "Anc/JBn",
    "heures_agents": {}
  },
  {
    "ref": 252,
    "etat": "Prise en charge",
    "cep": "Franck PRUNIER",
    "pl": "PLUD551",
    "eco": "TL-20XX-XXXX",
    "description": "L640-XXX-Affectation fibres INFRACOM autour de Montauban-F",
    "livrable": "2023-08-04",
    "heures_totales": 20,
    "agents": "ANc",
    "heures_agents": {}
  },
  {
    "ref": 253,
    "etat": "Termin√©",
    "cep": "Franck PRUNIER",
    "pl": "PLPY502",
    "eco": "TL-XXXX-XXXX",
    "description": "MOEE REA L640 3RP TETRA TOULOUSE MATABIAU",
    "livrable": "XXX",
    "heures_totales": 40,
    "agents": "TLs",
    "heures_agents": {}
  },
  {
    "ref": 254,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "PLWL355",
    "eco": "TL-XXXX-XXXX",
    "description": "L650-REA-Supp PN170",
    "livrable": "2025-04-28",
    "heures_totales": "XX",
    "agents": "FPr",
    "heures_agents": {}
  },
  {
    "ref": 255,
    "etat": "Pas d'impact TL",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-XXXX-XXXX",
    "description": "L640 REA RB V1 et V2 + Assainissement PN219 + R√©g√©n√©ration OA en gare d'Avignonet",
    "livrable": "2024-05-07",
    "heures_totales": 165,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 256,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-XXXX-XXXX",
    "description": "L648-REA-Notice ASTI pour Elargissement PN18 ",
    "livrable": "2025-06-26",
    "heures_totales": "XX",
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 257,
    "etat": "Prise en charge",
    "cep": "Micka√´l MARTEL",
    "pl": "PLWE127",
    "eco": "TL-2024-0134",
    "description": "Projet FERCOM Phases PRO/REA",
    "livrable": "2026-08-05",
    "heures_totales": 1500,
    "agents": "ANc, PAe",
    "heures_agents": {
      "Agent1": 1000,
      "Agent6": 500
    }
  },
  {
    "ref": 258,
    "etat": "Termin√©",
    "cep": "Sophie LELOUP",
    "pl": "PLXXXXX",
    "eco": "TL-2025-0001",
    "description": "L640-REA-TVP Villefranche de Lauragais - Notice ASTI",
    "livrable": "2025-09-24",
    "heures_totales": 36,
    "agents": "NGl",
    "heures_agents": {}
  },
  {
    "ref": 259,
    "etat": "Prise en charge",
    "cep": "Franck PRUNIER",
    "pl": "ING",
    "eco": null,
    "description": "Mission de RCO - Veille collection TL-EE-EALE",
    "livrable": "2025-12-31",
    "heures_totales": "2 journ√©es courtes par mois",
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 260,
    "etat": "Prise en charge",
    "cep": "Franck PRUNIER",
    "pl": "ING",
    "eco": null,
    "description": "Mission de RED pour la GED",
    "livrable": "2025-12-31",
    "heures_totales": "2 journ√©es courte par mois",
    "agents": "MSt",
    "heures_agents": {}
  },
  {
    "ref": 261,
    "etat": "Prise en charge",
    "cep": "Julie DERNE",
    "pl": "PLTV921",
    "eco": "TL-2025-0010",
    "description": "L650-DCE- RAV + RVB en gare de MURET",
    "livrable": "2025-10-24",
    "heures_totales": 113,
    "agents": "MSt",
    "heures_agents": {
      "Agent3": 113
    }
  },
  {
    "ref": 262,
    "etat": "A venir",
    "cep": "Julie DERNE",
    "pl": "Pas de PL",
    "eco": "TL-XXXX-XXXX",
    "description": "L701-XXX-D√©pose ADV Viviez + Hydro c√¥t√© partie 1",
    "livrable": "2025-10-28",
    "heures_totales": 0,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 263,
    "etat": "A venir",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "TL-XXXX-XXXX",
    "description": "L701-XXX-Remplacement VB + RAV BS2 Viviez-  DCE TL",
    "livrable": "2025-10-24",
    "heures_totales": 0,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 264,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "PLWL355",
    "eco": "TL-2025-0074",
    "description": "Suppression PN175 L650 - DCE",
    "livrable": "2026-03-27",
    "heures_totales": 48,
    "agents": "MSt",
    "heures_agents": {
      "Agent3": 45
    }
  },
  {
    "ref": 265,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-2025-0015",
    "description": "L590-EP-Mise en conformit√© du d√©lai d'annonce aux PN377 et 378",
    "livrable": "2025-12-31",
    "heures_totales": 30,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 266,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-2025-0016",
    "description": "L640-EP-Mise en conformit√© d√©lai d'annonce PN163",
    "livrable": "2025-12-31",
    "heures_totales": 30,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 267,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL-2025-0066",
    "description": "L590 EP RAV, RVB et d√©pose BS et VS en gare de CAUSSADE",
    "livrable": "2026-01-02",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 268,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-2025-0087",
    "description": "L650 REA Suppression PN172",
    "livrable": "XXX",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 269,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": "XXXX",
    "eco": "TL-2025-0061",
    "description": "L590 EP R√©g√©n√©ration Tunnel de Vayri√®res",
    "livrable": "XXX",
    "heures_totales": 50,
    "agents": "XXX",
    "heures_agents": {}
  },
  {
    "ref": 270,
    "etat": "A venir",
    "cep": "Julie DERNE",
    "pl": "PLTV827",
    "eco": "TL-2025-0074",
    "description": "L590-DCE-RVB Zone bois entre Cahors et Lamothe-F√©nelonv-F60698",
    "livrable": "2025-12-31",
    "heures_totales": 155,
    "agents": "MSt",
    "heures_agents": {
      "Agent3": 140
    }
  },
  {
    "ref": 271,
    "etat": "A venir",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-20XX-XXXX",
    "description": "L650-EP-Elargissement PN41",
    "livrable": "2025-12-19",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 272,
    "etat": "Prise en charge",
    "cep": "Philippe CAVAILLE",
    "pl": "XXXX",
    "eco": "TL-20XX-XXXX",
    "description": "DCE/REA Mise en place de T√©l√©phones autoroutiers sur 18 PN L640 et 9 PN L650",
    "livrable": "XXX",
    "heures_totales": 100,
    "agents": "MSt",
    "heures_agents": {
      "Agent3": 100
    }
  },
  {
    "ref": 273,
    "etat": "A venir",
    "cep": "Alexandre BOISSET",
    "pl": "XXXX",
    "eco": "TL-2024-0108",
    "description": "Am√©nagement nouvelle entr√©e Raynal \nEtude pr√©liminaire avec 3 solutions",
    "livrable": "2026-12-31",
    "heures_totales": 260,
    "agents": "NGl, MSt",
    "heures_agents": {}
  },
  {
    "ref": 274,
    "etat": "A venir",
    "cep": "Franck COPPILLIE",
    "pl": "Demand√©e",
    "eco": "TL-2024-0064",
    "description": "DCO Infranet Infracom - CCR de Toulouse",
    "livrable": "2025-12-31",
    "heures_totales": 112,
    "agents": "PCs",
    "heures_agents": {
      "Agent5": 110
    }
  },
  {
    "ref": 275,
    "etat": "A venir",
    "cep": "Franck COPPILLIE",
    "pl": "XXXX",
    "eco": "Pr√©vision",
    "description": "RG du CSS - Etudes REA",
    "livrable": "XXX",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 276,
    "etat": "A venir",
    "cep": "Jean-Pierre MAUBOURGUET",
    "pl": "XXXX",
    "eco": "Pr√©vision",
    "description": "D√©placement des activit√©s - Etudes REA",
    "livrable": "XXX",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 277,
    "etat": "A venir",
    "cep": "Alexandre BOISSET",
    "pl": "XXXX",
    "eco": "TL-2025-0056",
    "description": "L672 - EP RR+RVB Tunnel de Puymorens - S27144",
    "livrable": "XXX",
    "heures_totales": 0,
    "agents": "NGl, MSt",
    "heures_agents": {}
  },
  {
    "ref": 278,
    "etat": "A venir",
    "cep": "Franck COPPILLIE",
    "pl": null,
    "eco": "TL-2025-0045",
    "description": "L718 - EP Plan fibre St Denis Capdenac- F71131",
    "livrable": "2025-12-26",
    "heures_totales": 164,
    "agents": "NGl",
    "heures_agents": {
      "Agent2": 154
    }
  },
  {
    "ref": 279,
    "etat": "A venir",
    "cep": "Sophie LELOUP",
    "pl": null,
    "eco": null,
    "description": "L640 - PRO Lab√©ge La Cadenne - K EXT",
    "livrable": "2025-12-26",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 280,
    "etat": "A venir",
    "cep": "Franck COPPILLIE",
    "pl": "XXXX",
    "eco": "TL-2025-0001",
    "description": "L640 - PRO/REA Migration Fibre sur Fibre GSM-R SAM 146 Agen - Montauban - F52440",
    "livrable": "2025-12-05",
    "heures_totales": 200,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 281,
    "etat": "A venir",
    "cep": "Sophie LELOUP",
    "pl": "XXXX",
    "eco": "?",
    "description": "L640 - Lab√©ge La Cadenne, cr√©ation halte, KEXT\nJH5275",
    "livrable": "2026-01-30",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 282,
    "etat": "A venir",
    "cep": "Sophie LELOUP",
    "pl": "XXXX",
    "eco": "?",
    "description": "L648 - Allongement des quais du Gers\nJJ9124",
    "livrable": "2026-01-30",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 283,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": null,
    "eco": null,
    "description": "L590 - Reprise APO RAVs Gourdon\nF46288",
    "livrable": "2026-05-22",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 284,
    "etat": "A venir",
    "cep": "Micka√´l MARTEL",
    "pl": null,
    "eco": null,
    "description": "L590 - RAV RVB Th√©dirac et Lalbenque",
    "livrable": "2026-12-11",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 285,
    "etat": "A venir",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "?",
    "description": "L640 - Etude d'opportunit√© d√©viation de Bressols",
    "livrable": "2025-12-19",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 286,
    "etat": "A venir",
    "cep": "Julie DERNE",
    "pl": "XXXX",
    "eco": "?",
    "description": "L640 - EP d√©viation de Bressols",
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 287,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 288,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 289,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 290,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 291,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 292,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 293,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 294,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 295,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 296,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 297,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 298,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 299,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 300,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 301,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 302,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 303,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 304,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 305,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 306,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 307,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 308,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 309,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 310,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 311,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 312,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 313,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 314,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 315,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 316,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 317,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 318,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 319,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 320,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 321,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 322,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 323,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 324,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 325,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 326,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 327,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 328,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 329,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 330,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 331,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 332,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 333,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 334,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 335,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 336,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 337,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 338,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 339,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 340,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 341,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 342,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 343,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 344,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 345,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 346,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 347,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 348,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 349,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 350,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 351,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 352,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 353,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 354,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 355,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 356,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 357,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 358,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 359,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 360,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 361,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 362,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 363,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 364,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 365,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 366,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 367,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 368,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 369,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 370,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 371,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 372,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 373,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 374,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 375,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 376,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 377,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 378,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 379,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 380,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 381,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 382,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 383,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 384,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 385,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 386,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 387,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 388,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 389,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 390,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 391,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 392,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 393,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 394,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 395,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 396,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 397,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 398,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 399,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 400,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 401,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 402,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 403,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 404,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 405,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 406,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 407,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 408,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 409,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 410,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 411,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 412,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 413,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 414,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 415,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 416,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 417,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 418,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 419,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 420,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 421,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 422,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 423,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 424,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 425,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 426,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 427,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 428,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 429,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 430,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 431,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 432,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 433,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 434,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 435,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 436,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 437,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 438,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 439,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 440,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 441,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 442,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 443,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 444,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 445,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 446,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 447,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 448,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 449,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 450,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 451,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 452,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 453,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 454,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 455,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 456,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 457,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 458,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 459,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 460,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 461,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 462,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 463,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 464,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 465,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 466,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 467,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 468,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 469,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 470,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 471,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 472,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 473,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 474,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 475,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 476,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 477,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 478,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 479,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 480,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 481,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 482,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 483,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 484,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 485,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 486,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 487,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  },
  {
    "ref": 488,
    "etat": null,
    "cep": null,
    "pl": null,
    "eco": null,
    "description": null,
    "livrable": "Non d√©fini",
    "heures_totales": 0,
    "agents": "",
    "heures_agents": {}
  }
];

        // Liste des CEP
        const LISTE_CEP = [
            'Alexandre BOISSET',
            'Christophe CANCE',
            'Franck COPPILLIE',
            'Franck PRUNIER',
            'Gillen JAUREGUIBERRY',
            'Jean-Pierre MAUBOURGUET',
            'Julie DERNE',
            'Micka√´l MARTEL',
            'Nesrine DEROMBISE',
            'Olivier THOUVENOT',
            'Philippe CAVAILLE',
            'Sophie LELOUP'
        ];
        
        // Liste des √âtats
        const LISTE_ETATS = [
            'A venir',
            'Termin√©',
            'Prise en charge',
            'Orpheline',
            'Externalis√©',
            'Pas d\'impact TL'
        ];
        
        // Liste des Sp√©cialit√©s
        const LISTE_SPECIALITES = [
            'G√©nie-Civil',
            'Transmission',
            'Am√©nagement de Locaux',
            'IP',
            'T√©l√©phone Ferroviaire'
        ];

        // G√©n√©rer les 52 semaines de 2025
        function generateWeeks() {
            const weeks = [];
            let date = new Date('2025-01-06'); // Premier lundi de 2025
            
            for (let i = 1; i <= 52; i++) {
                weeks.push({
                    numero: i,
                    date: new Date(date),
                    label: `S${i}`,
                    dateStr: date.toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit' })
                });
                date.setDate(date.getDate() + 7);
            }
            
            return weeks;
        }

        const WEEKS = generateWeeks();
        
        // Obtenir la semaine actuelle
        function getCurrentWeek() {
            const now = new Date();
            const start = new Date('2025-01-06');
            const diff = Math.floor((now - start) / (7 * 24 * 60 * 60 * 1000));
            return Math.min(Math.max(diff + 1, 1), 52);
        }

        const CURRENT_WEEK = getCurrentWeek();
        
        // Jours f√©ri√©s fran√ßais 2025
        const JOURS_FERIES_2025 = [
            '2025-01-01', // Nouvel An
            '2025-04-21', // Lundi de P√¢ques
            '2025-05-01', // F√™te du Travail
            '2025-05-08', // Victoire 1945
            '2025-05-29', // Ascension
            '2025-06-09', // Lundi de Pentec√¥te
            '2025-07-14', // F√™te Nationale
            '2025-08-15', // Assomption
            '2025-11-01', // Toussaint
            '2025-11-11', // Armistice 1918
            '2025-12-25'  // No√´l
        ];
        
        // Fonction pour calculer les heures de travail d'une semaine en tenant compte des f√©ri√©s
        function calculerHeuresSemaine(weekNum) {
            // Trouver les dates de la semaine
            const weekData = WEEKS.find(w => w.numero === weekNum);
            if (!weekData || !weekData.date) return 37;
            
            const startDate = new Date(weekData.date);
            if (isNaN(startDate.getTime())) return 37; // Si date invalide, retourner 37h
            
            let heuresTotal = 37; // Par d√©faut: 4 jours √† 8h + 1 vendredi √† 5h
            
            // V√©rifier chaque jour de la semaine
            for (let i = 0; i < 5; i++) { // Lundi √† Vendredi
                const currentDate = new Date(startDate);
                currentDate.setDate(startDate.getDate() + i);
                const dateStr = currentDate.toISOString().split('T')[0];
                
                // Si c'est un jour f√©ri√©
                if (JOURS_FERIES_2025.includes(dateStr)) {
                    const dayOfWeek = currentDate.getDay(); // 0 = Dimanche, 1 = Lundi, ..., 5 = Vendredi
                    
                    if (dayOfWeek === 5) { // Vendredi
                        heuresTotal -= 5;
                    } else if (dayOfWeek >= 1 && dayOfWeek <= 4) { // Lundi √† Jeudi
                        heuresTotal -= 8;
                    }
                }
            }
            
            return heuresTotal;
        }
        
        // Variables pour les toggles
        let showOrphelines = true;
        let showTermines = true;
        let showSecondaires = true; // Externalis√©, Prise en charge, Pas d'impact TL
        
        // Matrice de comp√©tences des agents (stock√©e dans localStorage)
        let agentsCompetences = JSON.parse(localStorage.getItem('agentsCompetences')) || {
            'ANc': {},
            'NGl': {},
            'MSt': {},
            'PCs': {},
            'PAe': {}
        };
        
        // Initialiser les comp√©tences si elles n'existent pas
        Object.keys(AGENTS).forEach(agentCode => {
            if (!agentsCompetences[agentCode]) {
                agentsCompetences[agentCode] = {};
            }
            LISTE_SPECIALITES.forEach(spec => {
                if (!agentsCompetences[agentCode][spec]) {
                    agentsCompetences[agentCode][spec] = 'NC';
                }
            });
        });

        // Calculer les jours restants jusqu'√† la date de livrable
        function calculateDaysRemaining(dateStr, etat) {
            // Si le projet est termin√© ou orphelin, ne rien afficher
            if (etat && (etat.toLowerCase().includes('termin√©') || etat.toLowerCase().includes('orphelin'))) {
                return { days: null, text: '', class: '' };
            }
            
            if (!dateStr || dateStr === 'Non d√©fini' || dateStr === 'XXX' || dateStr.trim() === '') {
                return { days: null, text: '-', class: '' };
            }
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const targetDate = new Date(dateStr);
            targetDate.setHours(0, 0, 0, 0);
            
            const diffTime = targetDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            let text, className;
            
            if (diffDays < 0) {
                text = `${Math.abs(diffDays)}j en retard`;
                className = 'days-overdue';
            } else if (diffDays === 0) {
                text = "Aujourd'hui";
                className = 'days-today';
            } else if (diffDays <= 7) {
                text = `${diffDays}j`;
                className = 'days-urgent';
            } else if (diffDays <= 30) {
                text = `${diffDays}j`;
                className = 'days-soon';
            } else {
                text = `${diffDays}j`;
                className = 'days-ok';
            }
            
            return { days: diffDays, text: text, class: className };
        }

        // Obtenir la classe du badge selon l'√©tat
        function getBadgeClass(etat) {
            if (!etat) return 'badge-avenir';
            const etatLower = etat.toLowerCase();
            if (etatLower.includes('prise')) return 'badge-prise';
            if (etatLower.includes('externe')) return 'badge-externe';
            return 'badge-avenir';
        }

        // Cr√©er le tableau Gantt pour un agent
        function createGanttTable(projets, agentCode) {
            const weeks = WEEKS;
            
            let html = `
                <div style="margin-bottom: 1rem; display: flex; justify-content: space-between; align-items: center; gap: 1rem; flex-wrap: wrap;">
                    <div style="color: #666; font-size: 0.9rem;">
                        <span style="background: #fff3cd; padding: 0.3rem 0.6rem; border-radius: 4px; margin-right: 1rem;">üü® √âditable</span>
                        <span style="background: #f8d7da; padding: 0.3rem 0.6rem; border-radius: 4px;">üü• Calcul√© auto</span>
                    </div>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <button onclick="selectAllProjects('${agentCode}')" class="btn-toggle" style="font-size: 0.85rem; padding: 0.4rem 0.8rem;">
                            ‚úÖ Tout s√©lectionner
                        </button>
                        <button onclick="deselectAllProjects('${agentCode}')" class="btn-toggle" style="font-size: 0.85rem; padding: 0.4rem 0.8rem;">
                            ‚ùå Tout d√©s√©lectionner
                        </button>
                        <button onclick="isolateSelectedProjects('${agentCode}')" class="btn-toggle" style="font-size: 0.85rem; padding: 0.4rem 0.8rem; background: #667eea; color: white;">
                            üîç Isoler s√©lection
                        </button>
                        <button onclick="showAllProjects('${agentCode}')" class="btn-toggle" style="font-size: 0.85rem; padding: 0.4rem 0.8rem;">
                            üëÅÔ∏è Tout afficher
                        </button>
                        <button onclick="togglePastWeeks('${agentCode}')" class="btn-toggle" id="toggle-past-${agentCode}">
                            <span id="toggle-icon-${agentCode}">üëÅÔ∏è</span>
                            <span id="toggle-text-${agentCode}">Masquer semaines pass√©es</span>
                        </button>
                    </div>
                </div>
                <div class="gantt-container">
                    <table class="gantt-table gantt-table-excel" id="gantt-table-${agentCode}">
                        <thead>
                            <!-- Ligne 1: Heures √† pointer -->
                            <tr class="excel-row-1">
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th class="excel-header">Heures √† pointer</th>
            `;
            
            // Heures √† pointer par semaine - calcul√©es avec les jours f√©ri√©s
            weeks.forEach(week => {
                const pastClass = week.numero < CURRENT_WEEK ? 'past-week' : '';
                const heuresSemaine = calculerHeuresSemaine(week.numero);
                html += `<th class="excel-calculated ${pastClass}" data-week="${week.numero}">
                    <input type="number" class="excel-input" id="heures-pointer-${agentCode}-${week.numero}" 
                           value="${heuresSemaine}" min="0" max="40" step="1" readonly
                           style="background-color: #f8f9fa; cursor: not-allowed; border: none;"
                           title="Calcul√© automatiquement: (heures semaine - jours f√©ri√©s - heures improductives) √ó taux productivit√©">
                </th>`;
            });
            
            html += `
                            </tr>
                            <!-- Ligne 2: Reste √† pointer -->
                            <tr class="excel-row-2">
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th class="excel-header">Reste √† pointer</th>
            `;
            
            // Reste √† pointer (calcul√© dynamiquement)
            weeks.forEach(week => {
                const pastClass = week.numero < CURRENT_WEEK ? 'past-week' : '';
                const heuresSemaine = calculerHeuresSemaine(week.numero);
                html += `<th class="excel-calculated ${pastClass}" data-week="${week.numero}">
                    <span class="reste-pointer" id="reste-${agentCode}-${week.numero}">${heuresSemaine}</span>h
                </th>`;
            });
            
            html += `
                            </tr>
                            <!-- Ligne 3: Total improductives -->
                            <tr class="excel-row-3">
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th class="excel-header">Total improductives</th>
            `;
            
            // Total improductives (calcul√© - jaune)
            weeks.forEach(week => {
                const pastClass = week.numero < CURRENT_WEEK ? 'past-week' : '';
                html += `<th class="excel-calculated ${pastClass}" data-week="${week.numero}">
                    <span class="total-improd" id="improd-${agentCode}-${week.numero}">0</span>h
                </th>`;
            });
            
            html += `
                            </tr>
            `;
            
            // Lignes 4-7: Cong√©s, Maladie, Formation, Temps Partiel (avec inputs jaunes)
            const lignesImproductives = [
                { id: 'conges', label: 'Cong√©s', icon: 'üèñÔ∏è', bg: '#fff3cd' },
                { id: 'maladie', label: 'Maladie', icon: 'ü§í', bg: '#fff3cd' },
                { id: 'formation', label: 'Formation', icon: 'üìö', bg: '#fff3cd' },
                { id: 'temps-partiel', label: 'Temps Partiel', icon: '‚è∞', bg: '#fff3cd' }
            ];
            
            lignesImproductives.forEach((ligne, idx) => {
                html += `
                    <tr class="excel-row-${4 + idx}" data-type="${ligne.id}">
                        <th style="background: ${ligne.bg};">${ligne.icon}</th>
                        <th style="background: ${ligne.bg};"></th>
                        <th style="background: ${ligne.bg};"></th>
                        <th style="background: ${ligne.bg};"></th>
                        <th style="background: ${ligne.bg};"></th>
                        <th class="excel-header" style="background: ${ligne.bg};">${ligne.label}</th>
                `;
                
                weeks.forEach(week => {
                    const pastClass = week.numero < CURRENT_WEEK ? 'past-week' : '';
                    html += `<th class="excel-editable ${pastClass}" data-week="${week.numero}" style="background: ${ligne.bg};">
                        <input type="number" class="excel-input improd-input" 
                               data-type="${ligne.id}" data-week="${week.numero}"
                               min="0" max="40" step="0.5" placeholder="0"
                               onchange="recalculateWeek('${agentCode}', ${week.numero})">
                    </th>`;
                });
                
                html += `</tr>`;
            });
            
            html += `
                            <!-- Ligne 8: En-t√™tes des colonnes projet -->
                            <tr class="excel-row-8">
                                <th style="width: 35px; min-width: 35px; max-width: 35px;">
                                    <input type="checkbox" id="select-all-${agentCode}" 
                                           onchange="toggleAllProjectsSelection('${agentCode}')"
                                           style="cursor: pointer; width: 16px; height: 16px;">
                                </th>
                                <th>R√©f</th>
                                <th>√âtat</th>
                                <th>Description</th>
                                <th>Heures Projet</th>
                                <th>Cumul heures agent</th>
            `;
            
            // En-t√™tes des semaines
            weeks.forEach(week => {
                const currentClass = week.numero === CURRENT_WEEK ? 'current-week' : '';
                const pastClass = week.numero < CURRENT_WEEK ? 'past-week' : '';
                html += `
                    <th class="gantt-cell ${currentClass} ${pastClass}" data-week="${week.numero}">
                        <div class="week-header">
                            <span class="week-number">${week.label}</span>
                            <span class="week-date">${week.dateStr}</span>
                        </div>
                    </th>
                `;
            });
            
            html += `
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            // Lignes des projets (avec inputs jaunes et cumul rouge)
            projets.forEach((projet, index) => {
                const agent = AGENTS[agentCode];
                const agentHeures = projet.heures_agents[`Agent${agent.col - 11}`] || 0;
                
                html += `
                    <tr data-type="projet" data-projet-index="${index}" class="projet-row-${agentCode}">
                        <td class="excel-editable" style="text-align: center;">
                            <input type="checkbox" class="project-checkbox-${agentCode}" 
                                   data-projet-index="${index}"
                                   onchange="updateSelectAllCheckbox('${agentCode}')"
                                   style="cursor: pointer; width: 16px; height: 16px;">
                        </td>
                        <td class="excel-editable">${projet.ref ? '#' + projet.ref : ''}</td>
                        <td class="excel-editable"><span class="badge ${getBadgeClass(projet.etat)}">${projet.etat || 'N/A'}</span></td>
                        <td class="excel-editable">
                            <div class="project-description" title="${projet.description}">
                                ${projet.description || 'Sans description'}
                            </div>
                            <small>
                                <strong>PL:</strong> ${projet.pl || 'N/A'} 
                                <span style="margin: 0 0.3rem;">‚Ä¢</span> 
                                <strong>CEP:</strong> ${projet.cep || 'N/A'}
                            </small>
                        </td>
                        <td class="excel-editable"><span class="total-hours">${agentHeures}h</span></td>
                        <td class="excel-calculated">
                            <span class="cumul-projet" id="cumul-projet-${agentCode}-${index}">0</span>h
                        </td>
                `;
                
                // Cellules des semaines (jaunes √©ditables)
                weeks.forEach(week => {
                    const currentClass = week.numero === CURRENT_WEEK ? 'current-week' : '';
                    const pastClass = week.numero < CURRENT_WEEK ? 'past-week' : '';
                    html += `<td class="gantt-cell excel-editable ${currentClass} ${pastClass}" data-week="${week.numero}">
                        <input type="number" min="0" max="40" step="0.5" 
                               class="excel-input projet-input" 
                               data-projet-index="${index}"
                               data-week="${week.numero}"
                               onchange="recalculateWeek('${agentCode}', ${week.numero}); updateProjectCumul('${agentCode}', ${index})"
                               placeholder="0">
                    </td>`;
                });
                
                html += `</tr>`;
            });
            
            html += `
                        </tbody>
                    </table>
                </div>
            `;
            
            return html;
        }
        
        // Fonction pour masquer/afficher les semaines pass√©es
        let hidePastWeeks = {};
        
        function togglePastWeeks(agentCode) {
            hidePastWeeks[agentCode] = !hidePastWeeks[agentCode];
            
            const table = document.getElementById(`gantt-table-${agentCode}`);
            const icon = document.getElementById(`toggle-icon-${agentCode}`);
            const text = document.getElementById(`toggle-text-${agentCode}`);
            
            const pastCells = table.querySelectorAll('.past-week');
            
            if (hidePastWeeks[agentCode]) {
                pastCells.forEach(cell => cell.style.display = 'none');
                icon.textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è';
                text.textContent = 'Afficher semaines pass√©es';
            } else {
                pastCells.forEach(cell => cell.style.display = '');
                icon.textContent = 'üëÅÔ∏è';
                text.textContent = 'Masquer semaines pass√©es';
            }
        }
        
        // Fonction pour recalculer une semaine (formules F2 et F3)
        function recalculateWeek(agentCode, weekNum) {
            const table = document.getElementById(`gantt-table-${agentCode}`);
            
            // 1. Calculer total improductives (Cong√©s + Maladie + Formation + Temps Partiel)
            const improdInputs = table.querySelectorAll(`.improd-input[data-week="${weekNum}"]`);
            let totalImprod = 0;
            improdInputs.forEach(input => {
                totalImprod += parseFloat(input.value) || 0;
            });
            
            // Mettre √† jour l'affichage du total improductives avec animation
            const totalImprodSpan = document.getElementById(`improd-${agentCode}-${weekNum}`);
            if (totalImprodSpan) {
                totalImprodSpan.classList.add('value-changed');
                totalImprodSpan.textContent = totalImprod.toFixed(1);
                setTimeout(() => totalImprodSpan.classList.remove('value-changed'), 400);
            }
            
            // 2. Calculer total des heures projet pour cette semaine
            const projetInputs = table.querySelectorAll(`.projet-input[data-week="${weekNum}"]`);
            let totalProjet = 0;
            projetInputs.forEach(input => {
                totalProjet += parseFloat(input.value) || 0;
            });
            
            // 3. NOUVELLE LOGIQUE DE CALCUL avec prise en compte des jours f√©ri√©s
            // Formule: (heures de la semaine - heures f√©ri√©s - heures improductives) √ó taux productivit√©
            const heuresSemaine = calculerHeuresSemaine(weekNum); // 37h par d√©faut, moins les jours f√©ri√©s
            const tauxProductivite = 1 - ((tauxImproductivite[agentCode] || 10) / 100);
            
            // Calculer les heures √† pointer
            const heuresApresImprod = heuresSemaine - totalImprod;
            const heuresAPointer = Math.floor(heuresApresImprod * tauxProductivite);
            
            // Mettre √† jour l'affichage des heures √† pointer
            const heuresPointerInput = document.getElementById(`heures-pointer-${agentCode}-${weekNum}`);
            if (heuresPointerInput) {
                heuresPointerInput.value = heuresAPointer;
            }
            
            // Calculer le reste √† pointer (heures √† pointer - heures d√©j√† point√©es sur projets)
            const resteAPointer = Math.floor(heuresAPointer - totalProjet);
            
            // Mettre √† jour l'affichage du reste avec animation et ic√¥nes
            const resteSpan = document.getElementById(`reste-${agentCode}-${weekNum}`);
            if (resteSpan) {
                resteSpan.classList.add('value-changed');
                
                // Ajouter des ic√¥nes selon la valeur
                let icon = '';
                if (resteAPointer < 0) {
                    icon = ' ‚ö†Ô∏è';
                    resteSpan.style.color = '#dc3545';
                    resteSpan.style.fontWeight = 'bold';
                } else if (resteAPointer === 0) {
                    icon = ' ‚úÖ';
                    resteSpan.style.color = '#28a745';
                    resteSpan.style.fontWeight = 'bold';
                } else if (resteAPointer > 0 && resteAPointer <= 2) {
                    icon = ' üëç';
                    resteSpan.style.color = '#28a745';
                    resteSpan.style.fontWeight = 'bold';
                } else {
                    resteSpan.style.color = '#667eea';
                    resteSpan.style.fontWeight = '600';
                }
                
                resteSpan.innerHTML = `${resteAPointer}${icon}`;
                setTimeout(() => resteSpan.classList.remove('value-changed'), 400);
            }
            
            // 4. Mettre √† jour la barre de progression de la semaine
            updateWeekProgress(agentCode, weekNum, heuresAPointer, totalImprod, totalProjet);
            
            // 5. Auto-save dans localStorage
            autoSaveAgentData(agentCode);
        }
        
        // Nouvelle fonction: Barre de progression par semaine
        function updateWeekProgress(agentCode, weekNum, total, improd, projet) {
            const progressBarId = `progress-${agentCode}-${weekNum}`;
            let progressBar = document.getElementById(progressBarId);
            
            if (!progressBar) return;
            
            const used = improd + projet;
            const percentage = Math.min((used / total) * 100, 100);
            
            progressBar.style.width = percentage + '%';
            progressBar.style.transition = 'width 0.3s ease';
            
            if (percentage >= 100) {
                progressBar.style.background = '#28a745';
            } else if (percentage >= 80) {
                progressBar.style.background = '#ffc107';
            } else {
                progressBar.style.background = '#667eea';
            }
        }
        
        // Nouvelle fonction: Auto-save des donn√©es de l'agent
        function autoSaveAgentData(agentCode) {
            const table = document.getElementById(`gantt-table-${agentCode}`);
            if (!table) return;
            
            const data = {
                timestamp: new Date().toISOString(),
                heuresPointer: {},
                improductives: {},
                projets: {}
            };
            
            // Sauvegarder les heures √† pointer
            const heuresInputs = table.querySelectorAll('[id^="heures-pointer-"]');
            heuresInputs.forEach(input => {
                const weekNum = input.id.split('-').pop();
                data.heuresPointer[weekNum] = input.value;
            });
            
            // Sauvegarder les improductives
            const improdInputs = table.querySelectorAll('.improd-input');
            improdInputs.forEach(input => {
                const type = input.dataset.type;
                const week = input.dataset.week;
                if (!data.improductives[week]) data.improductives[week] = {};
                data.improductives[week][type] = input.value;
            });
            
            // Sauvegarder les projets
            const projetInputs = table.querySelectorAll('.projet-input');
            projetInputs.forEach(input => {
                const idx = input.dataset.projetIndex;
                const week = input.dataset.week;
                if (!data.projets[idx]) data.projets[idx] = {};
                data.projets[idx][week] = input.value;
            });
            
            localStorage.setItem(`agent-data-${agentCode}`, JSON.stringify(data));
            
            // Afficher feedback visuel discret
            showSaveIndicator();
        }
        
        // Indicateur de sauvegarde
        function showSaveIndicator() {
            let indicator = document.getElementById('save-indicator');
            if (!indicator) {
                indicator = document.createElement('div');
                indicator.id = 'save-indicator';
                indicator.style.cssText = `
                    position: fixed;
                    bottom: 20px;
                    right: 20px;
                    background: #28a745;
                    color: white;
                    padding: 0.5rem 1rem;
                    border-radius: 8px;
                    font-size: 0.9rem;
                    font-weight: 600;
                    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
                    z-index: 10000;
                    opacity: 0;
                    transition: opacity 0.3s ease;
                `;
                indicator.innerHTML = 'üíæ Sauvegard√©';
                document.body.appendChild(indicator);
            }
            
            indicator.style.opacity = '1';
            setTimeout(() => {
                indicator.style.opacity = '0';
            }, 2000);
        }
        
        // Charger les donn√©es sauvegard√©es d'un agent
        function loadAgentData(agentCode) {
            const savedData = localStorage.getItem(`agent-data-${agentCode}`);
            if (!savedData) return;
            
            try {
                const data = JSON.parse(savedData);
                const table = document.getElementById(`gantt-table-${agentCode}`);
                if (!table) return;
                
                // Restaurer les heures improductives
                if (data.improductives) {
                    Object.keys(data.improductives).forEach(week => {
                        Object.keys(data.improductives[week]).forEach(type => {
                            const input = table.querySelector(`.improd-input[data-type="${type}"][data-week="${week}"]`);
                            if (input) {
                                input.value = data.improductives[week][type];
                            }
                        });
                    });
                }
                
                // Restaurer les heures projet
                if (data.projets) {
                    Object.keys(data.projets).forEach(idx => {
                        Object.keys(data.projets[idx]).forEach(week => {
                            const input = table.querySelector(`.projet-input[data-projet-index="${idx}"][data-week="${week}"]`);
                            if (input) {
                                input.value = data.projets[idx][week];
                            }
                        });
                    });
                }
                
                // Recalculer toutes les semaines pour mettre √† jour les totaux
                const weeks = Array.from(new Set(
                    [...table.querySelectorAll('.improd-input'), ...table.querySelectorAll('.projet-input')]
                    .map(input => input.dataset.week)
                ));
                
                weeks.forEach(weekNum => {
                    if (weekNum) {
                        recalculateWeek(agentCode, parseInt(weekNum));
                    }
                });
                
                // Mettre √† jour les cumuls des projets
                const projectIndices = Array.from(new Set(
                    [...table.querySelectorAll('.projet-input')].map(input => input.dataset.projetIndex)
                ));
                
                projectIndices.forEach(idx => {
                    if (idx) {
                        updateProjectCumul(agentCode, parseInt(idx));
                    }
                });
                
            } catch (error) {
                console.error('Erreur lors du chargement des donn√©es agent:', error);
            }
        }
        
        // Navigation clavier am√©lior√©e (Tab/Enter entre les inputs)
        function setupKeyboardNavigation() {
            document.addEventListener('keydown', function(e) {
                if (e.target.classList.contains('excel-input') || 
                    e.target.classList.contains('hour-input') ||
                    e.target.classList.contains('projet-input')) {
                    
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        // Aller √† l'input suivant dans la m√™me colonne
                        const currentCell = e.target.closest('th, td');
                        const currentRow = currentCell.parentElement;
                        const nextRow = currentRow.nextElementSibling;
                        
                        if (nextRow) {
                            const cellIndex = Array.from(currentRow.children).indexOf(currentCell);
                            const nextCell = nextRow.children[cellIndex];
                            const nextInput = nextCell?.querySelector('input');
                            if (nextInput) {
                                nextInput.focus();
                                nextInput.select();
                            }
                        }
                    }
                }
            });
        }
        
        // Initialiser la navigation clavier
        document.addEventListener('DOMContentLoaded', function() {
            setupKeyboardNavigation();
        });
        
        // Fonction pour mettre √† jour le cumul d'un projet
        function updateProjectCumul(agentCode, projetIndex) {
            const table = document.getElementById(`gantt-table-${agentCode}`);
            const inputs = table.querySelectorAll(`.projet-input[data-projet-index="${projetIndex}"]`);
            let cumul = 0;
            
            inputs.forEach(input => {
                cumul += parseFloat(input.value) || 0;
            });
            
            const cumulSpan = document.getElementById(`cumul-projet-${agentCode}-${projetIndex}`);
            if (cumulSpan) {
                cumulSpan.textContent = cumul.toFixed(1);
            }
        }

        // Charger la vue dashboard
        function loadDashboardView() {
            const container = document.getElementById('dashboard-content');
            
            // Filtrer les projets sans √©tat N/A
            const projetsAffiches = projetsData.filter(p => p.etat && p.etat !== 'N/A' && p.etat.trim() !== '');
            
            // Calculer les statistiques par √©tat
            const statsEtats = {};
            projetsAffiches.forEach(p => {
                const etat = p.etat || 'Non d√©fini';
                statsEtats[etat] = (statsEtats[etat] || 0) + 1;
            });
            
            // Calculer les statistiques par ann√©e avec d√©tail des √©tats
            const statsAnnees = {};
            projetsAffiches.forEach(p => {
                if (p.livrable && p.livrable !== 'Non d√©fini' && p.livrable !== 'XXX') {
                    const annee = p.livrable.substring(0, 4);
                    if (annee && !isNaN(annee)) {
                        if (!statsAnnees[annee]) {
                            statsAnnees[annee] = { total: 0, etats: {} };
                        }
                        statsAnnees[annee].total++;
                        const etat = p.etat || 'Non d√©fini';
                        statsAnnees[annee].etats[etat] = (statsAnnees[annee].etats[etat] || 0) + 1;
                    }
                }
            });
            
            // Calculer le total d'heures
            const totalHeures = projetsAffiches.reduce((sum, p) => {
                const total = 
                    (p.heures_agents['Agent1'] || 0) +
                    (p.heures_agents['Agent2'] || 0) +
                    (p.heures_agents['Agent3'] || 0) +
                    (p.heures_agents['Agent5'] || 0) +
                    (p.heures_agents['Agent6'] || 0);
                return sum + total;
            }, 0);
            
            let html = `
                <div class="stats-row">
                    <div class="stat-card">
                        <h3>Total Projets</h3>
                        <div class="value">${projetsAffiches.length}</div>
                    </div>
                    <div class="stat-card">
                        <h3>Heures Affect√©es</h3>
                        <div class="value">${totalHeures.toLocaleString()}h</div>
                    </div>
                    <div class="stat-card">
                        <h3>Agents Actifs</h3>
                        <div class="value">5</div>
                    </div>
                </div>
                
                <div class="stats-section">
                    <h3 class="stats-section-title">üìä Projets par √âtat</h3>
                    <div class="stats-row">
            `;
            
            // Ajouter les cartes par √©tat
            Object.entries(statsEtats).sort((a, b) => b[1] - a[1]).forEach(([etat, count]) => {
                html += `
                    <div class="stat-card stat-card-small">
                        <h3>${etat}</h3>
                        <div class="value">${count}</div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                </div>
                
                <div class="charts-section">
                    <h3 class="stats-section-title">üìà Visualisations</h3>
                    
                    <div class="charts-grid">
                        <div class="chart-container">
                            <h4 class="chart-title">R√©partition des Projets par √âtat</h4>
                            <canvas id="chartEtats"></canvas>
                        </div>
                        
                        <div class="chart-container">
                            <h4 class="chart-title">Heures Affect√©es par Agent</h4>
                            <canvas id="chartAgents"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container-wide">
                        <h4 class="chart-title">Projets par Ann√©e et par √âtat</h4>
                        <canvas id="chartAnnees"></canvas>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
            
            // Cr√©er les graphiques apr√®s l'insertion du HTML
            setTimeout(() => {
                createCharts(statsEtats, statsAnnees, projetsAffiches);
            }, 100);
        }

        // Cr√©er les graphiques
        function createCharts(statsEtats, statsAnnees, projetsAffiches) {
            // Palette de couleurs
            const colors = {
                'Termin√©': '#28a745',
                'A venir': '#ffc107',
                'Prise en charge': '#17a2b8',
                'Externalis√©': '#6f42c1',
                'Orpheline': '#dc3545',
                'Pas d\'impact TL': '#6c757d'
            };
            
            // 1. Graphique en camembert - √âtats
            const ctxEtats = document.getElementById('chartEtats');
            if (ctxEtats) {
                const etatsLabels = Object.keys(statsEtats);
                const etatsData = Object.values(statsEtats);
                const etatsColors = etatsLabels.map(etat => colors[etat] || '#667eea');
                
                new Chart(ctxEtats, {
                    type: 'doughnut',
                    data: {
                        labels: etatsLabels,
                        datasets: [{
                            data: etatsData,
                            backgroundColor: etatsColors,
                            borderWidth: 2,
                            borderColor: '#fff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 15,
                                    font: { size: 12 }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const label = context.label || '';
                                        const value = context.parsed || 0;
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = ((value / total) * 100).toFixed(1);
                                        return `${label}: ${value} (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            // 2. Graphique en barres - Heures par agent
            const ctxAgents = document.getElementById('chartAgents');
            if (ctxAgents) {
                const agentsHeures = {
                    'ANc': 0, 'NGl': 0, 'MSt': 0, 'PCs': 0, 'PAe': 0
                };
                
                projetsAffiches.forEach(p => {
                    agentsHeures['ANc'] += (p.heures_agents['Agent1'] || 0);
                    agentsHeures['NGl'] += (p.heures_agents['Agent2'] || 0);
                    agentsHeures['MSt'] += (p.heures_agents['Agent3'] || 0);
                    agentsHeures['PCs'] += (p.heures_agents['Agent5'] || 0);
                    agentsHeures['PAe'] += (p.heures_agents['Agent6'] || 0);
                });
                
                new Chart(ctxAgents, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(agentsHeures),
                        datasets: [{
                            label: 'Heures affect√©es',
                            data: Object.values(agentsHeures),
                            backgroundColor: '#667eea',
                            borderColor: '#5568d3',
                            borderWidth: 2,
                            borderRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.parsed.y}h`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value + 'h';
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            // 3. Graphique en barres empil√©es - Ann√©es et √©tats
            const ctxAnnees = document.getElementById('chartAnnees');
            if (ctxAnnees) {
                const annees = Object.keys(statsAnnees).sort();
                const etatsUniques = [...new Set(
                    Object.values(statsAnnees).flatMap(a => Object.keys(a.etats))
                )];
                
                const datasets = etatsUniques.map(etat => {
                    return {
                        label: etat,
                        data: annees.map(annee => statsAnnees[annee].etats[etat] || 0),
                        backgroundColor: colors[etat] || '#667eea',
                        borderWidth: 0,
                        borderRadius: 4
                    };
                });
                
                new Chart(ctxAnnees, {
                    type: 'bar',
                    data: {
                        labels: annees,
                        datasets: datasets
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 15,
                                    font: { size: 12 }
                                }
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false
                            }
                        },
                        scales: {
                            x: { stacked: true },
                            y: { 
                                stacked: true,
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        // Charger la vue alertes
        function loadAlertesView() {
            const container = document.getElementById('alertes-content');
            
            // Filtrer les projets non termin√©s
            const projetsActifs = projetsData.filter(p => {
                const isTermine = p.etat && p.etat.toLowerCase().includes('termin√©');
                const hasDate = p.livrable && p.livrable !== 'Non d√©fini' && p.livrable !== 'XXX' && p.livrable.trim() !== '';
                return !isTermine && hasDate && p.etat && p.etat !== 'N/A' && p.etat.trim() !== '';
            });
            
            // Calculer les jours restants pour chaque projet
            const projetsAvecJours = projetsActifs.map(p => {
                const daysInfo = calculateDaysRemaining(p.livrable, p.etat);
                return { ...p, daysInfo };
            });
            
            // S√©parer en retard et urgents
            const projetsRetard = projetsAvecJours.filter(p => p.daysInfo.days !== null && p.daysInfo.days < 0);
            const projetsUrgents = projetsAvecJours.filter(p => p.daysInfo.days !== null && p.daysInfo.days >= 0 && p.daysInfo.days <= 30);
            
            // Trier par jours restants (les plus urgents en premier)
            projetsRetard.sort((a, b) => a.daysInfo.days - b.daysInfo.days);
            projetsUrgents.sort((a, b) => a.daysInfo.days - b.daysInfo.days);
            
            let html = `
                <div class="stats-row">
                    <div class="stat-card" style="border-left-color: #dc3545;">
                        <h3>En Retard</h3>
                        <div class="value">${projetsRetard.length}</div>
                    </div>
                    <div class="stat-card" style="border-left-color: #ffa726;">
                        <h3>‚â§ 30 jours</h3>
                        <div class="value">${projetsUrgents.length}</div>
                    </div>
                    <div class="stat-card" style="border-left-color: #17a2b8;">
                        <h3>Total Alertes</h3>
                        <div class="value">${projetsRetard.length + projetsUrgents.length}</div>
                    </div>
                </div>
            `;
            
            // Section Projets en retard
            if (projetsRetard.length > 0) {
                html += `
                    <div class="alert-section alert-section-danger">
                        <h3 class="alert-section-title">üî¥ Projets en Retard (${projetsRetard.length})</h3>
                        <div class="projects-table-container">
                            <table class="projects-table-gest">
                                <thead>
                                    <tr>
                                        <th>R√©f</th>
                                        <th>√âtat</th>
                                        <th>Description</th>
                                        <th>CEP</th>
                                        <th>Agents</th>
                                        <th>Livrable</th>
                                        <th>Retard</th>
                                    </tr>
                                </thead>
                                <tbody>
                `;
                
                projetsRetard.forEach(projet => {
                    const index = projetsData.indexOf(projet);
                    
                    // G√©n√©rer le select des √âtats
                    let etatSelect = `<select class="etat-select-alert" data-index="${index}" onchange="updateEtatFromAlert(this)">`;
                    LISTE_ETATS.forEach(etat => {
                        const selected = (projet.etat === etat) ? 'selected' : '';
                        etatSelect += `<option value="${etat}" ${selected}>${etat}</option>`;
                    });
                    etatSelect += '</select>';
                    
                    html += `
                        <tr>
                            <td><strong>#${projet.ref}</strong></td>
                            <td>${etatSelect}</td>
                            <td>
                                <div class="project-description" title="${projet.description}">
                                    ${projet.description || 'Sans description'}
                                </div>
                                <small style="color: #999;">PL: ${projet.pl || 'N/A'}</small>
                            </td>
                            <td>${projet.cep || 'N/A'}</td>
                            <td><div class="agents-list">${formatAgents(projet.agents)}</div></td>
                            <td>${projet.livrable}</td>
                            <td><span class="days-remaining ${projet.daysInfo.class}">${projet.daysInfo.text}</span></td>
                        </tr>
                    `;
                });
                
                html += `
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            }
            
            // Section Projets urgents (‚â§ 30 jours)
            if (projetsUrgents.length > 0) {
                html += `
                    <div class="alert-section alert-section-warning">
                        <h3 class="alert-section-title">üü† Projets Urgents - ‚â§ 30 jours (${projetsUrgents.length})</h3>
                        <div class="projects-table-container">
                            <table class="projects-table-gest">
                                <thead>
                                    <tr>
                                        <th>R√©f</th>
                                        <th>√âtat</th>
                                        <th>Description</th>
                                        <th>CEP</th>
                                        <th>Agents</th>
                                        <th>Livrable</th>
                                        <th>Jours restants</th>
                                    </tr>
                                </thead>
                                <tbody>
                `;
                
                projetsUrgents.forEach(projet => {
                    const index = projetsData.indexOf(projet);
                    
                    // G√©n√©rer le select des √âtats
                    let etatSelect = `<select class="etat-select-alert" data-index="${index}" onchange="updateEtatFromAlert(this)">`;
                    LISTE_ETATS.forEach(etat => {
                        const selected = (projet.etat === etat) ? 'selected' : '';
                        etatSelect += `<option value="${etat}" ${selected}>${etat}</option>`;
                    });
                    etatSelect += '</select>';
                    
                    html += `
                        <tr>
                            <td><strong>#${projet.ref}</strong></td>
                            <td>${etatSelect}</td>
                            <td>
                                <div class="project-description" title="${projet.description}">
                                    ${projet.description || 'Sans description'}
                                </div>
                                <small style="color: #999;">PL: ${projet.pl || 'N/A'}</small>
                            </td>
                            <td>${projet.cep || 'N/A'}</td>
                            <td><div class="agents-list">${formatAgents(projet.agents)}</div></td>
                            <td>${projet.livrable}</td>
                            <td><span class="days-remaining ${projet.daysInfo.class}">${projet.daysInfo.text}</span></td>
                        </tr>
                    `;
                });
                
                html += `
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            }
            
            // Message si aucune alerte
            if (projetsRetard.length === 0 && projetsUrgents.length === 0) {
                html += `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚úÖ</div>
                        <h2>Aucune alerte</h2>
                        <p>Tous vos projets sont dans les temps !</p>
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }
        
        // Formater les agents pour l'affichage
        function formatAgents(agentsStr) {
            if (!agentsStr) return '<span class="agent-badge">Non assign√©</span>';
            
            const agents = agentsStr.split(',').map(a => a.trim());
            return agents.map(agent => 
                `<span class="agent-badge">${agent}</span>`
            ).join('');
        }

        // Charger la vue param√©trage
        function loadParametrageView() {
            const container = document.getElementById('parametrage-content');
            
            const niveaux = [
                { code: 'E', label: 'Expert', color: '#28a745', bgColor: '#d4edda' },
                { code: 'A', label: 'Acquis', color: '#17a2b8', bgColor: '#d1ecf1' },
                { code: 'F', label: 'Formation', color: '#ffc107', bgColor: '#fff3cd' },
                { code: 'NC', label: 'Non Concern√©', color: '#6c757d', bgColor: '#e9ecef' }
            ];
            
            let html = `
                <div class="parametrage-container">
                    <!-- Section Taux d'Improductivit√© -->
                    <div class="parametrage-section">
                        <h3>‚öôÔ∏è Taux d'Improductivit√© par Agent</h3>
                        <p style="color: #666; margin-bottom: 1.5rem;">
                            Le taux d'improductivit√© est utilis√© pour calculer automatiquement les heures √† pointer chaque semaine en fonction des heures de travail standard.
                        </p>
                        <div class="improd-rates-container">
                            <table class="improd-table">
                                <thead>
                                    <tr>
                                        <th>Agent</th>
                                        <th>Taux d'improductivit√© (%)</th>
                                        <th>Heures hebdo standard</th>
                                        <th>Heures √† pointer/semaine</th>
                                    </tr>
                                </thead>
                                <tbody>
            `;
            
            Object.entries(AGENTS).forEach(([code, agent]) => {
                const taux = tauxImproductivite[code] || 10;
                const heuresStandard = 37; // Lu-Je: 8h, Ve: 5h = 37h/semaine
                const heuresPointer = heuresStandard * (1 - taux / 100);
                
                html += `
                    <tr>
                        <td class="agent-name"><strong>${agent.nom}</strong> (${code})</td>
                        <td>
                            <input type="number" class="taux-input" 
                                   id="taux-${code}" 
                                   value="${taux}" 
                                   min="0" max="100" step="1"
                                   onchange="updateTauxImproductivite('${code}', this.value)">
                            <span class="unit">%</span>
                        </td>
                        <td class="hours-display">${heuresStandard}h</td>
                        <td class="hours-display calculated" id="heures-calc-${code}">
                            ${heuresPointer.toFixed(1)}h
                        </td>
                    </tr>
                `;
            });
            
            html += `
                                </tbody>
                            </table>
                        </div>
                        <div class="info-box" style="margin-top: 1rem;">
                            <strong>‚ÑπÔ∏è Information :</strong> Les heures √† pointer sont calcul√©es comme suit : 
                            <code>Heures standard √ó (1 - Taux improductivit√© / 100)</code>
                            <br>
                            <small>Par d√©faut : 37h √ó (1 - 10%) = 33.3h √† pointer par semaine</small>
                        </div>
                    </div>
                    
                    <hr style="margin: 2rem 0; border: none; border-top: 2px solid #dee2e6;">
                    
                    <!-- Section Comp√©tences -->
                    <div class="parametrage-section">
                        <h3>üìö Niveaux de Comp√©tence</h3>
                        <div class="niveaux-legend">
            `;
            
            niveaux.forEach(niveau => {
                html += `
                    <div class="niveau-badge" style="background: ${niveau.bgColor}; color: ${niveau.color}; border-color: ${niveau.color};">
                        <strong>${niveau.code}</strong> - ${niveau.label}
                    </div>
                `;
            });
            
            html += `
                        </div>
                    </div>
                    
                    <div class="competences-table-container">
                        <table class="competences-table">
                            <thead>
                                <tr>
                                    <th>Agent</th>
            `;
            
            LISTE_SPECIALITES.forEach(spec => {
                html += `<th>${spec}</th>`;
            });
            
            html += `
                                </tr>
                            </thead>
                            <tbody>
            `;
            
            Object.entries(AGENTS).forEach(([code, agent]) => {
                html += `
                    <tr>
                        <td class="agent-name"><strong>${agent.nom}</strong> (${code})</td>
                `;
                
                LISTE_SPECIALITES.forEach(spec => {
                    const currentLevel = agentsCompetences[code][spec] || 'NC';
                    
                    html += `
                        <td>
                            <select class="niveau-select" data-agent="${code}" data-specialite="${spec}" onchange="updateCompetence(this)">
                    `;
                    
                    niveaux.forEach(niveau => {
                        const selected = currentLevel === niveau.code ? 'selected' : '';
                        html += `<option value="${niveau.code}" ${selected}>${niveau.code} - ${niveau.label}</option>`;
                    });
                    
                    html += `
                            </select>
                        </td>
                    `;
                });
                
                html += `
                    </tr>
                `;
            });
            
            html += `
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="parametrage-actions">
                        <button class="btn btn-primary" onclick="saveParametres()">üíæ Sauvegarder tous les Param√®tres</button>
                        <button class="btn btn-toggle" onclick="resetParametres()">üîÑ R√©initialiser</button>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }
        
        // Mettre √† jour une comp√©tence
        function updateCompetence(select) {
            const agent = select.dataset.agent;
            const specialite = select.dataset.specialite;
            const niveau = select.value;
            
            agentsCompetences[agent][specialite] = niveau;
        }
        
        // Mettre √† jour le taux d'improductivit√© d'un agent
        function updateTauxImproductivite(agentCode, taux) {
            tauxImproductivite[agentCode] = parseFloat(taux);
            
            // Recalculer les heures √† pointer
            const heuresStandard = 37;
            const heuresPointer = heuresStandard * (1 - taux / 100);
            
            const heuresCalcElement = document.getElementById(`heures-calc-${agentCode}`);
            if (heuresCalcElement) {
                heuresCalcElement.textContent = `${heuresPointer.toFixed(1)}h`;
            }
        }
        
        // Sauvegarder tous les param√®tres (comp√©tences + taux improductivit√©)
        function saveParametres() {
            localStorage.setItem('agentsCompetences', JSON.stringify(agentsCompetences));
            localStorage.setItem('tauxImproductivite', JSON.stringify(tauxImproductivite));
            
            // Feedback visuel
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '‚úÖ Sauvegard√© !';
            btn.style.background = '#28a745';
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.style.background = '';
            }, 2000);
        }
        
        // Ancienne fonction pour r√©trocompatibilit√©
        function saveCompetences() {
            saveParametres();
        }
        
        // R√©initialiser tous les param√®tres
        function resetParametres() {
            if (confirm('√ätes-vous s√ªr de vouloir r√©initialiser tous les param√®tres (comp√©tences et taux d\'improductivit√©) ?')) {
                // R√©initialiser les comp√©tences
                Object.keys(agentsCompetences).forEach(agent => {
                    LISTE_SPECIALITES.forEach(spec => {
                        agentsCompetences[agent][spec] = 'NC';
                    });
                });
                
                // R√©initialiser les taux √† 10%
                Object.keys(tauxImproductivite).forEach(agent => {
                    tauxImproductivite[agent] = 10;
                });
                
                localStorage.setItem('agentsCompetences', JSON.stringify(agentsCompetences));
                localStorage.setItem('tauxImproductivite', JSON.stringify(tauxImproductivite));
                loadParametrageView();
            }
        }
        
        // Ancienne fonction pour r√©trocompatibilit√©
        function resetCompetences() {
            resetParametres();
        }
        
        // Charger les taux d'improductivit√© depuis localStorage au d√©marrage
        function loadTauxImproductivite() {
            const saved = localStorage.getItem('tauxImproductivite');
            if (saved) {
                try {
                    tauxImproductivite = JSON.parse(saved);
                } catch (e) {
                    console.error('Erreur lors du chargement des taux d\'improductivit√©:', e);
                }
            }
        }

        // Charger la vue sans date
        function loadSansDateView() {
            const container = document.getElementById('sans-date-content');
            
            // Filtrer les projets sans date, non termin√©s et non orphelins
            const projetsSansDate = projetsData.filter(p => {
                const isTermine = p.etat && p.etat.toLowerCase().includes('termin√©');
                const isOrpheline = p.etat && p.etat.toLowerCase().includes('orphelin');
                const hasNoDate = !p.livrable || p.livrable === 'Non d√©fini' || p.livrable === 'XXX' || p.livrable.trim() === '';
                const hasValidState = p.etat && p.etat !== 'N/A' && p.etat.trim() !== '';
                return !isTermine && !isOrpheline && hasNoDate && hasValidState;
            });
            
            // Trier par √©tat puis par ref
            projetsSansDate.sort((a, b) => {
                if (a.etat !== b.etat) {
                    return (a.etat || '').localeCompare(b.etat || '');
                }
                return (a.ref || 0) - (b.ref || 0);
            });
            
            let html = `
                <div class="stats-row">
                    <div class="stat-card" style="border-left-color: #FFD3CC;">
                        <h3>Sans Date</h3>
                        <div class="value">${projetsSansDate.length}</div>
                    </div>
                </div>
            `;
            
            if (projetsSansDate.length > 0) {
                html += `
                    <div class="alert-section" style="border-left-color: #FFD3CC;">
                        <h3 class="alert-section-title">üìÖ Projets √† Planifier (${projetsSansDate.length})</h3>
                        <div class="projects-table-container">
                            <table class="projects-table-gest">
                                <thead>
                                    <tr>
                                        <th>R√©f</th>
                                        <th>√âtat</th>
                                        <th>Description</th>
                                        <th>CEP</th>
                                        <th>Agents</th>
                                        <th>Heures projet</th>
                                        <th>D√©finir Date</th>
                                    </tr>
                                </thead>
                                <tbody>
                `;
                
                projetsSansDate.forEach(projet => {
                    const index = projetsData.indexOf(projet);
                    
                    html += `
                        <tr>
                            <td><strong>#${projet.ref}</strong></td>
                            <td><span class="badge ${getBadgeClass(projet.etat)}">${projet.etat}</span></td>
                            <td>
                                <div class="project-description" title="${projet.description}">
                                    ${projet.description || 'Sans description'}
                                </div>
                                <small style="color: #999;">PL: ${projet.pl || 'N/A'}</small>
                            </td>
                            <td>${projet.cep || 'N/A'}</td>
                            <td><div class="agents-list">${formatAgents(projet.agents)}</div></td>
                            <td><strong>${projet.heures_totales || 0}h</strong></td>
                            <td>
                                <input type="date" class="date-input-alert" data-index="${index}" 
                                       onchange="updateDateFromSansDate(this)" 
                                       placeholder="S√©lectionner une date">
                            </td>
                        </tr>
                    `;
                });
                
                html += `
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            } else {
                html += `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚úÖ</div>
                        <h2>Tous les projets ont une date</h2>
                        <p>Aucun projet actif sans date de livrable !</p>
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }

        // Charger la vue gestionnaire
        function loadGestionnaireView() {
            const container = document.getElementById('gestionnaire-content');
            
            // Filtrer les projets sans √©tat N/A
            const projetsAffiches = projetsData.filter(p => p.etat && p.etat !== 'N/A' && p.etat.trim() !== '');
            
            let html = `
                <div class="projects-table-container">
                    <table class="projects-table-gest">
                        <thead>
                            <tr>
                                <th>R√©f</th>
                                <th>√âtat</th>
                                <th>Description</th>
                                <th>CEP</th>
                                <th>Agents</th>
                                <th>Sp√©cialit√©s</th>
                                <th>ANc</th>
                                <th>NGl</th>
                                <th>MSt</th>
                                <th>PCs</th>
                                <th>PAe</th>
                                <th>Total cumul√© agents</th>
                                <th>Heures projet</th>
                                <th>Livrable</th>
                                <th>Jours restants</th>
                            </tr>
                        </thead>
                        <tbody id="gestionnaire-tbody">
            `;
            
            projetsAffiches.forEach((projet, displayIndex) => {
                // Trouver l'index original dans projetsData
                const index = projetsData.indexOf(projet);
                
                const heuresANc = projet.heures_agents['Agent1'] || 0;
                const heuresNGl = projet.heures_agents['Agent2'] || 0;
                const heuresMSt = projet.heures_agents['Agent3'] || 0;
                const heuresPCs = projet.heures_agents['Agent5'] || 0;
                const heuresPAe = projet.heures_agents['Agent6'] || 0;
                const total = heuresANc + heuresNGl + heuresMSt + heuresPCs + heuresPAe;
                
                // Calculer les jours restants
                const daysInfo = calculateDaysRemaining(projet.livrable, projet.etat);
                
                // Cr√©er les checkboxes pour les agents
                const agentsList = (projet.agents || '').split(',').map(a => a.trim()).filter(a => a);
                const checkANc = agentsList.includes('ANc') ? 'checked' : '';
                const checkNGl = agentsList.includes('NGl') ? 'checked' : '';
                const checkMSt = agentsList.includes('MSt') ? 'checked' : '';
                const checkPCs = agentsList.includes('PCs') ? 'checked' : '';
                const checkPAe = agentsList.includes('PAe') ? 'checked' : '';
                
                const agentsCheckboxes = `
                    <div class="agents-checkboxes">
                        <label class="agent-checkbox">
                            <input type="checkbox" data-index="${index}" data-agent="ANc" ${checkANc} onchange="updateAgentCheckbox(this)">
                            <span>ANc</span>
                        </label>
                        <label class="agent-checkbox">
                            <input type="checkbox" data-index="${index}" data-agent="NGl" ${checkNGl} onchange="updateAgentCheckbox(this)">
                            <span>NGl</span>
                        </label>
                        <label class="agent-checkbox">
                            <input type="checkbox" data-index="${index}" data-agent="MSt" ${checkMSt} onchange="updateAgentCheckbox(this)">
                            <span>MSt</span>
                        </label>
                        <label class="agent-checkbox">
                            <input type="checkbox" data-index="${index}" data-agent="PCs" ${checkPCs} onchange="updateAgentCheckbox(this)">
                            <span>PCs</span>
                        </label>
                        <label class="agent-checkbox">
                            <input type="checkbox" data-index="${index}" data-agent="PAe" ${checkPAe} onchange="updateAgentCheckbox(this)">
                            <span>PAe</span>
                        </label>
                    </div>
                `;
                
                // Cr√©er les checkboxes pour les sp√©cialit√©s
                const specialitesList = (projet.specialites || '').split(',').map(s => s.trim()).filter(s => s);
                let specialitesCheckboxes = '<div class="specialites-checkboxes">';
                LISTE_SPECIALITES.forEach(spec => {
                    const isChecked = specialitesList.includes(spec) ? 'checked' : '';
                    specialitesCheckboxes += `
                        <label class="specialite-checkbox">
                            <input type="checkbox" data-index="${index}" data-specialite="${spec}" ${isChecked} onchange="updateSpecialiteCheckbox(this)">
                            <span>${spec}</span>
                        </label>
                    `;
                });
                specialitesCheckboxes += '</div>';
                
                // G√©n√©rer le select des CEP
                let cepSelect = `<select class="cep-select" data-index="${index}" onchange="updateCEP(this)">`;
                cepSelect += `<option value="">${projet.cep || 'S√©lectionner un CEP'}</option>`;
                LISTE_CEP.forEach(cep => {
                    const selected = (projet.cep === cep) ? 'selected' : '';
                    cepSelect += `<option value="${cep}" ${selected}>${cep}</option>`;
                });
                cepSelect += '</select>';
                
                // G√©n√©rer le select des √âtats
                let etatSelect = `<select class="etat-select" data-index="${index}" onchange="updateEtat(this)">`;
                LISTE_ETATS.forEach(etat => {
                    const selected = (projet.etat === etat) ? 'selected' : '';
                    etatSelect += `<option value="${etat}" ${selected}>${etat}</option>`;
                });
                etatSelect += '</select>';
                
                // V√©rifier si la date est manquante
                const hasNoDate = !projet.livrable || projet.livrable === 'Non d√©fini' || projet.livrable === 'XXX' || projet.livrable.trim() === '';
                const isTermine = projet.etat && projet.etat.toLowerCase().includes('termin√©');
                const isOrpheline = projet.etat && projet.etat.toLowerCase().includes('orphelin');
                
                let rowClass = '';
                if (hasNoDate) {
                    rowClass = 'no-date-row';
                } else if (isTermine) {
                    rowClass = 'termine-row';
                } else if (isOrpheline) {
                    rowClass = 'orpheline-row';
                }
                
                html += `
                    <tr data-index="${index}" class="${rowClass}">
                        <td><strong>#${projet.ref}</strong></td>
                        <td>${etatSelect}</td>
                        <td>
                            <div class="project-description" title="${projet.description}">
                                ${projet.description || 'Sans description'}
                            </div>
                            <small style="color: #999;">PL: ${projet.pl || 'N/A'}</small>
                        </td>
                        <td>${cepSelect}</td>
                        <td>${agentsCheckboxes}</td>
                        <td>${specialitesCheckboxes}</td>
                        <td><input type="number" class="hours-input" data-agent="ANc" data-index="${index}" value="${heuresANc}" min="0" onchange="updateHours(this)"></td>
                        <td><input type="number" class="hours-input" data-agent="NGl" data-index="${index}" value="${heuresNGl}" min="0" onchange="updateHours(this)"></td>
                        <td><input type="number" class="hours-input" data-agent="MSt" data-index="${index}" value="${heuresMSt}" min="0" onchange="updateHours(this)"></td>
                        <td><input type="number" class="hours-input" data-agent="PCs" data-index="${index}" value="${heuresPCs}" min="0" onchange="updateHours(this)"></td>
                        <td><input type="number" class="hours-input" data-agent="PAe" data-index="${index}" value="${heuresPAe}" min="0" onchange="updateHours(this)"></td>
                        <td><strong class="total-hours" id="total-${index}">${total}h</strong></td>
                        <td><strong class="total-projet">${projet.heures_totales || 0}h</strong></td>
                        <td><input type="date" class="date-input" data-index="${index}" value="${projet.livrable && projet.livrable !== 'Non d√©fini' && projet.livrable !== 'XXX' ? projet.livrable : ''}" onchange="updateLivrable(this)"></td>
                        <td><span class="days-remaining ${daysInfo.class}" id="days-${index}">${daysInfo.text}</span></td>
                    </tr>
                `;
            });
            
            html += `
                        </tbody>
                    </table>
                </div>
                
                <div style="margin-top: 2rem; text-align: center;">
                    <button class="btn btn-primary" onclick="exportData()">üíæ Exporter les modifications (JSON)</button>
                </div>
            `;
            
            container.innerHTML = html;
            
            // Peupler le filtre CEP
            populateCEPFilter();
        }
        
        // Mettre √† jour les heures quand l'utilisateur change une valeur
        function updateHours(input) {
            const index = parseInt(input.dataset.index);
            const agent = input.dataset.agent;
            const hours = parseFloat(input.value) || 0;
            
            // Mapper les codes agents vers les colonnes
            const agentMapping = {
                'ANc': 'Agent1',
                'NGl': 'Agent2',
                'MSt': 'Agent3',
                'PCs': 'Agent5',
                'PAe': 'Agent6'
            };
            
            // Mettre √† jour les donn√©es
            projetsData[index].heures_agents[agentMapping[agent]] = hours;
            
            // Recalculer le total
            const total = 
                (projetsData[index].heures_agents['Agent1'] || 0) +
                (projetsData[index].heures_agents['Agent2'] || 0) +
                (projetsData[index].heures_agents['Agent3'] || 0) +
                (projetsData[index].heures_agents['Agent5'] || 0) +
                (projetsData[index].heures_agents['Agent6'] || 0);
            
            document.getElementById(`total-${index}`).textContent = `${total}h`;
            
            // Mettre √† jour la liste des agents affect√©s
            const agentsAffectes = [];
            if (projetsData[index].heures_agents['Agent1'] > 0) agentsAffectes.push('ANc');
            if (projetsData[index].heures_agents['Agent2'] > 0) agentsAffectes.push('NGl');
            if (projetsData[index].heures_agents['Agent3'] > 0) agentsAffectes.push('MSt');
            if (projetsData[index].heures_agents['Agent5'] > 0) agentsAffectes.push('PCs');
            if (projetsData[index].heures_agents['Agent6'] > 0) agentsAffectes.push('PAe');
            
            projetsData[index].agents = agentsAffectes.join(', ');
        }
        
        // Mettre √† jour le CEP
        function updateCEP(select) {
            const index = parseInt(select.dataset.index);
            const newCEP = select.value;
            
            projetsData[index].cep = newCEP;
        }
        
        // Mettre √† jour les agents affect√©s via les checkboxes
        function updateAgentCheckbox(checkbox) {
            const index = parseInt(checkbox.dataset.index);
            const agentCode = checkbox.dataset.agent;
            const isChecked = checkbox.checked;
            
            // R√©cup√©rer la liste actuelle des agents
            let agentsList = (projetsData[index].agents || '').split(',').map(a => a.trim()).filter(a => a);
            
            if (isChecked) {
                // Ajouter l'agent s'il n'est pas d√©j√† dans la liste
                if (!agentsList.includes(agentCode)) {
                    agentsList.push(agentCode);
                }
            } else {
                // Retirer l'agent de la liste
                agentsList = agentsList.filter(a => a !== agentCode);
            }
            
            // Mettre √† jour les donn√©es
            projetsData[index].agents = agentsList.join(', ');
        }
        
        // Mettre √† jour les sp√©cialit√©s via les checkboxes
        function updateSpecialiteCheckbox(checkbox) {
            const index = parseInt(checkbox.dataset.index);
            const specialite = checkbox.dataset.specialite;
            const isChecked = checkbox.checked;
            
            // Initialiser le champ sp√©cialit√©s s'il n'existe pas
            if (!projetsData[index].specialites) {
                projetsData[index].specialites = '';
            }
            
            // R√©cup√©rer la liste actuelle des sp√©cialit√©s
            let specialitesList = (projetsData[index].specialites || '').split(',').map(s => s.trim()).filter(s => s);
            
            if (isChecked) {
                // Ajouter la sp√©cialit√© si elle n'est pas d√©j√† dans la liste
                if (!specialitesList.includes(specialite)) {
                    specialitesList.push(specialite);
                }
            } else {
                // Retirer la sp√©cialit√© de la liste
                specialitesList = specialitesList.filter(s => s !== specialite);
            }
            
            // Mettre √† jour les donn√©es
            projetsData[index].specialites = specialitesList.join(', ');
        }

        // Mettre √† jour la date depuis l'onglet Sans Date
        function updateDateFromSansDate(input) {
            const index = parseInt(input.dataset.index);
            const newDate = input.value;
            
            if (!newDate) return;
            
            // Mettre √† jour les donn√©es
            projetsData[index].livrable = newDate;
            
            // Si on est dans la vue gestionnaire, mettre √† jour aussi l√†-bas
            const gestionnaireInput = document.querySelector(`#view-gestionnaire input.date-input[data-index="${index}"]`);
            if (gestionnaireInput) {
                gestionnaireInput.value = newDate;
                // Mettre √† jour le surlignage dans gestionnaire
                updateRowHighlight(index);
                // Mettre √† jour les jours restants dans gestionnaire
                const daysInfo = calculateDaysRemaining(newDate, projetsData[index].etat);
                const daysSpan = document.getElementById(`days-${index}`);
                if (daysSpan) {
                    daysSpan.textContent = daysInfo.text;
                    daysSpan.className = `days-remaining ${daysInfo.class}`;
                }
            }
            
            // Afficher un message de confirmation
            const row = input.closest('tr');
            const originalBg = row.style.backgroundColor;
            row.style.backgroundColor = '#d4edda';
            setTimeout(() => {
                row.style.backgroundColor = originalBg;
                
                // Retirer le projet de la liste apr√®s 1 seconde
                setTimeout(() => {
                    loadSansDateView(); // Recharger la vue sans date
                }, 1000);
            }, 500);
        }

        // Mettre √† jour l'√âtat depuis l'onglet Alertes
        function updateEtatFromAlert(select) {
            const index = parseInt(select.dataset.index);
            const newEtat = select.value;
            
            // Mettre √† jour les donn√©es
            projetsData[index].etat = newEtat;
            
            // Si on est dans la vue gestionnaire, mettre √† jour aussi l√†-bas
            const gestionnaireSelect = document.querySelector(`#view-gestionnaire select.etat-select[data-index="${index}"]`);
            if (gestionnaireSelect) {
                gestionnaireSelect.value = newEtat;
                // Mettre √† jour le surlignage dans gestionnaire
                updateRowHighlight(index);
                // Mettre √† jour les jours restants dans gestionnaire
                const daysInfo = calculateDaysRemaining(projetsData[index].livrable, newEtat);
                const daysSpan = document.getElementById(`days-${index}`);
                if (daysSpan) {
                    daysSpan.textContent = daysInfo.text;
                    daysSpan.className = `days-remaining ${daysInfo.class}`;
                }
            }
            
            // Afficher un message de confirmation
            const row = select.closest('tr');
            const originalBg = row.style.backgroundColor;
            row.style.backgroundColor = '#d4edda';
            setTimeout(() => {
                row.style.backgroundColor = originalBg;
                
                // Si le projet est pass√© en "Termin√©", le retirer des alertes apr√®s 1 seconde
                if (newEtat.toLowerCase().includes('termin√©')) {
                    setTimeout(() => {
                        loadAlertesView(); // Recharger la vue alertes
                    }, 1000);
                }
            }, 500);
        }

        // Mettre √† jour l'√âtat
        function updateEtat(select) {
            const index = parseInt(select.dataset.index);
            const newEtat = select.value;
            
            projetsData[index].etat = newEtat;
            
            // Mettre √† jour le surlignage de la ligne
            updateRowHighlight(index);
            
            // Mettre √† jour les jours restants
            const daysInfo = calculateDaysRemaining(projetsData[index].livrable, newEtat);
            const daysSpan = document.getElementById(`days-${index}`);
            if (daysSpan) {
                daysSpan.textContent = daysInfo.text;
                daysSpan.className = `days-remaining ${daysInfo.class}`;
            }
        }
        
        // Mettre √† jour la date de livrable
        function updateLivrable(input) {
            const index = parseInt(input.dataset.index);
            const newDate = input.value;
            
            projetsData[index].livrable = newDate;
            
            // Mettre √† jour le surlignage de la ligne
            updateRowHighlight(index);
            
            // Mettre √† jour les jours restants
            const daysInfo = calculateDaysRemaining(newDate, projetsData[index].etat);
            const daysSpan = document.getElementById(`days-${index}`);
            if (daysSpan) {
                daysSpan.textContent = daysInfo.text;
                daysSpan.className = `days-remaining ${daysInfo.class}`;
            }
        }
        
        // Fonction helper pour mettre √† jour le surlignage des lignes
        function updateRowHighlight(index) {
            const row = document.querySelector(`tr[data-index="${index}"]`);
            if (!row) return;
            
            const projet = projetsData[index];
            const hasNoDate = !projet.livrable || projet.livrable === 'Non d√©fini' || projet.livrable === 'XXX' || projet.livrable.trim() === '';
            const isTermine = projet.etat && projet.etat.toLowerCase().includes('termin√©');
            const isOrpheline = projet.etat && projet.etat.toLowerCase().includes('orphelin');
            
            // Retirer toutes les classes de couleur
            row.classList.remove('no-date-row', 'termine-row', 'orpheline-row');
            
            // Ajouter la classe appropri√©e (priorit√© : pas de date > termin√© > orphelin)
            if (hasNoDate) {
                row.classList.add('no-date-row');
            } else if (isTermine) {
                row.classList.add('termine-row');
            } else if (isOrpheline) {
                row.classList.add('orpheline-row');
            }
        }
        
        // Exporter les donn√©es modifi√©es
        function exportData() {
            const dataStr = JSON.stringify(projetsData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `projets_modifies_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
            
            alert('‚úÖ Donn√©es export√©es ! Vous pouvez r√©importer ce fichier pour conserver vos modifications.');
        }

        // Charger la vue d'un agent
        function loadAgentView(agentCode) {
            const agent = AGENTS[agentCode];
            if (!agent) return;

            // Filtrer les projets de l'agent avec les √©tats autoris√©s
            const agentProjets = projetsData.filter(p => {
                const hasAgent = (p.agents || '').includes(agentCode);
                const validEtat = ETATS_AGENTS.some(etat => 
                    (p.etat || '').toLowerCase().includes(etat.toLowerCase())
                );
                const hasHeures = p.heures_agents[`Agent${agent.col - 11}`] > 0;
                
                return hasAgent && validEtat && hasHeures;
            });

            const container = document.getElementById(`view-${agentCode}`);
            
            if (agentProjets.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìã</div>
                        <h2>Aucun projet actif</h2>
                        <p>${agent.nom} n'a pas de projets "√Ä venir", "Prise en charge" ou "Externalis√©".</p>
                    </div>
                `;
                return;
            }

            // Calculer les statistiques
            const totalHeures = agentProjets.reduce((sum, p) => 
                sum + (p.heures_agents[`Agent${agent.col - 11}`] || 0), 0
            );

            let html = `
                <div class="gantt-header">
                    <h2>üë§ ${agent.nom} (${agentCode})</h2>
                    <p class="subtitle">Planning hebdomadaire de pointage - Semaine actuelle: S${CURRENT_WEEK}</p>
                </div>

                <div class="stats-row">
                    <div class="stat-card">
                        <h3>Projets actifs</h3>
                        <div class="value">${agentProjets.length}</div>
                    </div>
                    <div class="stat-card">
                        <h3>Total heures</h3>
                        <div class="value">${totalHeures}h</div>
                    </div>
                    <div class="stat-card">
                        <h3>En cours</h3>
                        <div class="value">${agentProjets.filter(p => (p.etat || '').includes('Prise')).length}</div>
                    </div>
                </div>
            `;

            html += createGanttTable(agentProjets, agentCode);
            container.innerHTML = html;
            
            // Restaurer les donn√©es sauvegard√©es
            loadAgentData(agentCode);
        }

        // Basculer entre les vues
        function switchView(viewName) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));

            document.getElementById(`view-${viewName}`).classList.add('active');
            event.target.classList.add('active');

            if (viewName === 'dashboard') {
                loadDashboardView();
            } else if (viewName === 'alertes') {
                loadAlertesView();
            } else if (viewName === 'sans-date') {
                loadSansDateView();
            } else if (viewName === 'parametrage') {
                loadParametrageView();
            } else if (viewName === 'gestionnaire') {
                loadGestionnaireView();
            } else {
                loadAgentView(viewName);
            }
        }

        // Filtrer la vue gestionnaire
        function filterGestionnaire() {
            const search = document.getElementById('search-gestionnaire').value.toLowerCase();
            const etatFilter = document.getElementById('filter-etat').value.toLowerCase();
            const cepFilter = document.getElementById('filter-cep').value.toLowerCase();
            const agentFilter = document.getElementById('filter-agent').value;
            const dateFilter = document.getElementById('filter-date').value;
            
            const rows = document.querySelectorAll('#view-gestionnaire tbody tr');
            let visibleCount = 0;
            
            rows.forEach(row => {
                const index = parseInt(row.dataset.index);
                const projet = projetsData[index];
                
                // Filtre recherche (texte libre)
                const text = row.textContent.toLowerCase();
                const matchSearch = !search || text.includes(search);
                
                // Filtre √©tat
                const matchEtat = !etatFilter || (projet.etat && projet.etat.toLowerCase().includes(etatFilter));
                
                // Filtre CEP
                const matchCEP = !cepFilter || (projet.cep && projet.cep.toLowerCase().includes(cepFilter));
                
                // Filtre agent (v√©rifie si l'agent a des heures affect√©es)
                let matchAgent = true;
                if (agentFilter) {
                    const agentMapping = {
                        'ANc': 'Agent1',
                        'NGl': 'Agent2',
                        'MSt': 'Agent3',
                        'PCs': 'Agent5',
                        'PAe': 'Agent6'
                    };
                    const agentKey = agentMapping[agentFilter];
                    matchAgent = projet.heures_agents[agentKey] && projet.heures_agents[agentKey] > 0;
                }
                
                // Filtre date
                let matchDate = true;
                if (dateFilter === 'avec-date') {
                    matchDate = projet.livrable && projet.livrable !== 'Non d√©fini' && projet.livrable !== 'XXX' && projet.livrable.trim() !== '';
                } else if (dateFilter === 'sans-date') {
                    matchDate = !projet.livrable || projet.livrable === 'Non d√©fini' || projet.livrable === 'XXX' || projet.livrable.trim() === '';
                }
                
                // Filtre orphelines (toggle)
                const isOrpheline = projet.etat && projet.etat.toLowerCase().includes('orphelin');
                const matchOrphelines = showOrphelines || !isOrpheline;
                
                // Filtre termin√©s (toggle)
                const isTermine = projet.etat && projet.etat.toLowerCase().includes('termin√©');
                const matchTermines = showTermines || !isTermine;
                
                // Filtre √©tats secondaires (toggle)
                const isSecondaire = projet.etat && (
                    projet.etat.toLowerCase().includes('externalis√©') ||
                    projet.etat.toLowerCase().includes('prise en charge') ||
                    projet.etat.toLowerCase().includes('pas d\'impact')
                );
                const matchSecondaires = showSecondaires || !isSecondaire;
                
                // Appliquer tous les filtres
                const isVisible = matchSearch && matchEtat && matchCEP && matchAgent && matchDate && matchOrphelines && matchTermines && matchSecondaires;
                row.style.display = isVisible ? '' : 'none';
                
                if (isVisible) visibleCount++;
            });
            
            // Afficher le nombre de r√©sultats
            updateFilterCount(visibleCount, rows.length);
        }
        
        // Toggle l'affichage des orphelines
        function toggleOrphelines() {
            showOrphelines = !showOrphelines;
            
            const btn = document.getElementById('toggle-orphelines');
            const icon = document.getElementById('toggle-orphelines-icon');
            const text = document.getElementById('toggle-orphelines-text');
            
            if (showOrphelines) {
                icon.textContent = 'üëÅÔ∏è';
                text.textContent = 'Masquer orphelines';
                btn.classList.remove('btn-toggle-hidden');
            } else {
                icon.textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è';
                text.textContent = 'Afficher orphelines';
                btn.classList.add('btn-toggle-hidden');
            }
            
            filterGestionnaire();
        }
        
        // Toggle l'affichage des termin√©s
        function toggleTermines() {
            showTermines = !showTermines;
            
            const btn = document.getElementById('toggle-termines');
            const icon = document.getElementById('toggle-termines-icon');
            const text = document.getElementById('toggle-termines-text');
            
            if (showTermines) {
                icon.textContent = 'üëÅÔ∏è';
                text.textContent = 'Masquer termin√©s';
                btn.classList.remove('btn-toggle-hidden');
            } else {
                icon.textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è';
                text.textContent = 'Afficher termin√©s';
                btn.classList.add('btn-toggle-hidden');
            }
            
            filterGestionnaire();
        }
        
        // Toggle l'affichage des √©tats secondaires
        function toggleSecondaires() {
            showSecondaires = !showSecondaires;
            
            const btn = document.getElementById('toggle-secondaires');
            const icon = document.getElementById('toggle-secondaires-icon');
            const text = document.getElementById('toggle-secondaires-text');
            
            if (showSecondaires) {
                icon.textContent = 'üëÅÔ∏è';
                text.textContent = 'Masquer secondaires';
                btn.classList.remove('btn-toggle-hidden');
            } else {
                icon.textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è';
                text.textContent = 'Afficher secondaires';
                btn.classList.add('btn-toggle-hidden');
            }
            
            filterGestionnaire();
        }
        
        // Afficher le compteur de r√©sultats filtr√©s
        function updateFilterCount(visible, total) {
            let counter = document.getElementById('filter-counter');
            if (!counter) {
                counter = document.createElement('div');
                counter.id = 'filter-counter';
                counter.style.cssText = 'text-align: center; padding: 1rem; color: #666; font-weight: 600; background: #f8f9fa; border-radius: 8px; margin-bottom: 1rem;';
                const container = document.querySelector('#view-gestionnaire .projects-table-container');
                container.parentNode.insertBefore(counter, container);
            }
            
            if (visible < total) {
                counter.textContent = `üìä Affichage de ${visible} projet(s) sur ${total}`;
                counter.style.display = 'block';
            } else {
                counter.style.display = 'none';
            }
        }
        
        // Peupler le filtre CEP avec les CEP uniques
        function populateCEPFilter() {
            const cepSet = new Set();
            projetsData.forEach(p => {
                if (p.cep && p.cep !== 'N/A' && p.cep.trim() !== '') {
                    cepSet.add(p.cep);
                }
            });
            
            const select = document.getElementById('filter-cep');
            if (select) {
                const sortedCEPs = Array.from(cepSet).sort();
                sortedCEPs.forEach(cep => {
                    const option = document.createElement('option');
                    option.value = cep;
                    option.textContent = cep;
                    select.appendChild(option);
                });
            }
        }

        // Fonctions pour g√©rer la s√©lection des projets
        function selectAllProjects(agentCode) {
            const checkboxes = document.querySelectorAll(`.project-checkbox-${agentCode}`);
            checkboxes.forEach(cb => cb.checked = true);
            updateSelectAllCheckbox(agentCode);
        }

        function deselectAllProjects(agentCode) {
            const checkboxes = document.querySelectorAll(`.project-checkbox-${agentCode}`);
            checkboxes.forEach(cb => cb.checked = false);
            updateSelectAllCheckbox(agentCode);
        }

        function toggleAllProjectsSelection(agentCode) {
            const selectAllCheckbox = document.getElementById(`select-all-${agentCode}`);
            const checkboxes = document.querySelectorAll(`.project-checkbox-${agentCode}`);
            checkboxes.forEach(cb => cb.checked = selectAllCheckbox.checked);
        }

        function updateSelectAllCheckbox(agentCode) {
            const selectAllCheckbox = document.getElementById(`select-all-${agentCode}`);
            const checkboxes = document.querySelectorAll(`.project-checkbox-${agentCode}`);
            const allChecked = Array.from(checkboxes).every(cb => cb.checked);
            const noneChecked = Array.from(checkboxes).every(cb => !cb.checked);
            
            if (allChecked) {
                selectAllCheckbox.checked = true;
                selectAllCheckbox.indeterminate = false;
            } else if (noneChecked) {
                selectAllCheckbox.checked = false;
                selectAllCheckbox.indeterminate = false;
            } else {
                selectAllCheckbox.indeterminate = true;
            }
        }

        function isolateSelectedProjects(agentCode) {
            const checkboxes = document.querySelectorAll(`.project-checkbox-${agentCode}`);
            const rows = document.querySelectorAll(`.projet-row-${agentCode}`);
            
            let hasSelection = false;
            checkboxes.forEach((cb, index) => {
                if (cb.checked) {
                    hasSelection = true;
                    rows[index].style.display = '';
                } else {
                    rows[index].style.display = 'none';
                }
            });

            // Si aucun projet n'est s√©lectionn√©, afficher un message
            if (!hasSelection) {
                alert('‚ö†Ô∏è Veuillez d\'abord s√©lectionner au moins un projet √† isoler.');
            }
        }

        function showAllProjects(agentCode) {
            const rows = document.querySelectorAll(`.projet-row-${agentCode}`);
            rows.forEach(row => row.style.display = '');
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            loadTauxImproductivite();
            loadDashboardView();
        });
    </script>
</body>
</html>
